<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Birth Weight Prediction – Fathima Shaikh</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Fathima Shaikh</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../courses.html"> 
<span class="menu-text">Courses</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Birth Weight Prediction</h1>
<p class="subtitle lead">This project predicts birth weight of babies using different factors and shows that a logistic regreesion models performs best.</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="q1" class="level1">
<h1>Q1</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>births <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"~/Downloads/birthsnewone.csv"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456789</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>i <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(births)[<span class="dv">1</span>]</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>i.train <span class="ot">&lt;-</span> <span class="fu">sample</span>(i,<span class="dv">5000</span>,<span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>B.train <span class="ot">=</span> births[i.train, ]</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>B.test <span class="ot">=</span> births[<span class="sc">-</span>i.train, ]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(births)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  X Institution.type Plurality.of.birth Gender Race.of.child  Race
1 1                1                  1      2             1 White
2 2                1                  1      2             1 White
3 3                1                  1      2             1 White
4 4                1                  1      2             2 Black
5 5                1                  1      1             2 Black
6 6                1                  1      2             1 White
  Age.of.father Age.of.mother Education.of.father..years.
1            50            24                          12
2            19            18                           9
3            37            35                          17
4            39            31                          11
5            20            19                          11
6            30            27                          16
  Education.of.mother..years. Total.Preg BDead Terms Date.LBirth Month.LBirth
1                          15          2     0     0       32004            3
2                           9          1     0     0           0            0
3                          17          2     0     0      112003           11
4                          16          1     0     0           0            0
5                          12          1     0     0           0            0
6                          16          1     0     0           0            0
  Year.LBirth LOutcome Weeks Prenatal Trimester.Prenatal Visits
1        2004        1    38        3                  1     10
2           0        9    35        3                  1      9
3        2003        1    38        1                  1     20
4           0        9    38        6                  2     12
5           0        9    36        4                  2     10
6           0        9    40        1                  1     20
  Birth.weight.group Marital Birth.Attendant Numchild Month.Term Year.Term
1                  5       2               1        1          0         0
2                  6       2               1        0          0         0
3                  5       1               1        1          0         0
4                  5       2               1        0          0         0
5                  6       2               1        0          0         0
6                  6       1               1        0          0         0
  Low.Birth RaceMom RaceDad Mother.Minority Father.Minority HispMom HispDad
1      Norm       1       2           White        Nonwhite       N       N
2      Norm       1       1           White           White       N       N
3      Norm       1       1           White           White       N       N
4      Norm       2       2        Nonwhite        Nonwhite       N       N
5      Norm       2       1        Nonwhite           White       N       M
6      Norm       1       1           White           White       N       N
  AveCigs Smoker AveDrink Wt.Gain Birth.Weight..g.
1       0     No        0      50         2865.875
2      23   Cigs        0      35         3121.250
3       0     No        0      24         2667.250
4       0     No        0      30         2979.375
5       0     No        0      10         3036.125
6       0     No        0      37         3092.875</code></pre>
</div>
</div>
</section>
<section id="a." class="level1">
<h1>a.</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Birth.Weight..g. <span class="sc">~</span> ., <span class="at">data =</span> B.train)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>train_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">data =</span> B.train)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>train_mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((births<span class="sc">$</span>Birth.Weight..g. <span class="sc">-</span> train_pred)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in births$Birth.Weight..g. - train_pred: longer object length is not a
multiple of shorter object length</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>test_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, B.test)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>test_mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((births<span class="sc">$</span>Birth.Weight..g <span class="sc">-</span> test_pred)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in births$Birth.Weight..g - test_pred: longer object length is not a
multiple of shorter object length</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training MSE:"</span>, train_mse, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training MSE: 721481.8 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Testing MSE:"</span>, test_mse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Testing MSE: 710234.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The training MSE is higher than the testing MSE, which rarely occurs because the model is fit to the training data. The significant predictors are Plurality.of.birth, Gender, RaceWhite, Date.LBirth, Month.LBirth, Weeks, Birth.weight.group, Month.Term, Low.BirthNorm, SmokerNo, and Wt.Gain.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="b." class="level1">
<h1>b.</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stepwise &lt;- step(model, direction = "backward")</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#summary &lt;- summary(stepwise)</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># "Good predictors": Plurality.of.birth, Gender, Race, Weeks, Birth.weight.group, Father.Minority, Smoker, Wt.Gain</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>step_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Birth.Weight..g. <span class="sc">~</span> Plurality.of.birth <span class="sc">+</span> Gender <span class="sc">+</span> Race <span class="sc">+</span> Weeks <span class="sc">+</span> Birth.weight.group <span class="sc">+</span> Father.Minority <span class="sc">+</span> Smoker <span class="sc">+</span> Wt.Gain , <span class="at">data =</span> B.train)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>step_train_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(step_model, B.train)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>step_train_mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((births<span class="sc">$</span>Birth.Weight..g. <span class="sc">-</span> step_train_pred)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in births$Birth.Weight..g. - step_train_pred: longer object length is
not a multiple of shorter object length</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>step_test_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(step_model, B.test)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>step_test_mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((births<span class="sc">$</span>Birth.Weight..g. <span class="sc">-</span> step_test_pred)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in births$Birth.Weight..g. - step_test_pred: longer object length is
not a multiple of shorter object length</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training MSE:"</span>, step_train_mse, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training MSE: 721443.2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Testing MSE:"</span>, step_test_mse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Testing MSE: 709755.3</code></pre>
</div>
</div>
</section>
<section id="c." class="level1">
<h1>c.&nbsp;</h1>
<p>Ridge regression with the complete data (births)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the data</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>birthsLog <span class="ot">&lt;-</span> <span class="fu">transform</span>(births, <span class="at">lWeight =</span> <span class="fu">log</span>(<span class="fu">as.numeric</span>(births<span class="sc">$</span>Birth.Weight..g.)))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>birthsLog <span class="ot">&lt;-</span> <span class="fu">subset</span>(birthsLog, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Birth.Weight..g., X))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>B.testLog <span class="ot">&lt;-</span> <span class="fu">transform</span>(B.test, <span class="at">lWeight =</span> <span class="fu">log</span>(<span class="fu">as.numeric</span>(B.test<span class="sc">$</span>Birth.Weight..g.)))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>B.testLog <span class="ot">&lt;-</span> <span class="fu">subset</span>(B.testLog, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Birth.Weight..g., X))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>births2 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(birthsLog)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>B.test2 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(B.testLog)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>x_full <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(lWeight <span class="sc">~</span> ., <span class="at">data =</span> births2)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>y_full <span class="ot">&lt;-</span> births2<span class="sc">$</span>lWeight</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>x_test <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(lWeight <span class="sc">~</span> ., <span class="at">data =</span> B.test2)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>y_test <span class="ot">&lt;-</span> B.test2<span class="sc">$</span>lWeight</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Ridge Regression</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">705780612</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>lambda.v <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="dv">10</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>ridge_model <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x_full, y_full, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">lambda =</span> lambda.v)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-validation to find best lambda</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>cv.output <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x_full, y_full, <span class="at">alpha =</span> <span class="dv">0</span>)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>qplot <span class="ot">&lt;-</span> <span class="fu">qplot</span>(<span class="fu">log</span>(cv.output<span class="sc">$</span>lambda),cv.output<span class="sc">$</span>cvsd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `qplot()` was deprecated in ggplot2 3.4.0.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>bestlamb.cv <span class="ot">&lt;-</span> cv.output<span class="sc">$</span>lambda.min</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model with the best lambda</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>best_ridge <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x_full, y_full, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">lambda =</span> bestlamb.cv)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>pred.births2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(best_ridge, <span class="at">newx =</span> x_full, <span class="at">s =</span> bestlamb.cv, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>pred.Btest2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(best_ridge, <span class="at">newx =</span> x_test, <span class="at">s =</span> bestlamb.cv, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate MSE</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>MSE.births2 <span class="ot">&lt;-</span> <span class="fu">mean</span>((y_full <span class="sc">-</span> pred.births2)<span class="sc">^</span><span class="dv">2</span>) <span class="co"># Training MSE</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>MSE.Btest2 <span class="ot">&lt;-</span> <span class="fu">mean</span>((y_test <span class="sc">-</span> pred.Btest2)<span class="sc">^</span><span class="dv">2</span>)  <span class="co"># Testing MSE</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best lambda: "</span>, bestlamb.cv, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best lambda:  0.0224084 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">coef</span>(best_ridge))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>50 x 1 sparse Matrix of class "dgCMatrix"
                                       s0
(Intercept)                  6.478370e+00
(Intercept)                  .           
Institution.type            -3.084747e-03
Plurality.of.birth          -3.429659e-02
Gender                      -4.804617e-03
Race.of.child                3.808047e-04
RaceOther                    7.947638e-03
RaceWhite                    6.455639e-03
Age.of.father               -7.679371e-05
Age.of.mother                1.002633e-04
Education.of.father..years.  3.808010e-04
Education.of.mother..years.  4.342688e-04
Total.Preg                   9.235997e-04
BDead                       -2.406430e-02
Terms                       -1.366699e-03
Date.LBirth                 -4.986784e-10
Month.LBirth                -2.328507e-05
Year.LBirth                  3.108965e-06
LOutcome                    -1.891907e-04
Weeks                        1.828815e-02
Prenatal                     3.456070e-03
Trimester.Prenatal          -1.601978e-03
Visits                       1.621431e-03
Birth.weight.group           1.238124e-01
Marital                     -2.870645e-03
Birth.Attendant              5.054304e-04
Numchild                     2.665622e-03
Month.Term                  -7.218584e-04
Year.Term                    8.215467e-07
Low.BirthNorm                1.317013e-01
RaceMom                     -6.849657e-05
RaceDad                     -1.444243e-03
Mother.MinorityWhite         7.984752e-03
Father.MinorityWhite        -4.427625e-03
HispMomM                     1.217261e-03
HispMomN                    -1.696298e-03
HispMomO                    -1.099847e-02
HispMomP                    -1.272498e-03
HispMomS                     9.112568e-05
HispMomU                     2.279497e-02
HispDadM                    -1.532665e-03
HispDadN                    -3.089432e-04
HispDadO                     8.649688e-03
HispDadP                     1.692276e-03
HispDadS                     7.593321e-03
HispDadU                    -1.408813e-02
AveCigs                     -4.029724e-04
SmokerNo                     4.647282e-03
AveDrink                     2.408536e-04
Wt.Gain                      4.650144e-04</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training MSE: "</span>, MSE.births2, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training MSE:  0.006721434 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Testing MSE: "</span>, MSE.Btest2, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Testing MSE:  0.006942309 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The significant predictors are variables like Low.BirthNorm, Birth.weight.group, and Weeks, as they have large coefficients and strong associations to the response. For example, the Weeks coefficient is large (1.828815e-02) compared to others, indicating a strong effect on the response variable. An interesting observation is that AveCigs shows a negative relationship with the response, and SmokerNo has a positive association. The training MSE is 0.0067214 and the testing MSE is 0.0069423, which indicates good model performance and overfitting because the testing MSE is very close to the training MSE.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="d." class="level1">
<h1>d.&nbsp;</h1>
<p>Use Lasso Regression Approach to predict the weight of the baby in grams using the complete data (births) and interpret your results</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>birthsLog <span class="ot">&lt;-</span> <span class="fu">transform</span>(births, <span class="at">lWeight =</span> <span class="fu">log</span>(<span class="fu">as.numeric</span>(births<span class="sc">$</span>Birth.Weight..g.)))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>birthsLog <span class="ot">&lt;-</span> <span class="fu">subset</span>(birthsLog, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Birth.Weight..g., X))  </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>births2 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(birthsLog)  </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>x_full <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(lWeight <span class="sc">~</span> ., <span class="at">data =</span> births2) </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>y_full <span class="ot">&lt;-</span> births2<span class="sc">$</span>lWeight</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>x_test <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(lWeight <span class="sc">~</span> ., <span class="at">data =</span> B.test2)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>y_test <span class="ot">&lt;-</span> B.test2<span class="sc">$</span>lWeight</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>lambda.v <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="dv">10</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>model.lasso <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x_full, y_full, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">lambda =</span> lambda.v)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>coeffsL <span class="ot">&lt;-</span> <span class="fu">coef</span>(model.lasso)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>cv.outputL <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x_full, y_full, <span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>bestlamb.cvL <span class="ot">&lt;-</span> cv.outputL<span class="sc">$</span>lambda.min</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best Lambda (Lasso):"</span>, bestlamb.cvL, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Lambda (Lasso): 0.0006381994 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>best_lasso <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x_full, y_full, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">lambda =</span> bestlamb.cvL)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Training MSE</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>pred.lasso.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(best_lasso, <span class="at">newx =</span> x_full, <span class="at">s =</span> bestlamb.cvL, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>pred.lasso.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(best_lasso, <span class="at">newx =</span> x_test, <span class="at">s =</span> bestlamb.cvL, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>train_mse_lasso <span class="ot">&lt;-</span> <span class="fu">mean</span>((y_full <span class="sc">-</span> pred.lasso.train)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>test_mse_lasso <span class="ot">&lt;-</span> <span class="fu">mean</span>((y_test <span class="sc">-</span> pred.lasso.test)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training MSE (Lasso):"</span>, train_mse_lasso, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training MSE (Lasso): 0.00642802 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Testing MSE (Lasso):"</span>, test_mse_lasso, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Testing MSE (Lasso): 0.006628631 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot cross-validation results</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(<span class="fu">log</span>(cv.outputL<span class="sc">$</span>lambda), cv.outputL<span class="sc">$</span>cvm) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> cv.outputL<span class="sc">$</span>cvm <span class="sc">-</span> cv.outputL<span class="sc">$</span>cvsd, </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> cv.outputL<span class="sc">$</span>cvm <span class="sc">+</span> cv.outputL<span class="sc">$</span>cvsd)) <span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Cross-Validation Error vs Lambda (Log Scale)"</span>) <span class="sc">+</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log(Lambda)"</span>) <span class="sc">+</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Cross-Validation Error"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2-project_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The Lasso regression model has a lower MSE than the linear model (by about 0.003), which shows that the shrinkage technique in Lasso regression can improve model generalization while preventing overfitting. </span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Also, the Cross-Validation Error vs Lambda plot shows the error increasing rapidly as the log of lambda moves from -4 to 0.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="e." class="level1">
<h1>e.</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>y.pred.train_lasso <span class="ot">&lt;-</span> <span class="fu">predict</span>(best_lasso, x_full, <span class="at">s =</span> bestlamb.cvL)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>mse_train_lasso <span class="ot">&lt;-</span> <span class="fu">mean</span>((y_full <span class="sc">-</span> y.pred.train_lasso)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training MSE (Lasso): "</span>, mse_train_lasso, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training MSE (Lasso):  0.00642802 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>y.pred.test_lasso <span class="ot">&lt;-</span> <span class="fu">predict</span>(best_lasso, x_test, <span class="at">s =</span> bestlamb.cvL)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>mse_test_lasso <span class="ot">&lt;-</span> <span class="fu">mean</span>((y_test <span class="sc">-</span> y.pred.test_lasso)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Testing MSE (Lasso): "</span>, mse_test_lasso, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Testing MSE (Lasso):  0.006628631 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create design matrix (x) and response variable (y)</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(lWeight <span class="sc">~</span> ., <span class="at">data =</span> births2)  <span class="co"># Design matrix (excluding intercept)</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> births2<span class="sc">$</span>lWeight  <span class="co"># Response variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The multiple linear regression model uses all predictors, resulting in high bias and less flexibility, with training and testing MSE values of 721256.4 and 707930.6, respectively.</p>
<p>The stepwise regression model, selecting 8 predictors, has only a slightly better MSE (721443.2 and 709755.3) respectively.</p>
<p>Ridge regression, with a lambda of 0.00224, after a log transformation, achieves a training MSE of 0.006721434 and a testing MSE of 0.006942309 by applying penalties to predictors, balancing bias and flexibility. These MSE are better that what was shown in stepwise.</p>
<p>The Lasso model, with similar performance (training MSE: 0.00642802, Testing MSE: 0.006628631), further reduces predictors, offering higher flexibility and lower variance.</p>
<p>Based on the MSE values, Lasso Regression appears to be the best model. It has the lowest MSE on both the training (0.00642802) and testing sets (0.006628631), suggesting a good balance between bias and variance.</p>
</section>
<section id="section" class="level1">
<h1>2</h1>
<p>Write a short paragraph comparing these approaches in terms of their final number of predictors, their bias and their flexibility.</p>
<p>Ridge and Lasso regression handle regularization differently. Ridge reduces the size of all coefficients but keeps them in the model, which is great for handling multicollinearity and balancing bias and variance. Lasso can shrink some coefficients to zero, which removes less important predictors and making the model simpler. Ridge is better when you have many small, correlated effects, while Lasso works well when you want to focus on just the key predictors.</p>
</section>
<section id="a.-1" class="level1">
<h1>a.</h1>
<p>Fit a PCR model on the training set, with M principal components chosen by cross validation. Report the MSE obtained using both data sets (training and testing). along with the value of M principal components selected by cross-validation. Report the amount of variation explained in the X matrix by those M principal component.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>pcrmodel <span class="ot">&lt;-</span> <span class="fu">pcr</span>(B.train<span class="sc">$</span>Birth.Weight..g.<span class="sc">~</span>., <span class="at">data=</span>B.train, <span class="at">scale=</span><span class="cn">TRUE</span>, <span class="at">validation=</span><span class="st">"CV"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pcrmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data:   X dimension: 5000 49 
    Y dimension: 5000 1
Fit method: svdpc
Number of components considered: 49

VALIDATION: RMSEP
Cross-validated using 10 random segments.
       (Intercept)  1 comps  2 comps  3 comps  4 comps  5 comps  6 comps
CV           611.4    610.1    608.2    603.8    503.2    336.4    306.3
adjCV        611.4    610.1    608.2    603.8    502.7    335.0    306.0
       7 comps  8 comps  9 comps  10 comps  11 comps  12 comps  13 comps
CV       306.1    306.2    305.9     305.0     304.7     304.5     304.2
adjCV    305.9    305.9    305.8     304.8     304.6     304.4     304.1
       14 comps  15 comps  16 comps  17 comps  18 comps  19 comps  20 comps
CV          299     293.5     293.2     292.3     291.8     291.8     291.6
adjCV       299     293.2     292.9     292.1     291.6     291.6     291.5
       21 comps  22 comps  23 comps  24 comps  25 comps  26 comps  27 comps
CV        290.7     290.0     289.7     289.3     288.7     285.9     285.1
adjCV     290.5     289.7     289.6     289.3     287.9     285.3     285.1
       28 comps  29 comps  30 comps  31 comps  32 comps  33 comps  34 comps
CV        282.7     278.4     278.1     277.5     277.4     256.1     139.9
adjCV     282.9     278.1     278.0     277.3     277.4     276.9     139.4
       35 comps  36 comps  37 comps  38 comps  39 comps  40 comps  41 comps
CV        139.2     139.2     139.1     138.6     138.1     138.1     138.2
adjCV     139.0     139.1     139.0     138.6     138.0     138.0     138.1
       42 comps  43 comps  44 comps  45 comps  46 comps  47 comps  48 comps
CV        138.2     138.2     138.2     138.3     138.3     138.3     138.3
adjCV     138.2     138.1     138.2     138.2     138.2     138.2     138.2
       49 comps
CV        138.5
adjCV     138.2

TRAINING: % variance explained
                          1 comps  2 comps  3 comps  4 comps  5 comps  6 comps
X                         11.8474   22.343   31.207    36.50    41.21    45.71
B.train$Birth.Weight..g.   0.4779    1.156    2.635    32.49    70.13    74.99
                          7 comps  8 comps  9 comps  10 comps  11 comps
X                            49.2    52.60    55.89     59.14     62.07
B.train$Birth.Weight..g.     75.0    75.07    75.07     75.31     75.36
                          12 comps  13 comps  14 comps  15 comps  16 comps
X                            64.78     67.27     69.53     71.71     73.80
B.train$Birth.Weight..g.     75.42     75.48     76.38     77.23     77.29
                          17 comps  18 comps  19 comps  20 comps  21 comps
X                            75.83     77.84     79.82     81.63     83.23
B.train$Birth.Weight..g.     77.45     77.55     77.55     77.60     77.73
                          22 comps  23 comps  24 comps  25 comps  26 comps
X                            84.78     86.27     87.53     88.73     89.92
B.train$Birth.Weight..g.     77.93     77.94     78.00     78.27     78.65
                          27 comps  28 comps  29 comps  30 comps  31 comps
X                            91.07     92.09     93.06     93.96     94.78
B.train$Birth.Weight..g.     78.66     79.07     79.72     79.74     79.87
                          32 comps  33 comps  34 comps  35 comps  36 comps
X                            95.56     96.23     96.85     97.39     97.85
B.train$Birth.Weight..g.     79.88     79.92     94.87     94.90     94.91
                          37 comps  38 comps  39 comps  40 comps  41 comps
X                            98.29     98.71     99.05     99.37     99.69
B.train$Birth.Weight..g.     94.91     94.95     94.99     94.99     94.99
                          42 comps  43 comps  44 comps  45 comps  46 comps
X                            99.85     99.99     99.99       100       100
B.train$Birth.Weight..g.     94.99     95.00     95.00        95        95
                          47 comps  48 comps  49 comps
X                              100       100       100
B.train$Birth.Weight..g.        95        95        95</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">validationplot</span>(pcrmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2-project_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose 40 principle components based on analysis of summary of pcr model</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># amount of variation explained by 40 principal components: 99.37% (also from pcr model analysis)</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check to see the optimal M and the amount of variation</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>optimal_M <span class="ot">&lt;-</span> <span class="fu">which.min</span>(pcrmodel<span class="sc">$</span>validation<span class="sc">$</span>PRESS)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Test model</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>train_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(pcrmodel, <span class="at">newdata =</span> B.train, <span class="at">ncomp =</span> optimal_M)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>MSE.Btrain <span class="ot">&lt;-</span> <span class="fu">mean</span>((B.train<span class="sc">$</span>Birth.Weight..g. <span class="sc">-</span> train_predictions)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>test_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(pcrmodel,<span class="at">newdata =</span> B.test , <span class="at">ncomp =</span> optimal_M)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>MSE.Btest <span class="ot">&lt;-</span> <span class="fu">mean</span>((B.test<span class="sc">$</span>Birth.Weight..g. <span class="sc">-</span> test_predictions)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal M:"</span>, optimal_M, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal M: 40 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#cat("Amount of Variance explained by the optimal M:", explained_variance, "\n")</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training MSE:"</span>, MSE.Btrain, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training MSE: 18709.24 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Testing MSE:"</span>, MSE.Btest, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Testing MSE: 19207.04 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The validation plot is a visualization for the optimal M by showing that the RMSEP is lowest beginning at around 38.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="b.-1" class="level1">
<h1>b.</h1>
<p>Fit a PLS model on the training set, with M principal components chosen by cross validation. Report the MSE obtained using both data sets (training and testing), along with the value of M principal components selected by cross-validation. Report the amount of variation explained in the X matrix by those M principal component. Note: Use 85% as your threshold for the amount of variation in the X matrix</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>plsmodel <span class="ot">&lt;-</span> <span class="fu">plsr</span>(B.train<span class="sc">$</span>Birth.Weight..g.<span class="sc">~</span>., <span class="at">data=</span>B.train, <span class="at">scale=</span><span class="cn">TRUE</span>, <span class="at">validation=</span><span class="st">"CV"</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(plsmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data:   X dimension: 5000 49 
    Y dimension: 5000 1
Fit method: kernelpls
Number of components considered: 49

VALIDATION: RMSEP
Cross-validated using 10 random segments.
       (Intercept)  1 comps  2 comps  3 comps  4 comps  5 comps  6 comps
CV           611.4    284.8    248.3    197.6    162.1    146.8    141.5
adjCV        611.4    284.6    248.2    197.5    161.8    146.6    141.4
       7 comps  8 comps  9 comps  10 comps  11 comps  12 comps  13 comps
CV       138.7    138.2    138.1     138.1     138.1     138.1     138.1
adjCV    138.7    138.1    138.1     138.0     138.0     138.1     138.1
       14 comps  15 comps  16 comps  17 comps  18 comps  19 comps  20 comps
CV        138.1     138.1     138.1     138.1     138.1     138.1     138.1
adjCV     138.1     138.1     138.1     138.1     138.1     138.1     138.1
       21 comps  22 comps  23 comps  24 comps  25 comps  26 comps  27 comps
CV        138.1     138.2     138.2     138.2     138.2     138.2     138.2
adjCV     138.1     138.1     138.1     138.1     138.1     138.1     138.1
       28 comps  29 comps  30 comps  31 comps  32 comps  33 comps  34 comps
CV        138.2     138.2     138.2     138.2     138.2     138.2     138.2
adjCV     138.1     138.1     138.1     138.1     138.1     138.1     138.1
       35 comps  36 comps  37 comps  38 comps  39 comps  40 comps  41 comps
CV        138.2     138.2     138.2     138.2     138.2     138.2     138.2
adjCV     138.1     138.1     138.1     138.1     138.1     138.1     138.1
       42 comps  43 comps  44 comps  45 comps  46 comps  47 comps  48 comps
CV        138.2     138.2     138.2     138.2     138.2     138.2     138.2
adjCV     138.1     138.1     138.1     138.1     138.1     138.1     138.1
       49 comps
CV        138.2
adjCV     138.1

TRAINING: % variance explained
                          1 comps  2 comps  3 comps  4 comps  5 comps  6 comps
X                           5.585    15.15    20.14    26.76    32.35    39.33
B.train$Birth.Weight..g.   78.466    83.66    89.78    93.17    94.37    94.76
                          7 comps  8 comps  9 comps  10 comps  11 comps
X                           43.83    45.97    48.90     52.03     53.96
B.train$Birth.Weight..g.    94.95    94.99    94.99     94.99     95.00
                          12 comps  13 comps  14 comps  15 comps  16 comps
X                            55.52      57.5     59.42     61.21     62.78
B.train$Birth.Weight..g.     95.00      95.0     95.00     95.00     95.00
                          17 comps  18 comps  19 comps  20 comps  21 comps
X                            64.59     66.67     68.34     70.63     72.17
B.train$Birth.Weight..g.     95.00     95.00     95.00     95.00     95.00
                          22 comps  23 comps  24 comps  25 comps  26 comps
X                            73.83     75.04     76.28     77.71     79.09
B.train$Birth.Weight..g.     95.00     95.00     95.00     95.00     95.00
                          27 comps  28 comps  29 comps  30 comps  31 comps
X                            81.23     82.88     83.89     85.07     86.27
B.train$Birth.Weight..g.     95.00     95.00     95.00     95.00     95.00
                          32 comps  33 comps  34 comps  35 comps  36 comps
X                            87.65     88.55     89.26     90.46     91.37
B.train$Birth.Weight..g.     95.00     95.00     95.00     95.00     95.00
                          37 comps  38 comps  39 comps  40 comps  41 comps
X                            92.52     93.49     94.46     95.91      97.2
B.train$Birth.Weight..g.     95.00     95.00     95.00     95.00      95.0
                          42 comps  43 comps  44 comps  45 comps  46 comps
X                            97.95     98.45     99.39       100     100.1
B.train$Birth.Weight..g.     95.00     95.00     95.00        95      95.0
                          47 comps  48 comps  49 comps
X                            100.2     100.3     100.5
B.train$Birth.Weight..g.      95.0      95.0      95.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">validationplot</span>(plsmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2-project_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose 10 principal components (from summary analysis)</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># amount of variation explained by 10 principal components: 94.99%</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check to see the optimal M and the amount of variation</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>optimal_M <span class="ot">&lt;-</span> <span class="fu">which.min</span>(plsmodel<span class="sc">$</span>validation<span class="sc">$</span>PRESS)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>explained_variance <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(<span class="fu">explvar</span>(plsmodel))</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>train_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(plsmodel, <span class="at">newdata =</span> B.train, <span class="at">ncomp =</span> optimal_M)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>MSE.Btrain <span class="ot">&lt;-</span> <span class="fu">mean</span>((B.train<span class="sc">$</span>Birth.Weight..g. <span class="sc">-</span> train_predictions)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>test_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(plsmodel,<span class="at">newdata =</span> B.test , <span class="at">ncomp =</span> optimal_M)</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>MSE.Btest <span class="ot">&lt;-</span> <span class="fu">mean</span>((B.test<span class="sc">$</span>Birth.Weight..g. <span class="sc">-</span> test_predictions)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal M:"</span>, optimal_M, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal M: 10 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#cat("Amount of Variance explained by the optimal M:", explained_variance, "\n")</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training MSE:"</span>, MSE.Btrain, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training MSE: 18701.52 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Testing MSE:"</span>, MSE.Btest, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Testing MSE: 19238.18 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The validation plot is a visualization for the optimal M by showing that the RMSEP is lowest beginning at a little before 10.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="c.-1" class="level1">
<h1>c.</h1>
<p>Fit a GAM on the training data, using “the weight of the baby in grams” as the response and the features selected in the previous step BIC function (Question 1 Part b) as your predictors. Plot the results, and explain your findings.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>gammodel <span class="ot">&lt;-</span> <span class="fu">gam</span>(B.train<span class="sc">$</span>Birth.Weight..g. <span class="sc">~</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">s</span>(Weeks) <span class="sc">+</span> </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">s</span>(Wt.Gain) <span class="sc">+</span> </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>                  Plurality.of.birth <span class="sc">+</span> Gender <span class="sc">+</span> Race <span class="sc">+</span> </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>                  Birth.weight.group <span class="sc">+</span> Father.Minority <span class="sc">+</span> Smoker, </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> B.train)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(gammodel)</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)) </span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(gammodel, se = TRUE, shade = TRUE)</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>train_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gammodel, <span class="at">newdata =</span> B.train)</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>train_mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((B.train<span class="sc">$</span>Birth.Weight..g. <span class="sc">-</span> train_predictions)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Training MSE:"</span>, train_mse, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training MSE: 18783.65 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Unfortunately, I've run into errors with the plot function.</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>B.train<span class="sc">$</span>Predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(gammodel, <span class="at">newdata =</span> B.train)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(B.train, <span class="fu">aes</span>(<span class="at">x =</span> Birth.Weight..g., <span class="at">y =</span> Predicted)) <span class="sc">+</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Actual vs Predicted Birth Weight"</span>,</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Actual Birth Weight (grams)"</span>,</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted Birth Weight (grams)"</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2-project_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The actual vs.&nbsp;predicted weights plot shows that the GAM model fits the training data very well. It accurately predicts the baby weights given the significant predictors chosen from the step BIC function. Also, the training and testing MSE are relatively close and does not overfit. The testing MSE is higher than the training, as expected.</p>
</section>
<section id="d.-1" class="level1">
<h1>d.&nbsp;</h1>
<p>Evaluate the model obtained on the testing data set, and explain the results obtained.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(splines)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>gammodel2 <span class="ot">&lt;-</span> <span class="fu">gam</span>(Birth.Weight..g. <span class="sc">~</span> Plurality.of.birth <span class="sc">+</span> Gender <span class="sc">+</span> Race <span class="sc">+</span> <span class="fu">s</span>(Weeks, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span> Birth.weight.group <span class="sc">+</span> Father.Minority <span class="sc">+</span> Smoker <span class="sc">+</span> <span class="fu">s</span>(Wt.Gain, <span class="at">k =</span> <span class="dv">5</span>),<span class="at">data =</span> B.test)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(gammodel2)</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>B.test<span class="sc">$</span>Predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(gammodel2, <span class="at">newdata =</span> B.test)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>test_mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((B.test<span class="sc">$</span>Birth.Weight..g. <span class="sc">-</span> B.test<span class="sc">$</span>Predicted)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>ss_total <span class="ot">&lt;-</span> <span class="fu">sum</span>((B.test<span class="sc">$</span>Birth.Weight..g. <span class="sc">-</span> <span class="fu">mean</span>(B.test<span class="sc">$</span>Birth.Weight..g.))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>ss_residual <span class="ot">&lt;-</span> <span class="fu">sum</span>((B.test<span class="sc">$</span>Birth.Weight..g. <span class="sc">-</span> B.test<span class="sc">$</span>Predicted)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (ss_residual <span class="sc">/</span> ss_total)</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(B.test, <span class="fu">aes</span>(<span class="at">x =</span> Birth.Weight..g., <span class="at">y =</span> Predicted)) <span class="sc">+</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Actual vs Predicted Birth Weight (Testing Data)"</span>,</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"Actual Birth Weight (grams)"</span>,</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"Predicted Birth Weight (grams)"</span></span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2-project_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Testing MSE:"</span>, test_mse, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Testing MSE: 19084.45 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Testing R-squared:"</span>, r_squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Testing R-squared: 0.9476297 </code></pre>
</div>
</div>
<p>The GAM model fits the data very well with a high r squared, and the the model does not overfit as the testing MSE is similar to the training MSE and does not overfit. The testing MSE is higher than the training, as expected.</p>
</section>
<section id="e.-1" class="level1">
<h1>e.</h1>
<p>For which of the predictor variables in part c, if any, an evidence of a non-linear relationship with the response variable?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gammodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
B.train$Birth.Weight..g. ~ s(Weeks) + s(Wt.Gain) + Plurality.of.birth + 
    Gender + Race + Birth.weight.group + Father.Minority + Smoker

Parametric coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)           528.934     20.235  26.139  &lt; 2e-16 ***
Plurality.of.birth    -37.088     10.774  -3.442 0.000582 ***
Gender                 -9.625      3.921  -2.455 0.014128 *  
RaceOther              10.493     10.307   1.018 0.308749    
RaceWhite              22.275      9.578   2.326 0.020073 *  
Birth.weight.group    455.856      2.042 223.264  &lt; 2e-16 ***
Father.MinorityWhite    5.287      8.804   0.601 0.548183    
SmokerNo               27.350      6.716   4.072 4.73e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Approximate significance of smooth terms:
             edf Ref.df      F p-value    
s(Weeks)   2.901  3.669 47.305 &lt; 2e-16 ***
s(Wt.Gain) 2.039  2.608  4.177 0.00733 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

R-sq.(adj) =   0.95   Deviance explained =   95%
GCV =  18881  Scale est. = 18832     n = 5000</code></pre>
</div>
</div>
<p>“Weeks” shows evidence of a moderate non-linear relationship with birth weight. “Wt.Gain” shows a weak non-linear relationship, suggesting it is closer to linear but not completely. They both have p-values less than 0.05, suggesting that there is evidence for a non-linear relationship between the variables.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>© 2024, Fathima Shaikh</p>
</div>
  </div>
</footer>




</body></html>