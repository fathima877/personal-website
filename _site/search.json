[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\nrunif(20)\n\n [1] 0.6217002 0.2203270 0.6647904 0.3807230 0.2656674 0.8370363 0.9384306\n [8] 0.6739848 0.8343916 0.8320206 0.5924358 0.4591586 0.7138521 0.1699831\n[15] 0.5573226 0.6512141 0.3845679 0.2710936 0.4965557 0.4995613"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Fathima Shaikh",
    "section": "",
    "text": "Fathima Shaikh is a 4th year undergraduate at UCLA studying Statistics and Data Science. She has completed all required courses, and relevant courses can be viewed in “Courses”. Additionally, she has diverse internship experiences which can be viewed in “CV”. Lastly, she passionate in creating machine learning models, which can be viewed in “Projects”."
  },
  {
    "objectID": "index.html#education",
    "href": "index.html#education",
    "title": "Fathima Shaikh",
    "section": "Education",
    "text": "Education\nUniversity of California, Los Angeles | B.S in Statistics and Data Science | Sept 2021 - June 2025"
  },
  {
    "objectID": "index.html#experience",
    "href": "index.html#experience",
    "title": "Fathima Shaikh",
    "section": "Experience",
    "text": "Experience\nWengo Analytics | Head Data Scientist | April 2018 - present\nGeoScynce | Chief Analyst | Spet 2012 - April 2018"
  },
  {
    "objectID": "Projects.html",
    "href": "Projects.html",
    "title": "Fathima Shaikh",
    "section": "",
    "text": "Here is project 1"
  },
  {
    "objectID": "Projects.html#project-2",
    "href": "Projects.html#project-2",
    "title": "Fathima Shaikh",
    "section": "Project 2",
    "text": "Project 2"
  },
  {
    "objectID": "Projects.html#project-1",
    "href": "Projects.html#project-1",
    "title": "Fathima Shaikh",
    "section": "",
    "text": "Here is project 1"
  },
  {
    "objectID": "projects/01-project.html",
    "href": "projects/01-project.html",
    "title": "College Expense Prediction",
    "section": "",
    "text": "College &lt;- read.csv(\"CollegeF23.csv\")\nset.seed(11281975)\nindex =sample(nrow(College), 2100,replace = FALSE)\nC.train=College[index,]\nC.test=College[-index,]\ndim(C.train)\n\n[1] 2100   18\n\ndim(C.test)\n\n[1] 900  18"
  },
  {
    "objectID": "projects.html",
    "href": "projects.html",
    "title": "Fathima Shaikh",
    "section": "",
    "text": "Title\n\n\n\n\nSubtitle\n\n\n\n\n\n\nCollege Expense Prediction\n\n\n\n\n\nThis project predicts college attendance costs using factors like private status, out-of-state enrollment, and student population, with a random forest model performing best.\n\n\n\n\nBirth Weight Predictions (Code Displayed and Interpreted)\n\n\n\n\n\nThis is a dataset from the North Carolina State Center for Health Statistics. It consists of variables related to the baby, parents, and hospital. This project aims to find out which machine learning model, and which predictors can help predict a baby’s weight at birth.\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "projects.html#project-1",
    "href": "projects.html#project-1",
    "title": "Fathima Shaikh",
    "section": "",
    "text": "Here is project 1"
  },
  {
    "objectID": "projects.html#project-2",
    "href": "projects.html#project-2",
    "title": "Fathima Shaikh",
    "section": "Project 2",
    "text": "Project 2\nHere is project 2"
  },
  {
    "objectID": "projects/02-project.html",
    "href": "projects/02-project.html",
    "title": "Project 2",
    "section": "",
    "text": "plot(c(1,2,3,4), c(2,3,4,5))"
  },
  {
    "objectID": "courses.html",
    "href": "courses.html",
    "title": "Relevant Courses Taken",
    "section": "",
    "text": "All classes are introductory classes\n\nBootstrapping\nMonte Carlo Methods\nData Mining\nMachine Learning Models\nStatistical Modeling\nStatistical Principles\nAdvanced Probability and Statistics"
  },
  {
    "objectID": "projects/01-project.html#i.",
    "href": "projects/01-project.html#i.",
    "title": "College Expense Prediction",
    "section": "i.",
    "text": "i.\n9 predictors used: “F.Undergrad”,“Outstate”,“Terminal”,“Top10perc”,“Grad.Rate”,“PhD”,“Top25perc”,“Expend”,“Accept”"
  },
  {
    "objectID": "projects/01-project.html#ii.-17-terminal-nodes",
    "href": "projects/01-project.html#ii.-17-terminal-nodes",
    "title": "College Expense Prediction",
    "section": "ii. 17 terminal nodes",
    "text": "ii. 17 terminal nodes"
  },
  {
    "objectID": "projects/01-project.html#iii.-mcr-0.01762",
    "href": "projects/01-project.html#iii.-mcr-0.01762",
    "title": "College Expense Prediction",
    "section": "iii. MCR: 0.01762",
    "text": "iii. MCR: 0.01762"
  },
  {
    "objectID": "projects/01-project.html#iv.",
    "href": "projects/01-project.html#iv.",
    "title": "College Expense Prediction",
    "section": "iv.",
    "text": "iv.\n\ntest_predictions &lt;- predict(tree_model, C.test, type = \"class\")\ntable(C.test$Private, test_predictions)\n\n     test_predictions\n       No Yes\n  No  236   8\n  Yes   4 652\n\n\n\n(4+8)/(234 + 8 + 4 + 652)\n\n[1] 0.01336303\n\n\nThe testing MCR is 1.33%."
  },
  {
    "objectID": "projects/01-project.html#i.-1",
    "href": "projects/01-project.html#i.-1",
    "title": "College Expense Prediction",
    "section": "i.",
    "text": "i.\n\nsummary(C.train$Expend)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   3186    6863    8444    9727   10822   56233 \n\n\n\nsummary(C.test$Expend)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   3186    6704    8189    9477   10622   45702"
  },
  {
    "objectID": "projects/01-project.html#ii.",
    "href": "projects/01-project.html#ii.",
    "title": "College Expense Prediction",
    "section": "ii.",
    "text": "ii.\n\nggplot(C.train,aes(x = Expend))+geom_density(fill = \"blue\", alpha = 0.5)+labs(title = \"Density Plot of Expend\",x = \"Expend\",y = \"Density\")+theme_minimal()\n\n\n\n\n\n\n\n\n\niii.\n\nC.train$Expend &lt;-log(C.train$Expend)\nC.test$Expend &lt;-log(C.test$Expend)\nggplot(C.train,aes(x = Expend))+geom_density(fill = \"blue\", alpha = 0.5)+labs(title = \"Density Plot of Log(Expend)\",x = \"Expend\",y = \"Density\")+theme_minimal()"
  },
  {
    "objectID": "projects/01-project.html#i.-2",
    "href": "projects/01-project.html#i.-2",
    "title": "College Expense Prediction",
    "section": "i.",
    "text": "i.\n\nimportance(bagging)\n\n                   No      Yes MeanDecreaseAccuracy MeanDecreaseGini\nApps         7.996776 14.63382             16.29653         7.852547\nAccept      16.440909 16.77159             22.45017        18.458509\nEnroll       9.946075 10.29376             13.71551         9.608839\nTop10perc   24.656129 22.80333             29.19540        15.902975\nTop25perc   21.502638 25.66150             27.33541        13.640813\nF.Undergrad 81.217340 78.50145            105.98728       387.934372\nP.Undergrad 22.044252 34.70942             34.37470        28.152861\nOutstate    94.639180 97.70798            137.65480       200.661968\nRoom.Board  14.147645 38.00999             39.62783        15.609351\nBooks       15.064323 21.26806             20.72064         5.125512\nPersonal    11.723063 15.97299             18.08786         3.527622\nPhD         20.798156 18.54041             24.07538        13.790794\nTerminal    38.247797 23.37693             38.82201        19.796038\nS.F.Ratio   13.228533 15.97735             18.68794         5.975525\nperc.alumni 26.961270 18.60419             29.63970         7.436632\nGrad.Rate   18.230071 14.98763             20.89308         8.983862\nExpend      10.470543 15.27206             17.96734         5.633619"
  },
  {
    "objectID": "projects/01-project.html#ii.-1",
    "href": "projects/01-project.html#ii.-1",
    "title": "College Expense Prediction",
    "section": "ii.",
    "text": "ii.\n\n# Plot variable importance\nvarImpPlot(bagging)\n\n\n\n\n\n\n\n\nThe most importance variables is “Outstate”."
  },
  {
    "objectID": "projects/01-project.html#iii.-1",
    "href": "projects/01-project.html#iii.-1",
    "title": "College Expense Prediction",
    "section": "iii.",
    "text": "iii.\n\n# Report testing MCR\npredictions &lt;- predict(bagging, newdata = C.test)\nactual &lt;- C.test$Private  \nmisclassification_rate &lt;- mean(predictions != actual)\nmisclassification_rate\n\n[1] 0.001111111\n\n\nThe testing MCR is 0.11%"
  },
  {
    "objectID": "projects/01-project.html#i.-3",
    "href": "projects/01-project.html#i.-3",
    "title": "College Expense Prediction",
    "section": "i.",
    "text": "i.\n\n# Report important variables\nimportance(log_bagging)\n\n              %IncMSE IncNodePurity\nPrivate       7.85475     0.1365468\nApps         29.29824     4.1939672\nAccept       17.38036     2.9655459\nEnroll       30.21717     3.5845051\nTop10perc    70.60875    28.9734666\nTop25perc    22.16605     7.2507768\nF.Undergrad  27.89312     3.6979415\nP.Undergrad  59.33170     7.0736315\nOutstate    120.41569   193.0642281\nRoom.Board   32.13347    10.0754965\nBooks        40.52761     3.8407706\nPersonal     42.15975     4.6976768\nPhD          49.44477    14.2506218\nTerminal     38.25795     7.3654831\nS.F.Ratio   138.11138    51.6618400\nperc.alumni  47.62025     5.4791384\nGrad.Rate    25.96474     4.8544786"
  },
  {
    "objectID": "projects/01-project.html#ii.-2",
    "href": "projects/01-project.html#ii.-2",
    "title": "College Expense Prediction",
    "section": "ii.",
    "text": "ii.\n\n# Plot variable importance\nvarImpPlot(log_bagging)\n\n\n\n\n\n\n\n\nThe most importance predictor based on %IncMSE is S.F ratio"
  },
  {
    "objectID": "projects/01-project.html#iii.-2",
    "href": "projects/01-project.html#iii.-2",
    "title": "College Expense Prediction",
    "section": "iii.",
    "text": "iii.\n\n# Predict log(Expend) with testing data \ntest_predictions.2 &lt;- predict(log_bagging, newdata = C.test)\ntest_residuals &lt;- C.test$Expend - test_predictions.2\nmean(test_residuals^2)\n\n[1] 0.002179744\n\n\nThe testing MSE 0.218%"
  },
  {
    "objectID": "projects/01-project.html#iv.-1",
    "href": "projects/01-project.html#iv.-1",
    "title": "College Expense Prediction",
    "section": "iv.",
    "text": "iv.\nThe R squared of the model is 97.73%"
  },
  {
    "objectID": "index.html#about",
    "href": "index.html#about",
    "title": "Fathima Shaikh",
    "section": "",
    "text": "Fathima Shaikh is a 4th year undergraduate at UCLA studying Statistics and Data Science. She has completed all required courses, and relevant courses can be viewed in “Courses”. Additionally, she has diverse internship experiences which can be viewed in “CV”. Lastly, she passionate in creating machine learning models, which can be viewed in “Projects”."
  },
  {
    "objectID": "index.html#notable-experiences",
    "href": "index.html#notable-experiences",
    "title": "Fathima Shaikh",
    "section": "Notable Experiences",
    "text": "Notable Experiences\nGeneral Motors | Digital Enablement Intern | Jun. - Aug. 2024 | Detroit, MI"
  },
  {
    "objectID": "projects/2-project.html",
    "href": "projects/2-project.html",
    "title": "Birth Weight Predictions (Code Displayed and Interpreted)",
    "section": "",
    "text": "Download these packages: caret, glmnet, ggplot2, readr, pls, and mgcv.\n\n\n\nbirths &lt;- read.csv(\"~/Downloads/birthsnewone.csv\")\nset.seed(123456789)\nhead(births)\n\n  X Institution.type Plurality.of.birth Gender Race.of.child  Race\n1 1                1                  1      2             1 White\n2 2                1                  1      2             1 White\n3 3                1                  1      2             1 White\n4 4                1                  1      2             2 Black\n5 5                1                  1      1             2 Black\n6 6                1                  1      2             1 White\n  Age.of.father Age.of.mother Education.of.father..years.\n1            50            24                          12\n2            19            18                           9\n3            37            35                          17\n4            39            31                          11\n5            20            19                          11\n6            30            27                          16\n  Education.of.mother..years. Total.Preg BDead Terms Date.LBirth Month.LBirth\n1                          15          2     0     0       32004            3\n2                           9          1     0     0           0            0\n3                          17          2     0     0      112003           11\n4                          16          1     0     0           0            0\n5                          12          1     0     0           0            0\n6                          16          1     0     0           0            0\n  Year.LBirth LOutcome Weeks Prenatal Trimester.Prenatal Visits\n1        2004        1    38        3                  1     10\n2           0        9    35        3                  1      9\n3        2003        1    38        1                  1     20\n4           0        9    38        6                  2     12\n5           0        9    36        4                  2     10\n6           0        9    40        1                  1     20\n  Birth.weight.group Marital Birth.Attendant Numchild Month.Term Year.Term\n1                  5       2               1        1          0         0\n2                  6       2               1        0          0         0\n3                  5       1               1        1          0         0\n4                  5       2               1        0          0         0\n5                  6       2               1        0          0         0\n6                  6       1               1        0          0         0\n  Low.Birth RaceMom RaceDad Mother.Minority Father.Minority HispMom HispDad\n1      Norm       1       2           White        Nonwhite       N       N\n2      Norm       1       1           White           White       N       N\n3      Norm       1       1           White           White       N       N\n4      Norm       2       2        Nonwhite        Nonwhite       N       N\n5      Norm       2       1        Nonwhite           White       N       M\n6      Norm       1       1           White           White       N       N\n  AveCigs Smoker AveDrink Wt.Gain Birth.Weight..g.\n1       0     No        0      50         2865.875\n2      23   Cigs        0      35         3121.250\n3       0     No        0      24         2667.250\n4       0     No        0      30         2979.375\n5       0     No        0      10         3036.125\n6       0     No        0      37         3092.875\n\n\n\n\n\n\ndim(births)\n\n[1] 7861   39\n\nUniqueCount &lt;- sapply(births, function(x) length(unique(x)))\nFirstFewValues &lt;- sapply(births, function(x) paste0(head(x, 5), collapse = \", \"))\n\ndf.unique &lt;- data.frame(\n  Column = names(UniqueCount),\n  UniqueCount = UniqueCount,\n  FirstFewValues = FirstFewValues,\n  row.names = NULL\n)\n\ndf.unique\n\n                        Column UniqueCount\n1                            X        7861\n2             Institution.type           3\n3           Plurality.of.birth           4\n4                       Gender           2\n5                Race.of.child           9\n6                         Race           3\n7                Age.of.father          45\n8                Age.of.mother          34\n9  Education.of.father..years.          18\n10 Education.of.mother..years.          18\n11                  Total.Preg          15\n12                       BDead           4\n13                       Terms          12\n14                 Date.LBirth         233\n15                Month.LBirth          13\n16                 Year.LBirth          27\n17                    LOutcome           3\n18                       Weeks          28\n19                    Prenatal          10\n20          Trimester.Prenatal           3\n21                      Visits          35\n22          Birth.weight.group          10\n23                     Marital           2\n24             Birth.Attendant           5\n25                    Numchild          12\n26                  Month.Term          13\n27                   Year.Term          24\n28                   Low.Birth           2\n29                     RaceMom           9\n30                     RaceDad           9\n31             Mother.Minority           2\n32             Father.Minority           2\n33                     HispMom           7\n34                     HispDad           7\n35                     AveCigs          20\n36                      Smoker           2\n37                    AveDrink           6\n38                     Wt.Gain          85\n39            Birth.Weight..g.         167\n                                   FirstFewValues\n1                                   1, 2, 3, 4, 5\n2                                   1, 1, 1, 1, 1\n3                                   1, 1, 1, 1, 1\n4                                   2, 2, 2, 2, 1\n5                                   1, 1, 1, 2, 2\n6               White, White, White, Black, Black\n7                              50, 19, 37, 39, 20\n8                              24, 18, 35, 31, 19\n9                               12, 9, 17, 11, 11\n10                              15, 9, 17, 16, 12\n11                                  2, 1, 2, 1, 1\n12                                  0, 0, 0, 0, 0\n13                                  0, 0, 0, 0, 0\n14                         32004, 0, 112003, 0, 0\n15                                 3, 0, 11, 0, 0\n16                            2004, 0, 2003, 0, 0\n17                                  1, 9, 1, 9, 9\n18                             38, 35, 38, 38, 36\n19                                  3, 3, 1, 6, 4\n20                                  1, 1, 1, 2, 2\n21                              10, 9, 20, 12, 10\n22                                  5, 6, 5, 5, 6\n23                                  2, 2, 1, 2, 2\n24                                  1, 1, 1, 1, 1\n25                                  1, 0, 1, 0, 0\n26                                  0, 0, 0, 0, 0\n27                                  0, 0, 0, 0, 0\n28                   Norm, Norm, Norm, Norm, Norm\n29                                  1, 1, 1, 2, 2\n30                                  2, 1, 1, 2, 1\n31        White, White, White, Nonwhite, Nonwhite\n32        Nonwhite, White, White, Nonwhite, White\n33                                  N, N, N, N, N\n34                                  N, N, N, N, M\n35                                 0, 23, 0, 0, 0\n36                           No, Cigs, No, No, No\n37                                  0, 0, 0, 0, 0\n38                             50, 35, 24, 30, 10\n39 2865.875, 3121.25, 2667.25, 2979.375, 3036.125\n\n\nThere are 39 predictors, and 7861 data points. The column labeled “X” is an index column that r creates. It’s a placeholder index, so you easily access specific rows in your dataset using the index. It can be removed later in data manipulation."
  },
  {
    "objectID": "projects/2-project.html#load-your-data",
    "href": "projects/2-project.html#load-your-data",
    "title": "Birth Weight Predictions (Coding Process Explained)",
    "section": "Load your data",
    "text": "Load your data\n\nbirths &lt;- read.csv(\"~/Downloads/birthsnewone.csv\")\nset.seed(123456789)\nhead(births)\n\n  X Institution.type Plurality.of.birth Gender Race.of.child  Race\n1 1                1                  1      2             1 White\n2 2                1                  1      2             1 White\n3 3                1                  1      2             1 White\n4 4                1                  1      2             2 Black\n5 5                1                  1      1             2 Black\n6 6                1                  1      2             1 White\n  Age.of.father Age.of.mother Education.of.father..years.\n1            50            24                          12\n2            19            18                           9\n3            37            35                          17\n4            39            31                          11\n5            20            19                          11\n6            30            27                          16\n  Education.of.mother..years. Total.Preg BDead Terms Date.LBirth Month.LBirth\n1                          15          2     0     0       32004            3\n2                           9          1     0     0           0            0\n3                          17          2     0     0      112003           11\n4                          16          1     0     0           0            0\n5                          12          1     0     0           0            0\n6                          16          1     0     0           0            0\n  Year.LBirth LOutcome Weeks Prenatal Trimester.Prenatal Visits\n1        2004        1    38        3                  1     10\n2           0        9    35        3                  1      9\n3        2003        1    38        1                  1     20\n4           0        9    38        6                  2     12\n5           0        9    36        4                  2     10\n6           0        9    40        1                  1     20\n  Birth.weight.group Marital Birth.Attendant Numchild Month.Term Year.Term\n1                  5       2               1        1          0         0\n2                  6       2               1        0          0         0\n3                  5       1               1        1          0         0\n4                  5       2               1        0          0         0\n5                  6       2               1        0          0         0\n6                  6       1               1        0          0         0\n  Low.Birth RaceMom RaceDad Mother.Minority Father.Minority HispMom HispDad\n1      Norm       1       2           White        Nonwhite       N       N\n2      Norm       1       1           White           White       N       N\n3      Norm       1       1           White           White       N       N\n4      Norm       2       2        Nonwhite        Nonwhite       N       N\n5      Norm       2       1        Nonwhite           White       N       M\n6      Norm       1       1           White           White       N       N\n  AveCigs Smoker AveDrink Wt.Gain Birth.Weight..g.\n1       0     No        0      50         2865.875\n2      23   Cigs        0      35         3121.250\n3       0     No        0      24         2667.250\n4       0     No        0      30         2979.375\n5       0     No        0      10         3036.125\n6       0     No        0      37         3092.875"
  },
  {
    "objectID": "projects/2-project.html#understand-your-variables",
    "href": "projects/2-project.html#understand-your-variables",
    "title": "Birth Weight Predictions (Coding Process Explained)",
    "section": "Understand your variables",
    "text": "Understand your variables\n\nUniqueCount &lt;- sapply(births, function(x) length(unique(x)))\ndf.unique &lt;- as.data.frame(UniqueCount)"
  },
  {
    "objectID": "projects/2-project.html#make-sure-there-are-no-nas",
    "href": "projects/2-project.html#make-sure-there-are-no-nas",
    "title": "Birth Weight Predictions (Code Displayed and Interpreted)",
    "section": "Make sure there are no NA’s",
    "text": "Make sure there are no NA’s\n\nsum(is.na(births))\n\n[1] 0"
  },
  {
    "objectID": "projects/2-project.html#split-the-data-into-training-and-testing-groups",
    "href": "projects/2-project.html#split-the-data-into-training-and-testing-groups",
    "title": "Birth Weight Predictions (Code Displayed and Interpreted)",
    "section": "Split the data into training and testing groups",
    "text": "Split the data into training and testing groups\n\ni = 1:dim(births)[1]\ni.train &lt;- sample(i,5000,replace=FALSE)\nB.train = births[i.train, ]\nB.test = births[-i.train, ]"
  },
  {
    "objectID": "projects/2-project.html#start-out-by-testing-a-linear-model",
    "href": "projects/2-project.html#start-out-by-testing-a-linear-model",
    "title": "Birth Weight Predictions (Code Displayed and Interpreted)",
    "section": "Start out by testing a linear model",
    "text": "Start out by testing a linear model\n\n# test a linear model on the training data\nmodel &lt;- lm(Birth.Weight..g. ~ ., data = B.train)\nsummary(model)\n\n\nCall:\nlm(formula = Birth.Weight..g. ~ ., data = B.train)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-341.71 -110.67   -0.07  109.94  639.44 \n\nCoefficients: (4 not defined because of singularities)\n                              Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                 -1.447e+01  9.404e+01  -0.154 0.877708    \nX                           -2.965e-04  8.556e-04  -0.347 0.728957    \nInstitution.type            -5.559e+00  5.677e+00  -0.979 0.327524    \nPlurality.of.birth          -4.024e+01  1.121e+01  -3.590 0.000334 ***\nGender                      -9.678e+00  3.938e+00  -2.458 0.014024 *  \nRace.of.child               -1.401e+00  4.259e+00  -0.329 0.742224    \nRaceOther                    2.202e+01  1.777e+01   1.239 0.215244    \nRaceWhite                    2.324e+01  1.184e+01   1.963 0.049672 *  \nAge.of.father               -1.050e-01  4.394e-01  -0.239 0.811184    \nAge.of.mother                7.303e-01  5.506e-01   1.327 0.184729    \nEducation.of.father..years.  1.193e+00  1.033e+00   1.154 0.248441    \nEducation.of.mother..years. -2.347e-01  1.107e+00  -0.212 0.832138    \nTotal.Preg                   8.432e-01  2.657e+00   0.317 0.751008    \nBDead                        5.788e+00  1.477e+01   0.392 0.695273    \nTerms                        8.474e-01  4.422e+00   0.192 0.848025    \nDate.LBirth                  1.380e-02  5.924e-03   2.330 0.019863 *  \nMonth.LBirth                -1.386e+02  5.954e+01  -2.329 0.019925 *  \nYear.LBirth                         NA         NA      NA       NA    \nLOutcome                     1.757e+00  1.378e+00   1.275 0.202240    \nWeeks                        1.163e+01  9.640e-01  12.062  &lt; 2e-16 ***\nPrenatal                     1.470e+00  2.880e+00   0.511 0.609672    \nTrimester.Prenatal           5.674e-01  8.953e+00   0.063 0.949477    \nVisits                       6.325e-01  5.818e-01   1.087 0.277082    \nBirth.weight.group           4.539e+02  2.337e+00 194.232  &lt; 2e-16 ***\nMarital                     -6.235e+00  5.215e+00  -1.196 0.231923    \nBirth.Attendant              3.342e+00  3.091e+00   1.081 0.279571    \nNumchild                            NA         NA      NA       NA    \nMonth.Term                   2.393e+00  1.056e+00   2.267 0.023454 *  \nYear.Term                   -5.215e-03  4.262e-03  -1.224 0.221104    \nLow.BirthNorm                1.840e+01  9.944e+00   1.851 0.064267 .  \nRaceMom                             NA         NA      NA       NA    \nRaceDad                     -2.745e+00  3.630e+00  -0.756 0.449682    \nMother.MinorityWhite                NA         NA      NA       NA    \nFather.MinorityWhite        -3.872e+00  1.187e+01  -0.326 0.744185    \nHispMomM                     5.191e+01  7.150e+01   0.726 0.467843    \nHispMomN                     4.010e+01  7.072e+01   0.567 0.570709    \nHispMomO                     5.907e+01  8.418e+01   0.702 0.482837    \nHispMomP                     4.566e+01  7.490e+01   0.610 0.542131    \nHispMomS                     1.322e+01  7.179e+01   0.184 0.853885    \nHispMomU                     1.278e+02  1.166e+02   1.096 0.272940    \nHispDadM                    -1.417e+01  5.844e+01  -0.242 0.808441    \nHispDadN                    -1.208e+01  5.799e+01  -0.208 0.834984    \nHispDadO                    -2.533e+00  7.262e+01  -0.035 0.972181    \nHispDadP                    -2.507e+01  6.131e+01  -0.409 0.682672    \nHispDadS                     7.586e+00  5.869e+01   0.129 0.897169    \nHispDadU                    -9.431e+01  1.010e+02  -0.933 0.350683    \nAveCigs                      8.815e-01  1.140e+00   0.773 0.439512    \nSmokerNo                     3.162e+01  1.248e+01   2.535 0.011288 *  \nAveDrink                     5.329e+00  1.396e+01   0.382 0.702688    \nWt.Gain                      5.604e-01  1.500e-01   3.736 0.000189 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 137.3 on 4954 degrees of freedom\nMultiple R-squared:   0.95, Adjusted R-squared:  0.9495 \nF-statistic:  2091 on 45 and 4954 DF,  p-value: &lt; 2.2e-16\n\n# use the linear model and the training data to make predictions of birth weight\ntrain_pred &lt;- predict(model, data = B.train)\ntrain_mse &lt;- mean((births$Birth.Weight..g. - train_pred)^2)\n\n# do the same, but using testing data\ntest_pred &lt;- predict(model, B.test)\ntest_mse &lt;- mean((births$Birth.Weight..g - test_pred)^2)\n\n# Compare the training and testing mean squared error (average of the sum of squared residuals)\ncat(\"Training MSE:\", train_mse, \"\\n\")\n\nTraining MSE: 721481.8 \n\ncat(\"Testing MSE:\", test_mse)\n\nTesting MSE: 710234.1\n\n\nThe training MSE is higher than the testing MSE, which is strange because the model is fit to the training data, not testing. From the linear model, the significant predictors (predictors with a p-value &lt; 0.05) are: Plurality.of.birth, Gender, RaceWhite, Date.LBirth, Month.LBirth, Weeks, Birth.weight.group, Month.Term, Low.BirthNorm, SmokerNo, and Wt.Gain.\nThis is so cool! These results tell us that the plurality of birth (1 for 1 baby, 1 for twins, 3 for triplets..), gender, and being White have a large role in determining the baby’s birth weight."
  },
  {
    "objectID": "projects/2-project.html#try-out-a-backward-stepwise-model-and-choose-the-best-predictors",
    "href": "projects/2-project.html#try-out-a-backward-stepwise-model-and-choose-the-best-predictors",
    "title": "Birth Weight Predictions (Coding Process Explained)",
    "section": "Try out a backward stepwise model and choose the best predictors",
    "text": "Try out a backward stepwise model and choose the best predictors\n\nstepwise &lt;- step(model, direction = \"backward\")\n\nStart:  AIC=49270.91\nBirth.Weight..g. ~ X + Institution.type + Plurality.of.birth + \n    Gender + Race.of.child + Race + Age.of.father + Age.of.mother + \n    Education.of.father..years. + Education.of.mother..years. + \n    Total.Preg + BDead + Terms + Date.LBirth + Month.LBirth + \n    Year.LBirth + LOutcome + Weeks + Prenatal + Trimester.Prenatal + \n    Visits + Birth.weight.group + Marital + Birth.Attendant + \n    Numchild + Month.Term + Year.Term + Low.Birth + RaceMom + \n    RaceDad + Mother.Minority + Father.Minority + HispMom + HispDad + \n    AveCigs + Smoker + AveDrink + Wt.Gain\n\n\nStep:  AIC=49270.91\nBirth.Weight..g. ~ X + Institution.type + Plurality.of.birth + \n    Gender + Race.of.child + Race + Age.of.father + Age.of.mother + \n    Education.of.father..years. + Education.of.mother..years. + \n    Total.Preg + BDead + Terms + Date.LBirth + Month.LBirth + \n    Year.LBirth + LOutcome + Weeks + Prenatal + Trimester.Prenatal + \n    Visits + Birth.weight.group + Marital + Birth.Attendant + \n    Numchild + Month.Term + Year.Term + Low.Birth + RaceMom + \n    RaceDad + Father.Minority + HispMom + HispDad + AveCigs + \n    Smoker + AveDrink + Wt.Gain\n\n\nStep:  AIC=49270.91\nBirth.Weight..g. ~ X + Institution.type + Plurality.of.birth + \n    Gender + Race.of.child + Race + Age.of.father + Age.of.mother + \n    Education.of.father..years. + Education.of.mother..years. + \n    Total.Preg + BDead + Terms + Date.LBirth + Month.LBirth + \n    Year.LBirth + LOutcome + Weeks + Prenatal + Trimester.Prenatal + \n    Visits + Birth.weight.group + Marital + Birth.Attendant + \n    Numchild + Month.Term + Year.Term + Low.Birth + RaceDad + \n    Father.Minority + HispMom + HispDad + AveCigs + Smoker + \n    AveDrink + Wt.Gain\n\n\nStep:  AIC=49270.91\nBirth.Weight..g. ~ X + Institution.type + Plurality.of.birth + \n    Gender + Race.of.child + Race + Age.of.father + Age.of.mother + \n    Education.of.father..years. + Education.of.mother..years. + \n    Total.Preg + BDead + Terms + Date.LBirth + Month.LBirth + \n    Year.LBirth + LOutcome + Weeks + Prenatal + Trimester.Prenatal + \n    Visits + Birth.weight.group + Marital + Birth.Attendant + \n    Month.Term + Year.Term + Low.Birth + RaceDad + Father.Minority + \n    HispMom + HispDad + AveCigs + Smoker + AveDrink + Wt.Gain\n\n\nStep:  AIC=49270.91\nBirth.Weight..g. ~ X + Institution.type + Plurality.of.birth + \n    Gender + Race.of.child + Race + Age.of.father + Age.of.mother + \n    Education.of.father..years. + Education.of.mother..years. + \n    Total.Preg + BDead + Terms + Date.LBirth + Month.LBirth + \n    LOutcome + Weeks + Prenatal + Trimester.Prenatal + Visits + \n    Birth.weight.group + Marital + Birth.Attendant + Month.Term + \n    Year.Term + Low.Birth + RaceDad + Father.Minority + HispMom + \n    HispDad + AveCigs + Smoker + AveDrink + Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- HispDad                      6     71835  93525388 49263\n- HispMom                      6    144476  93598030 49267\n- Trimester.Prenatal           1        76  93453629 49269\n- Terms                        1       693  93454247 49269\n- Education.of.mother..years.  1       848  93454401 49269\n- Age.of.father                1      1077  93454630 49269\n- Total.Preg                   1      1900  93455453 49269\n- Father.Minority              1      2009  93455563 49269\n- Race.of.child                1      2041  93455595 49269\n- X                            1      2265  93455819 49269\n- AveDrink                     1      2749  93456302 49269\n- BDead                        1      2895  93456449 49269\n- Prenatal                     1      4918  93458471 49269\n- RaceDad                      1     10782  93464336 49269\n- AveCigs                      1     11274  93464828 49270\n- Institution.type             1     18088  93471642 49270\n- Birth.Attendant              1     22060  93475614 49270\n- Visits                       1     22290  93475844 49270\n- Education.of.father..years.  1     25134  93478688 49270\n- Marital                      1     26964  93480518 49270\n- Year.Term                    1     28251  93481804 49270\n- LOutcome                     1     30684  93484237 49271\n- Age.of.mother                1     33194  93486748 49271\n&lt;none&gt;                                      93453554 49271\n- Race                         2     98382  93551936 49272\n- Low.Birth                    1     64614  93518168 49272\n- Month.Term                   1     96920  93550473 49274\n- Month.LBirth                 1    102281  93555834 49274\n- Date.LBirth                  1    102384  93555937 49274\n- Gender                       1    113929  93567483 49275\n- Smoker                       1    121188  93574742 49275\n- Plurality.of.birth           1    243163  93696716 49282\n- Wt.Gain                      1    263341  93716895 49283\n- Weeks                        1   2744656  96198210 49414\n- Birth.weight.group           1 711671687 805125240 60037\n\nStep:  AIC=49262.75\nBirth.Weight..g. ~ X + Institution.type + Plurality.of.birth + \n    Gender + Race.of.child + Race + Age.of.father + Age.of.mother + \n    Education.of.father..years. + Education.of.mother..years. + \n    Total.Preg + BDead + Terms + Date.LBirth + Month.LBirth + \n    LOutcome + Weeks + Prenatal + Trimester.Prenatal + Visits + \n    Birth.weight.group + Marital + Birth.Attendant + Month.Term + \n    Year.Term + Low.Birth + RaceDad + Father.Minority + HispMom + \n    AveCigs + Smoker + AveDrink + Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- HispMom                      6    107874  93633263 49257\n- Trimester.Prenatal           1       357  93525746 49261\n- Terms                        1       854  93526242 49261\n- Age.of.father                1       999  93526387 49261\n- Education.of.mother..years.  1      1247  93526635 49261\n- Race.of.child                1      1395  93526783 49261\n- Total.Preg                   1      1853  93527242 49261\n- X                            1      2618  93528006 49261\n- AveDrink                     1      2794  93528183 49261\n- Father.Minority              1      3039  93528428 49261\n- BDead                        1      3063  93528451 49261\n- Prenatal                     1      3872  93529260 49261\n- AveCigs                      1     11261  93536649 49261\n- RaceDad                      1     12842  93538231 49261\n- Institution.type             1     17979  93543368 49262\n- Birth.Attendant              1     20942  93546330 49262\n- Education.of.father..years.  1     23580  93548968 49262\n- Visits                       1     24631  93550019 49262\n- Marital                      1     26407  93551795 49262\n- Year.Term                    1     28389  93553777 49262\n- LOutcome                     1     30194  93555582 49262\n- Age.of.mother                1     32947  93558335 49263\n&lt;none&gt;                                      93525388 49263\n- Low.Birth                    1     67073  93592461 49264\n- Race                         2    106534  93631923 49264\n- Month.Term                   1     94720  93620108 49266\n- Month.LBirth                 1    101556  93626944 49266\n- Date.LBirth                  1    101660  93627048 49266\n- Gender                       1    112824  93638213 49267\n- Smoker                       1    123060  93648449 49267\n- Plurality.of.birth           1    242055  93767444 49274\n- Wt.Gain                      1    263032  93788421 49275\n- Weeks                        1   2743738  96269127 49405\n- Birth.weight.group           1 712280260 805805649 60029\n\nStep:  AIC=49256.52\nBirth.Weight..g. ~ X + Institution.type + Plurality.of.birth + \n    Gender + Race.of.child + Race + Age.of.father + Age.of.mother + \n    Education.of.father..years. + Education.of.mother..years. + \n    Total.Preg + BDead + Terms + Date.LBirth + Month.LBirth + \n    LOutcome + Weeks + Prenatal + Trimester.Prenatal + Visits + \n    Birth.weight.group + Marital + Birth.Attendant + Month.Term + \n    Year.Term + Low.Birth + RaceDad + Father.Minority + AveCigs + \n    Smoker + AveDrink + Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- Trimester.Prenatal           1       239  93633502 49255\n- Age.of.father                1       507  93633770 49255\n- Race.of.child                1       780  93634043 49255\n- Terms                        1      1107  93634370 49255\n- Total.Preg                   1      1215  93634478 49255\n- Father.Minority              1      2019  93635282 49255\n- AveDrink                     1      2362  93635625 49255\n- X                            1      2413  93635676 49255\n- Education.of.mother..years.  1      3883  93637146 49255\n- BDead                        1      4292  93637555 49255\n- Prenatal                     1      5090  93638353 49255\n- AveCigs                      1     10646  93643909 49255\n- RaceDad                      1     12092  93645355 49255\n- Education.of.father..years.  1     15184  93648447 49255\n- Institution.type             1     18260  93651523 49255\n- Birth.Attendant              1     20945  93654208 49256\n- Visits                       1     23412  93656675 49256\n- Year.Term                    1     27779  93661042 49256\n- Marital                      1     27885  93661148 49256\n- LOutcome                     1     28892  93662155 49256\n- Age.of.mother                1     31504  93664767 49256\n&lt;none&gt;                                      93633263 49257\n- Low.Birth                    1     66920  93700183 49258\n- Race                         2    107086  93740349 49258\n- Month.Term                   1     97040  93730303 49260\n- Month.LBirth                 1    103555  93736818 49260\n- Date.LBirth                  1    103675  93736938 49260\n- Gender                       1    113196  93746459 49261\n- Smoker                       1    134589  93767852 49262\n- Plurality.of.birth           1    241539  93874801 49267\n- Wt.Gain                      1    256311  93889573 49268\n- Weeks                        1   2761996  96395259 49400\n- Birth.weight.group           1 712986585 806619847 60022\n\nStep:  AIC=49254.53\nBirth.Weight..g. ~ X + Institution.type + Plurality.of.birth + \n    Gender + Race.of.child + Race + Age.of.father + Age.of.mother + \n    Education.of.father..years. + Education.of.mother..years. + \n    Total.Preg + BDead + Terms + Date.LBirth + Month.LBirth + \n    LOutcome + Weeks + Prenatal + Visits + Birth.weight.group + \n    Marital + Birth.Attendant + Month.Term + Year.Term + Low.Birth + \n    RaceDad + Father.Minority + AveCigs + Smoker + AveDrink + \n    Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- Age.of.father                1       513  93634016 49253\n- Race.of.child                1       764  93634267 49253\n- Terms                        1      1109  93634612 49253\n- Total.Preg                   1      1223  93634725 49253\n- Father.Minority              1      2029  93635531 49253\n- AveDrink                     1      2362  93635864 49253\n- X                            1      2462  93635965 49253\n- Education.of.mother..years.  1      3885  93637387 49253\n- BDead                        1      4329  93637831 49253\n- AveCigs                      1     10662  93644164 49253\n- RaceDad                      1     12180  93645682 49253\n- Education.of.father..years.  1     15251  93648753 49253\n- Institution.type             1     18370  93651873 49254\n- Prenatal                     1     18577  93652080 49254\n- Birth.Attendant              1     20855  93654358 49254\n- Visits                       1     23244  93656747 49254\n- Marital                      1     27719  93661222 49254\n- Year.Term                    1     27836  93661338 49254\n- LOutcome                     1     28876  93662378 49254\n- Age.of.mother                1     31565  93665067 49254\n&lt;none&gt;                                      93633502 49255\n- Low.Birth                    1     66940  93700443 49256\n- Race                         2    107108  93740610 49256\n- Month.Term                   1     97040  93730542 49258\n- Month.LBirth                 1    103459  93736961 49258\n- Date.LBirth                  1    103580  93737083 49258\n- Gender                       1    113153  93746656 49259\n- Smoker                       1    134687  93768190 49260\n- Plurality.of.birth           1    241303  93874806 49265\n- Wt.Gain                      1    256181  93889684 49266\n- Weeks                        1   2761827  96395330 49398\n- Birth.weight.group           1 712988733 806622235 60020\n\nStep:  AIC=49252.56\nBirth.Weight..g. ~ X + Institution.type + Plurality.of.birth + \n    Gender + Race.of.child + Race + Age.of.mother + Education.of.father..years. + \n    Education.of.mother..years. + Total.Preg + BDead + Terms + \n    Date.LBirth + Month.LBirth + LOutcome + Weeks + Prenatal + \n    Visits + Birth.weight.group + Marital + Birth.Attendant + \n    Month.Term + Year.Term + Low.Birth + RaceDad + Father.Minority + \n    AveCigs + Smoker + AveDrink + Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- Race.of.child                1       754  93634769 49251\n- Terms                        1      1159  93635174 49251\n- Total.Preg                   1      1173  93635188 49251\n- Father.Minority              1      2026  93636042 49251\n- AveDrink                     1      2421  93636437 49251\n- X                            1      2430  93636446 49251\n- Education.of.mother..years.  1      3775  93637791 49251\n- BDead                        1      4322  93638337 49251\n- AveCigs                      1     10623  93644639 49251\n- RaceDad                      1     12248  93646264 49251\n- Education.of.father..years.  1     14978  93648994 49251\n- Institution.type             1     18394  93652409 49252\n- Prenatal                     1     18660  93652676 49252\n- Birth.Attendant              1     21165  93655181 49252\n- Visits                       1     23241  93657257 49252\n- Marital                      1     27655  93661670 49252\n- Year.Term                    1     28006  93662022 49252\n- LOutcome                     1     28838  93662854 49252\n&lt;none&gt;                                      93634016 49253\n- Age.of.mother                1     46405  93680421 49253\n- Low.Birth                    1     66823  93700839 49254\n- Race                         2    107060  93741076 49254\n- Month.Term                   1     97175  93731191 49256\n- Month.LBirth                 1    103335  93737351 49256\n- Date.LBirth                  1    103456  93737472 49256\n- Gender                       1    113311  93747327 49257\n- Smoker                       1    134933  93768949 49258\n- Plurality.of.birth           1    241597  93875612 49263\n- Wt.Gain                      1    256611  93890627 49264\n- Weeks                        1   2761734  96395750 49396\n- Birth.weight.group           1 713139858 806773873 60019\n\nStep:  AIC=49250.6\nBirth.Weight..g. ~ X + Institution.type + Plurality.of.birth + \n    Gender + Race + Age.of.mother + Education.of.father..years. + \n    Education.of.mother..years. + Total.Preg + BDead + Terms + \n    Date.LBirth + Month.LBirth + LOutcome + Weeks + Prenatal + \n    Visits + Birth.weight.group + Marital + Birth.Attendant + \n    Month.Term + Year.Term + Low.Birth + RaceDad + Father.Minority + \n    AveCigs + Smoker + AveDrink + Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- Terms                        1      1141  93635911 49249\n- Total.Preg                   1      1185  93635954 49249\n- X                            1      2384  93637153 49249\n- AveDrink                     1      2420  93637190 49249\n- Father.Minority              1      3169  93637938 49249\n- Education.of.mother..years.  1      3700  93638469 49249\n- BDead                        1      4481  93639250 49249\n- AveCigs                      1     10647  93645416 49249\n- Education.of.father..years.  1     14753  93649522 49249\n- Institution.type             1     18346  93653116 49250\n- Prenatal                     1     18699  93653468 49250\n- Birth.Attendant              1     21198  93655968 49250\n- RaceDad                      1     23135  93657905 49250\n- Visits                       1     23323  93658093 49250\n- Marital                      1     27652  93662421 49250\n- Year.Term                    1     28259  93663029 49250\n- LOutcome                     1     28881  93663650 49250\n&lt;none&gt;                                      93634769 49251\n- Age.of.mother                1     46296  93681066 49251\n- Low.Birth                    1     66328  93701097 49252\n- Race                         2    122698  93757467 49253\n- Month.Term                   1     97566  93732336 49254\n- Month.LBirth                 1    103465  93738235 49254\n- Date.LBirth                  1    103586  93738355 49254\n- Gender                       1    113302  93748071 49255\n- Smoker                       1    134829  93769599 49256\n- Plurality.of.birth           1    241733  93876502 49261\n- Wt.Gain                      1    256559  93891328 49262\n- Weeks                        1   2768546  96403315 49394\n- Birth.weight.group           1 713358214 806992983 60018\n\nStep:  AIC=49248.66\nBirth.Weight..g. ~ X + Institution.type + Plurality.of.birth + \n    Gender + Race + Age.of.mother + Education.of.father..years. + \n    Education.of.mother..years. + Total.Preg + BDead + Date.LBirth + \n    Month.LBirth + LOutcome + Weeks + Prenatal + Visits + Birth.weight.group + \n    Marital + Birth.Attendant + Month.Term + Year.Term + Low.Birth + \n    RaceDad + Father.Minority + AveCigs + Smoker + AveDrink + \n    Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- X                            1      2408  93638319 49247\n- AveDrink                     1      2470  93638381 49247\n- Father.Minority              1      3208  93639119 49247\n- Education.of.mother..years.  1      3274  93639184 49247\n- BDead                        1      3941  93639851 49247\n- Total.Preg                   1      5199  93641109 49247\n- AveCigs                      1     10766  93646677 49247\n- Education.of.father..years.  1     14738  93650648 49247\n- Institution.type             1     18066  93653977 49248\n- Prenatal                     1     18476  93654386 49248\n- Birth.Attendant              1     20955  93656865 49248\n- RaceDad                      1     23440  93659351 49248\n- Visits                       1     23938  93659849 49248\n- Marital                      1     27473  93663383 49248\n- LOutcome                     1     29336  93665247 49248\n- Year.Term                    1     29376  93665287 49248\n&lt;none&gt;                                      93635911 49249\n- Age.of.mother                1     45226  93681137 49249\n- Low.Birth                    1     66214  93702124 49250\n- Race                         2    123410  93759320 49251\n- Month.Term                   1     97407  93733318 49252\n- Month.LBirth                 1    102669  93738580 49252\n- Date.LBirth                  1    102801  93738711 49252\n- Gender                       1    114014  93749925 49253\n- Smoker                       1    134755  93770666 49254\n- Plurality.of.birth           1    243339  93879250 49260\n- Wt.Gain                      1    257362  93893272 49260\n- Weeks                        1   2768511  96404421 49392\n- Birth.weight.group           1 713660859 807296769 60018\n\nStep:  AIC=49246.79\nBirth.Weight..g. ~ Institution.type + Plurality.of.birth + Gender + \n    Race + Age.of.mother + Education.of.father..years. + Education.of.mother..years. + \n    Total.Preg + BDead + Date.LBirth + Month.LBirth + LOutcome + \n    Weeks + Prenatal + Visits + Birth.weight.group + Marital + \n    Birth.Attendant + Month.Term + Year.Term + Low.Birth + RaceDad + \n    Father.Minority + AveCigs + Smoker + AveDrink + Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- AveDrink                     1      2494  93640813 49245\n- Education.of.mother..years.  1      3181  93641500 49245\n- Father.Minority              1      3202  93641521 49245\n- BDead                        1      3966  93642285 49245\n- Total.Preg                   1      5201  93643520 49245\n- AveCigs                      1     10837  93649156 49245\n- Education.of.father..years.  1     14522  93652841 49246\n- Institution.type             1     18113  93656432 49246\n- Prenatal                     1     18736  93657055 49246\n- Birth.Attendant              1     21002  93659321 49246\n- RaceDad                      1     23407  93661726 49246\n- Visits                       1     23909  93662228 49246\n- Marital                      1     27497  93665816 49246\n- LOutcome                     1     29322  93667641 49246\n- Year.Term                    1     29655  93667974 49246\n&lt;none&gt;                                      93638319 49247\n- Age.of.mother                1     45317  93683636 49247\n- Low.Birth                    1     66105  93704424 49248\n- Race                         2    123002  93761320 49249\n- Month.Term                   1     97830  93736148 49250\n- Month.LBirth                 1    102519  93740838 49250\n- Date.LBirth                  1    102653  93740972 49250\n- Gender                       1    113413  93751732 49251\n- Smoker                       1    134650  93772969 49252\n- Plurality.of.birth           1    242577  93880895 49258\n- Wt.Gain                      1    256808  93895126 49258\n- Weeks                        1   2768310  96406628 49390\n- Birth.weight.group           1 713723815 807362134 60016\n\nStep:  AIC=49244.92\nBirth.Weight..g. ~ Institution.type + Plurality.of.birth + Gender + \n    Race + Age.of.mother + Education.of.father..years. + Education.of.mother..years. + \n    Total.Preg + BDead + Date.LBirth + Month.LBirth + LOutcome + \n    Weeks + Prenatal + Visits + Birth.weight.group + Marital + \n    Birth.Attendant + Month.Term + Year.Term + Low.Birth + RaceDad + \n    Father.Minority + AveCigs + Smoker + Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- Father.Minority              1      3149  93643962 49243\n- Education.of.mother..years.  1      3319  93644132 49243\n- BDead                        1      3934  93644747 49243\n- Total.Preg                   1      5173  93645986 49243\n- AveCigs                      1     10858  93651671 49243\n- Education.of.father..years.  1     14688  93655501 49244\n- Institution.type             1     18115  93658928 49244\n- Prenatal                     1     18958  93659771 49244\n- Birth.Attendant              1     20943  93661756 49244\n- RaceDad                      1     23340  93664153 49244\n- Visits                       1     24346  93665159 49244\n- Marital                      1     27361  93668174 49244\n- Year.Term                    1     29368  93670181 49244\n- LOutcome                     1     29501  93670314 49244\n&lt;none&gt;                                      93640813 49245\n- Age.of.mother                1     45252  93686065 49245\n- Low.Birth                    1     66106  93706919 49246\n- Race                         2    122619  93763432 49247\n- Month.Term                   1     97738  93738551 49248\n- Month.LBirth                 1    102696  93743509 49248\n- Date.LBirth                  1    102835  93743648 49248\n- Gender                       1    113266  93754078 49249\n- Smoker                       1    133702  93774515 49250\n- Plurality.of.birth           1    242795  93883608 49256\n- Wt.Gain                      1    256775  93897588 49257\n- Weeks                        1   2767525  96408338 49389\n- Birth.weight.group           1 713814015 807454828 60015\n\nStep:  AIC=49243.09\nBirth.Weight..g. ~ Institution.type + Plurality.of.birth + Gender + \n    Race + Age.of.mother + Education.of.father..years. + Education.of.mother..years. + \n    Total.Preg + BDead + Date.LBirth + Month.LBirth + LOutcome + \n    Weeks + Prenatal + Visits + Birth.weight.group + Marital + \n    Birth.Attendant + Month.Term + Year.Term + Low.Birth + RaceDad + \n    AveCigs + Smoker + Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- Education.of.mother..years.  1      3130  93647092 49241\n- BDead                        1      3856  93647818 49241\n- Total.Preg                   1      5409  93649371 49241\n- AveCigs                      1     11353  93655315 49242\n- Education.of.father..years.  1     14720  93658683 49242\n- Institution.type             1     18049  93662012 49242\n- Prenatal                     1     18581  93662543 49242\n- Birth.Attendant              1     21268  93665230 49242\n- RaceDad                      1     22026  93665989 49242\n- Visits                       1     24329  93668291 49242\n- Marital                      1     25265  93669228 49242\n- LOutcome                     1     28944  93672907 49243\n- Year.Term                    1     29239  93673202 49243\n&lt;none&gt;                                      93643962 49243\n- Age.of.mother                1     43892  93687855 49243\n- Low.Birth                    1     65804  93709766 49245\n- Month.Term                   1     97887  93741849 49246\n- Month.LBirth                 1    101921  93745884 49247\n- Date.LBirth                  1    102058  93746020 49247\n- Gender                       1    111930  93755892 49247\n- Smoker                       1    134639  93778602 49248\n- Plurality.of.birth           1    242504  93886467 49254\n- Race                         2    290670  93934632 49255\n- Wt.Gain                      1    256914  93900877 49255\n- Weeks                        1   2764662  96408625 49387\n- Birth.weight.group           1 714503432 808147394 60017\n\nStep:  AIC=49241.25\nBirth.Weight..g. ~ Institution.type + Plurality.of.birth + Gender + \n    Race + Age.of.mother + Education.of.father..years. + Total.Preg + \n    BDead + Date.LBirth + Month.LBirth + LOutcome + Weeks + Prenatal + \n    Visits + Birth.weight.group + Marital + Birth.Attendant + \n    Month.Term + Year.Term + Low.Birth + RaceDad + AveCigs + \n    Smoker + Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- BDead                        1      3854  93650946 49239\n- Total.Preg                   1      7060  93654153 49240\n- AveCigs                      1     11437  93658529 49240\n- Education.of.father..years.  1     12356  93659448 49240\n- Institution.type             1     18216  93665308 49240\n- Prenatal                     1     19603  93666695 49240\n- Birth.Attendant              1     21098  93668190 49240\n- RaceDad                      1     21936  93669028 49240\n- Marital                      1     23457  93670549 49241\n- Visits                       1     23771  93670863 49241\n- LOutcome                     1     28338  93675430 49241\n- Year.Term                    1     30658  93677750 49241\n&lt;none&gt;                                      93647092 49241\n- Age.of.mother                1     40911  93688003 49241\n- Low.Birth                    1     65382  93712475 49243\n- Month.Term                   1     97763  93744855 49244\n- Month.LBirth                 1    101808  93748900 49245\n- Date.LBirth                  1    101937  93749029 49245\n- Gender                       1    111657  93758749 49245\n- Smoker                       1    134087  93781179 49246\n- Plurality.of.birth           1    244812  93891905 49252\n- Wt.Gain                      1    254790  93901883 49253\n- Race                         2    296705  93943797 49253\n- Weeks                        1   2768356  96415448 49385\n- Birth.weight.group           1 714655103 808302195 60016\n\nStep:  AIC=49239.46\nBirth.Weight..g. ~ Institution.type + Plurality.of.birth + Gender + \n    Race + Age.of.mother + Education.of.father..years. + Total.Preg + \n    Date.LBirth + Month.LBirth + LOutcome + Weeks + Prenatal + \n    Visits + Birth.weight.group + Marital + Birth.Attendant + \n    Month.Term + Year.Term + Low.Birth + RaceDad + AveCigs + \n    Smoker + Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- Total.Preg                   1      9201  93660148 49238\n- AveCigs                      1     11185  93662132 49238\n- Education.of.father..years.  1     12354  93663300 49238\n- Institution.type             1     18272  93669218 49238\n- Prenatal                     1     19331  93670277 49238\n- Birth.Attendant              1     20884  93671830 49239\n- RaceDad                      1     22677  93673623 49239\n- Marital                      1     23297  93674243 49239\n- Visits                       1     24011  93674958 49239\n- LOutcome                     1     28125  93679071 49239\n- Year.Term                    1     32928  93683874 49239\n&lt;none&gt;                                      93650946 49239\n- Age.of.mother                1     40063  93691009 49240\n- Low.Birth                    1     65898  93716844 49241\n- Month.Term                   1     99340  93750286 49243\n- Month.LBirth                 1    101027  93751973 49243\n- Date.LBirth                  1    101153  93752099 49243\n- Gender                       1    111914  93762860 49243\n- Smoker                       1    133844  93784790 49245\n- Plurality.of.birth           1    246645  93897591 49251\n- Wt.Gain                      1    253520  93904466 49251\n- Race                         2    296261  93947207 49251\n- Weeks                        1   2766851  96417797 49383\n- Birth.weight.group           1 715517563 809168509 60020\n\nStep:  AIC=49237.95\nBirth.Weight..g. ~ Institution.type + Plurality.of.birth + Gender + \n    Race + Age.of.mother + Education.of.father..years. + Date.LBirth + \n    Month.LBirth + LOutcome + Weeks + Prenatal + Visits + Birth.weight.group + \n    Marital + Birth.Attendant + Month.Term + Year.Term + Low.Birth + \n    RaceDad + AveCigs + Smoker + Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- Education.of.father..years.  1      9841  93669988 49236\n- AveCigs                      1     11173  93671320 49237\n- Institution.type             1     17956  93678103 49237\n- Prenatal                     1     20926  93681073 49237\n- Birth.Attendant              1     21827  93681974 49237\n- RaceDad                      1     22253  93682401 49237\n- Marital                      1     22932  93683080 49237\n- Visits                       1     23363  93683511 49237\n- Year.Term                    1     24274  93684421 49237\n- LOutcome                     1     30218  93690366 49238\n&lt;none&gt;                                      93660148 49238\n- Age.of.mother                1     52197  93712345 49239\n- Low.Birth                    1     65278  93725425 49239\n- Month.Term                   1     98352  93758500 49241\n- Gender                       1    110357  93770505 49242\n- Smoker                       1    130899  93791046 49243\n- Month.LBirth                 1    131742  93791889 49243\n- Date.LBirth                  1    132164  93792312 49243\n- Plurality.of.birth           1    243342  93903489 49249\n- Race                         2    289461  93949609 49249\n- Wt.Gain                      1    252100  93912248 49249\n- Weeks                        1   2761147  96421294 49381\n- Birth.weight.group           1 716394675 810054822 60023\n\nStep:  AIC=49236.48\nBirth.Weight..g. ~ Institution.type + Plurality.of.birth + Gender + \n    Race + Age.of.mother + Date.LBirth + Month.LBirth + LOutcome + \n    Weeks + Prenatal + Visits + Birth.weight.group + Marital + \n    Birth.Attendant + Month.Term + Year.Term + Low.Birth + RaceDad + \n    AveCigs + Smoker + Wt.Gain\n\n                     Df Sum of Sq       RSS   AIC\n- AveCigs             1     10876  93680865 49235\n- Prenatal            1     16490  93686479 49235\n- Institution.type    1     16988  93686976 49235\n- RaceDad             1     19967  93689956 49236\n- Birth.Attendant     1     22401  93692390 49236\n- Year.Term           1     24424  93694413 49236\n- Visits              1     25198  93695186 49236\n- LOutcome            1     31040  93701028 49236\n- Marital             1     32542  93702530 49236\n&lt;none&gt;                             93669988 49236\n- Low.Birth           1     64569  93734558 49238\n- Age.of.mother       1     69733  93739721 49238\n- Month.Term          1     99348  93769337 49240\n- Gender              1    111043  93781032 49240\n- Month.LBirth        1    128894  93798882 49241\n- Date.LBirth         1    129305  93799293 49241\n- Smoker              1    130464  93800453 49241\n- Plurality.of.birth  1    240900  93910889 49247\n- Race                2    282031  93952019 49248\n- Wt.Gain             1    261667  93931655 49248\n- Weeks               1   2759646  96429635 49380\n- Birth.weight.group  1 716728836 810398824 60023\n\nStep:  AIC=49235.06\nBirth.Weight..g. ~ Institution.type + Plurality.of.birth + Gender + \n    Race + Age.of.mother + Date.LBirth + Month.LBirth + LOutcome + \n    Weeks + Prenatal + Visits + Birth.weight.group + Marital + \n    Birth.Attendant + Month.Term + Year.Term + Low.Birth + RaceDad + \n    Smoker + Wt.Gain\n\n                     Df Sum of Sq       RSS   AIC\n- Institution.type    1     16937  93697802 49234\n- Prenatal            1     17921  93698786 49234\n- RaceDad             1     20332  93701196 49234\n- Birth.Attendant     1     20966  93701831 49234\n- Year.Term           1     24484  93705348 49234\n- Visits              1     25261  93706126 49234\n- LOutcome            1     30859  93711724 49235\n- Marital             1     34003  93714867 49235\n&lt;none&gt;                             93680865 49235\n- Low.Birth           1     64523  93745387 49236\n- Age.of.mother       1     71193  93752058 49237\n- Month.Term          1     98790  93779655 49238\n- Gender              1    111363  93792227 49239\n- Month.LBirth        1    130126  93810991 49240\n- Date.LBirth         1    130521  93811386 49240\n- Plurality.of.birth  1    241872  93922737 49246\n- Smoker              1    242983  93923848 49246\n- Race                2    287000  93967865 49246\n- Wt.Gain             1    261574  93942439 49247\n- Weeks               1   2759522  96440387 49378\n- Birth.weight.group  1 717126874 810807739 60024\n\nStep:  AIC=49233.96\nBirth.Weight..g. ~ Plurality.of.birth + Gender + Race + Age.of.mother + \n    Date.LBirth + Month.LBirth + LOutcome + Weeks + Prenatal + \n    Visits + Birth.weight.group + Marital + Birth.Attendant + \n    Month.Term + Year.Term + Low.Birth + RaceDad + Smoker + Wt.Gain\n\n                     Df Sum of Sq       RSS   AIC\n- Prenatal            1     16659  93714460 49233\n- Birth.Attendant     1     17184  93714986 49233\n- RaceDad             1     20667  93718468 49233\n- Year.Term           1     24802  93722603 49233\n- Visits              1     24949  93722751 49233\n- LOutcome            1     31275  93729077 49234\n- Marital             1     34093  93731894 49234\n&lt;none&gt;                             93697802 49234\n- Low.Birth           1     64855  93762657 49235\n- Age.of.mother       1     69059  93766861 49236\n- Month.Term          1     99803  93797605 49237\n- Gender              1    111532  93809334 49238\n- Month.LBirth        1    130014  93827816 49239\n- Date.LBirth         1    130433  93828235 49239\n- Smoker              1    241271  93939073 49245\n- Plurality.of.birth  1    241620  93939422 49245\n- Race                2    285977  93983779 49245\n- Wt.Gain             1    259327  93957128 49246\n- Weeks               1   2758699  96456501 49377\n- Birth.weight.group  1 717140364 810838166 60022\n\nStep:  AIC=49232.85\nBirth.Weight..g. ~ Plurality.of.birth + Gender + Race + Age.of.mother + \n    Date.LBirth + Month.LBirth + LOutcome + Weeks + Visits + \n    Birth.weight.group + Marital + Birth.Attendant + Month.Term + \n    Year.Term + Low.Birth + RaceDad + Smoker + Wt.Gain\n\n                     Df Sum of Sq       RSS   AIC\n- Visits              1     12771  93727231 49232\n- Birth.Attendant     1     17766  93732226 49232\n- RaceDad             1     20119  93734579 49232\n- Year.Term           1     23837  93738297 49232\n- Marital             1     28607  93743068 49232\n- LOutcome            1     31764  93746224 49233\n&lt;none&gt;                             93714460 49233\n- Age.of.mother       1     64513  93778973 49234\n- Low.Birth           1     65014  93779475 49234\n- Month.Term          1     98329  93812789 49236\n- Gender              1    111020  93825480 49237\n- Month.LBirth        1    132699  93847159 49238\n- Date.LBirth         1    133168  93847628 49238\n- Plurality.of.birth  1    236391  93950851 49243\n- Smoker              1    237139  93951599 49243\n- Race                2    283283  93997743 49244\n- Wt.Gain             1    253698  93968159 49244\n- Weeks               1   2815836  96530296 49379\n- Birth.weight.group  1 717312360 811026821 60021\n\nStep:  AIC=49231.53\nBirth.Weight..g. ~ Plurality.of.birth + Gender + Race + Age.of.mother + \n    Date.LBirth + Month.LBirth + LOutcome + Weeks + Birth.weight.group + \n    Marital + Birth.Attendant + Month.Term + Year.Term + Low.Birth + \n    RaceDad + Smoker + Wt.Gain\n\n                     Df Sum of Sq       RSS   AIC\n- Birth.Attendant     1     16817  93744048 49230\n- RaceDad             1     19646  93746877 49231\n- Year.Term           1     22864  93750096 49231\n- LOutcome            1     32561  93759793 49231\n- Marital             1     33397  93760628 49231\n&lt;none&gt;                             93727231 49232\n- Low.Birth           1     65904  93793135 49233\n- Age.of.mother       1     70089  93797320 49233\n- Month.Term          1     99064  93826295 49235\n- Gender              1    109353  93836585 49235\n- Month.LBirth        1    130476  93857707 49236\n- Date.LBirth         1    130942  93858173 49237\n- Plurality.of.birth  1    225729  93952961 49242\n- Smoker              1    236939  93964170 49242\n- Race                2    277059  94004290 49242\n- Wt.Gain             1    261273  93988504 49243\n- Weeks               1   2852807  96580039 49379\n- Birth.weight.group  1 720155397 813882628 60037\n\nStep:  AIC=49230.43\nBirth.Weight..g. ~ Plurality.of.birth + Gender + Race + Age.of.mother + \n    Date.LBirth + Month.LBirth + LOutcome + Weeks + Birth.weight.group + \n    Marital + Month.Term + Year.Term + Low.Birth + RaceDad + \n    Smoker + Wt.Gain\n\n                     Df Sum of Sq       RSS   AIC\n- RaceDad             1     18974  93763023 49229\n- Year.Term           1     22853  93766902 49230\n- LOutcome            1     32265  93776313 49230\n- Marital             1     35297  93779346 49230\n&lt;none&gt;                             93744048 49230\n- Age.of.mother       1     66244  93810293 49232\n- Low.Birth           1     66786  93810834 49232\n- Month.Term          1     98058  93842106 49234\n- Gender              1    108369  93852417 49234\n- Month.LBirth        1    132256  93876304 49235\n- Date.LBirth         1    132707  93876755 49236\n- Plurality.of.birth  1    229890  93973938 49241\n- Smoker              1    235464  93979513 49241\n- Race                2    280307  94024355 49241\n- Wt.Gain             1    261945  94005993 49242\n- Weeks               1   2856162  96600210 49378\n- Birth.weight.group  1 720222651 813966699 60035\n\nStep:  AIC=49229.44\nBirth.Weight..g. ~ Plurality.of.birth + Gender + Race + Age.of.mother + \n    Date.LBirth + Month.LBirth + LOutcome + Weeks + Birth.weight.group + \n    Marital + Month.Term + Year.Term + Low.Birth + Smoker + Wt.Gain\n\n                     Df Sum of Sq       RSS   AIC\n- Year.Term           1     22239  93785262 49229\n- LOutcome            1     32342  93795365 49229\n- Marital             1     35310  93798333 49229\n&lt;none&gt;                             93763023 49229\n- Age.of.mother       1     64623  93827646 49231\n- Low.Birth           1     64672  93827695 49231\n- Month.Term          1     98066  93861089 49233\n- Gender              1    107746  93870769 49233\n- Month.LBirth        1    132797  93895820 49235\n- Date.LBirth         1    133254  93896277 49235\n- Plurality.of.birth  1    228469  93991492 49240\n- Smoker              1    234739  93997761 49240\n- Wt.Gain             1    260187  94023210 49241\n- Race                2    411765  94174787 49247\n- Weeks               1   2850830  96613852 49377\n- Birth.weight.group  1 721715962 815478985 60042\n\nStep:  AIC=49228.63\nBirth.Weight..g. ~ Plurality.of.birth + Gender + Race + Age.of.mother + \n    Date.LBirth + Month.LBirth + LOutcome + Weeks + Birth.weight.group + \n    Marital + Month.Term + Low.Birth + Smoker + Wt.Gain\n\n                     Df Sum of Sq       RSS   AIC\n&lt;none&gt;                             93785262 49229\n- Marital             1     38287  93823550 49229\n- Age.of.mother       1     57325  93842587 49230\n- LOutcome            1     59406  93844668 49230\n- Low.Birth           1     64835  93850097 49230\n- Month.Term          1     77781  93863043 49231\n- Gender              1    107034  93892296 49232\n- Month.LBirth        1    168630  93953893 49236\n- Date.LBirth         1    169519  93954781 49236\n- Plurality.of.birth  1    227383  94012645 49239\n- Smoker              1    244280  94029542 49240\n- Wt.Gain             1    259786  94045048 49240\n- Race                2    423687  94208949 49247\n- Weeks               1   2844759  96630021 49376\n- Birth.weight.group  1 721813693 815598955 60041\n\nsummary_step &lt;- summary(stepwise)\n\n# From the summary of the stepwise model, Plurality.of.birth, Gender, Race, Weeks, Birth.weight.group, Father.Minority, Smoker, and Wt.Gain are the top significant predictors.\n\n# Create a refined step model using the top 8 most significant predictors. \nstep_model &lt;- lm(Birth.Weight..g. ~ Plurality.of.birth + Gender + Race + Weeks + Birth.weight.group + Father.Minority + Smoker + Wt.Gain , data = B.train)\n\n# Predict birth weight using the step model and the training data\nstep_train_pred &lt;- predict(step_model, B.train)\nstep_train_mse &lt;- mean((births$Birth.Weight..g. - step_train_pred)^2)\n\nWarning in births$Birth.Weight..g. - step_train_pred: longer object length is\nnot a multiple of shorter object length\n\n# Do the same but with the testing data\nstep_test_pred &lt;- predict(step_model, B.test)\nstep_test_mse &lt;- mean((births$Birth.Weight..g. - step_test_pred)^2)\n\nWarning in births$Birth.Weight..g. - step_test_pred: longer object length is\nnot a multiple of shorter object length\n\ncat(\"Training MSE:\", step_train_mse, \"\\n\")\n\nTraining MSE: 721443.2 \n\ncat(\"Testing MSE:\", step_test_mse)\n\nTesting MSE: 709755.3\n\n\nAgain the training MSE is higher than the testing MSE, which is unusual."
  },
  {
    "objectID": "projects/2-project.html#try-out-ridge-regression-with-the-complete-data-births",
    "href": "projects/2-project.html#try-out-ridge-regression-with-the-complete-data-births",
    "title": "Birth Weight Predictions (Coding Process Explained)",
    "section": "Try out ridge regression with the complete data (births)",
    "text": "Try out ridge regression with the complete data (births)\n\n# Prepare the data\nbirthsLog &lt;- transform(births, lWeight = log(as.numeric(births$Birth.Weight..g.)))\nbirthsLog &lt;- subset(birthsLog, select = -c(Birth.Weight..g., X))\nB.testLog &lt;- transform(B.test, lWeight = log(as.numeric(B.test$Birth.Weight..g.)))\nB.testLog &lt;- subset(B.testLog, select = -c(Birth.Weight..g., X))\n\nbirths2 &lt;- na.omit(birthsLog)\nB.test2 &lt;- na.omit(B.testLog)\n\nx_full &lt;- model.matrix(lWeight ~ ., data = births2)\ny_full &lt;- births2$lWeight\n\nx_test &lt;- model.matrix(lWeight ~ ., data = B.test2)\ny_test &lt;- B.test2$lWeight\n\n# Fit Ridge Regression\nset.seed(705780612)\nlambda.v &lt;- 10^seq(10, -2, length = 100)\nridge_model &lt;- glmnet(x_full, y_full, alpha = 0, lambda = lambda.v)\n\n# Cross-validation to find best lambda\nset.seed(12)\ncv.output &lt;- cv.glmnet(x_full, y_full, alpha = 0)\nqplot &lt;- qplot(log(cv.output$lambda),cv.output$cvsd)\n\nWarning: `qplot()` was deprecated in ggplot2 3.4.0.\n\nbestlamb.cv &lt;- cv.output$lambda.min\n\n# Fit the model with the best lambda\nbest_ridge &lt;- glmnet(x_full, y_full, alpha = 0, lambda = bestlamb.cv)\n\n# Predictions\npred.births2 &lt;- predict(best_ridge, newx = x_full, s = bestlamb.cv, type = \"response\")\npred.Btest2 &lt;- predict(best_ridge, newx = x_test, s = bestlamb.cv, type = \"response\")\n\n# Calculate MSE\nMSE.births2 &lt;- mean((y_full - pred.births2)^2) # Training MSE\nMSE.Btest2 &lt;- mean((y_test - pred.Btest2)^2)  # Testing MSE\n\n\ncat(\"Best lambda: \", bestlamb.cv, \"\\n\")\n\nBest lambda:  0.0224084 \n\nprint(coef(best_ridge))\n\n50 x 1 sparse Matrix of class \"dgCMatrix\"\n                                       s0\n(Intercept)                  6.478370e+00\n(Intercept)                  .           \nInstitution.type            -3.084747e-03\nPlurality.of.birth          -3.429659e-02\nGender                      -4.804617e-03\nRace.of.child                3.808047e-04\nRaceOther                    7.947638e-03\nRaceWhite                    6.455639e-03\nAge.of.father               -7.679371e-05\nAge.of.mother                1.002633e-04\nEducation.of.father..years.  3.808010e-04\nEducation.of.mother..years.  4.342688e-04\nTotal.Preg                   9.235997e-04\nBDead                       -2.406430e-02\nTerms                       -1.366699e-03\nDate.LBirth                 -4.986784e-10\nMonth.LBirth                -2.328507e-05\nYear.LBirth                  3.108965e-06\nLOutcome                    -1.891907e-04\nWeeks                        1.828815e-02\nPrenatal                     3.456070e-03\nTrimester.Prenatal          -1.601978e-03\nVisits                       1.621431e-03\nBirth.weight.group           1.238124e-01\nMarital                     -2.870645e-03\nBirth.Attendant              5.054304e-04\nNumchild                     2.665622e-03\nMonth.Term                  -7.218584e-04\nYear.Term                    8.215467e-07\nLow.BirthNorm                1.317013e-01\nRaceMom                     -6.849657e-05\nRaceDad                     -1.444243e-03\nMother.MinorityWhite         7.984752e-03\nFather.MinorityWhite        -4.427625e-03\nHispMomM                     1.217261e-03\nHispMomN                    -1.696298e-03\nHispMomO                    -1.099847e-02\nHispMomP                    -1.272498e-03\nHispMomS                     9.112568e-05\nHispMomU                     2.279497e-02\nHispDadM                    -1.532665e-03\nHispDadN                    -3.089432e-04\nHispDadO                     8.649688e-03\nHispDadP                     1.692276e-03\nHispDadS                     7.593321e-03\nHispDadU                    -1.408813e-02\nAveCigs                     -4.029724e-04\nSmokerNo                     4.647282e-03\nAveDrink                     2.408536e-04\nWt.Gain                      4.650144e-04\n\ncat(\"Training MSE: \", MSE.births2, \"\\n\")\n\nTraining MSE:  0.006721434 \n\ncat(\"Testing MSE: \", MSE.Btest2, \"\\n\")\n\nTesting MSE:  0.006942309 \n\n\nThe significant predictors are variables like Low.BirthNorm, Birth.weight.group, and Weeks, as they have large coefficients and strong associations to the response. For example, the Weeks coefficient is large (1.828815e-02) compared to others, indicating a strong effect on the response variable. An interesting observation is that AveCigs shows a negative relationship with the response, and SmokerNo has a positive association. The training MSE is 0.0067214 and the testing MSE is 0.0069423, which indicates good model performance and overfitting because the testing MSE is very close to the training MSE."
  },
  {
    "objectID": "projects/2-project.html#use-lasso-regression-with-the-complete-data",
    "href": "projects/2-project.html#use-lasso-regression-with-the-complete-data",
    "title": "Birth Weight Predictions (Coding Process Explained)",
    "section": "Use Lasso Regression with the complete data",
    "text": "Use Lasso Regression with the complete data\n\n# Prepare the data\nbirthsLog &lt;- transform(births, lWeight = log(as.numeric(births$Birth.Weight..g.)))\nbirthsLog &lt;- subset(birthsLog, select = -c(Birth.Weight..g., X))  \nbirths2 &lt;- na.omit(birthsLog)  \n\nx_full &lt;- model.matrix(lWeight ~ ., data = births2) \ny_full &lt;- births2$lWeight\n\nx_test &lt;- model.matrix(lWeight ~ ., data = B.test2)\ny_test &lt;- B.test2$lWeight\n\nlambda.v &lt;- 10^seq(10, -2, length = 100)\n\nset.seed(123)\nmodel.lasso &lt;- glmnet(x_full, y_full, alpha = 1, lambda = lambda.v)\n\ncoeffsL &lt;- coef(model.lasso)\n\nset.seed(12)\ncv.outputL &lt;- cv.glmnet(x_full, y_full, alpha = 1)\nbestlamb.cvL &lt;- cv.outputL$lambda.min\ncat(\"Best Lambda (Lasso):\", bestlamb.cvL, \"\\n\")\n\nBest Lambda (Lasso): 0.0006381994 \n\nbest_lasso &lt;- glmnet(x_full, y_full, alpha = 1, lambda = bestlamb.cvL)\n\n# Calculate Training MSE\npred.lasso.train &lt;- predict(best_lasso, newx = x_full, s = bestlamb.cvL, type = \"response\")\npred.lasso.test &lt;- predict(best_lasso, newx = x_test, s = bestlamb.cvL, type = \"response\")\ntrain_mse_lasso &lt;- mean((y_full - pred.lasso.train)^2)\ntest_mse_lasso &lt;- mean((y_test - pred.lasso.test)^2)\n\ncat(\"Training MSE (Lasso):\", train_mse_lasso, \"\\n\")\n\nTraining MSE (Lasso): 0.00642802 \n\ncat(\"Testing MSE (Lasso):\", test_mse_lasso, \"\\n\")\n\nTesting MSE (Lasso): 0.006628631 \n\n# Plot cross-validation results\nqplot(log(cv.outputL$lambda), cv.outputL$cvm) +\n  geom_errorbar(aes(ymin = cv.outputL$cvm - cv.outputL$cvsd, \n                    ymax = cv.outputL$cvm + cv.outputL$cvsd)) +\n  ggtitle(\"Cross-Validation Error vs Lambda (Log Scale)\") +\n  xlab(\"Log(Lambda)\") +\n  ylab(\"Cross-Validation Error\")\n\n\n\n\n\n\n\n#The Lasso regression model has a lower MSE than the linear model (by about 0.003), which shows that the shrinkage technique in Lasso regression can improve model generalization while preventing overfitting. \n\n# Also, the Cross-Validation Error vs Lambda plot shows the error increasing rapidly as the log of lambda moves from -4 to 0."
  },
  {
    "objectID": "projects/2-project.html#compare-the-training-and-testing-mses-of-lasso-regression",
    "href": "projects/2-project.html#compare-the-training-and-testing-mses-of-lasso-regression",
    "title": "Birth Weight Predictions (Coding Process Explained)",
    "section": "Compare the training and testing MSE’s of Lasso regression",
    "text": "Compare the training and testing MSE’s of Lasso regression\n\ny.pred.train_lasso &lt;- predict(best_lasso, x_full, s = bestlamb.cvL)\nmse_train_lasso &lt;- mean((y_full - y.pred.train_lasso)^2)\ncat(\"Training MSE (Lasso): \", mse_train_lasso, \"\\n\")\n\nTraining MSE (Lasso):  0.00642802 \n\ny.pred.test_lasso &lt;- predict(best_lasso, x_test, s = bestlamb.cvL)\nmse_test_lasso &lt;- mean((y_test - y.pred.test_lasso)^2)\ncat(\"Testing MSE (Lasso): \", mse_test_lasso, \"\\n\")\n\nTesting MSE (Lasso):  0.006628631 \n\n# Create design matrix (x) and response variable (y)\nx &lt;- model.matrix(lWeight ~ ., data = births2)  \ny &lt;- births2$lWeight  \n\nThe multiple linear regression model uses all predictors, resulting in high bias and less flexibility, with training and testing MSE values of 721256.4 and 707930.6, respectively.\nThe stepwise regression model, selecting 8 predictors, has only a slightly better MSE (721443.2 and 709755.3) respectively.\nRidge regression, with a lambda of 0.00224, after a log transformation, achieves a training MSE of 0.006721434 and a testing MSE of 0.006942309 by applying penalties to predictors, balancing bias and flexibility. These MSE are better that what was shown in stepwise.\nThe Lasso model, with similar performance (training MSE: 0.00642802, Testing MSE: 0.006628631), further reduces predictors, offering higher flexibility and lower variance.\nBased on the MSE values, Lasso Regression appears to be the best model. It has the lowest MSE on both the training (0.00642802) and testing sets (0.006628631), suggesting a good balance between bias and variance."
  },
  {
    "objectID": "projects/2-project.html#so-what-about-these-predictors-in-terms-of-their-final-number-of-predictors-their-bias-and-their-flexibility",
    "href": "projects/2-project.html#so-what-about-these-predictors-in-terms-of-their-final-number-of-predictors-their-bias-and-their-flexibility",
    "title": "Birth Weight Predictions (Code Displayed and Interpreted)",
    "section": "So what about these predictors in terms of their final number of predictors, their bias and their flexibility?",
    "text": "So what about these predictors in terms of their final number of predictors, their bias and their flexibility?\nTo answer this question, we need to know the definition of: Regularization: A technique to prevent overfitting by adding a penalty for complexity to the model. - Strong Regularization: Reduces the model’s flexibility, making it simpler. - Weak Regularization: Allows more flexibility, letting the model capture more details.\nRidge and Lasso regression handle regularization differently. Ridge reduces the size of all coefficients but keeps them in the model, which is great for balancing bias and variance. Lasso can shrink some coefficients to zero, which removes less important predictors and makes the model simpler. Ridge is better when you have many small, correlated effects, while Lasso works well when you want to focus on just the key predictors."
  },
  {
    "objectID": "projects/2-project.html#test-out-a-pcr-model-on-the-training-set",
    "href": "projects/2-project.html#test-out-a-pcr-model-on-the-training-set",
    "title": "Birth Weight Predictions (Coding Process Explained)",
    "section": "Test out a PCR model on the training set",
    "text": "Test out a PCR model on the training set\n\npcrmodel &lt;- pcr(B.train$Birth.Weight..g.~., data=B.train, scale=TRUE, validation=\"CV\")\nsummary(pcrmodel)\n\nData:   X dimension: 5000 49 \n    Y dimension: 5000 1\nFit method: svdpc\nNumber of components considered: 49\n\nVALIDATION: RMSEP\nCross-validated using 10 random segments.\n       (Intercept)  1 comps  2 comps  3 comps  4 comps  5 comps  6 comps\nCV           611.4    610.1    608.2    603.8    503.2    336.4    306.3\nadjCV        611.4    610.1    608.2    603.8    502.7    335.0    306.0\n       7 comps  8 comps  9 comps  10 comps  11 comps  12 comps  13 comps\nCV       306.1    306.2    305.9     305.0     304.7     304.5     304.2\nadjCV    305.9    305.9    305.8     304.8     304.6     304.4     304.1\n       14 comps  15 comps  16 comps  17 comps  18 comps  19 comps  20 comps\nCV          299     293.5     293.2     292.3     291.8     291.8     291.6\nadjCV       299     293.2     292.9     292.1     291.6     291.6     291.5\n       21 comps  22 comps  23 comps  24 comps  25 comps  26 comps  27 comps\nCV        290.7     290.0     289.7     289.3     288.7     285.9     285.1\nadjCV     290.5     289.7     289.6     289.3     287.9     285.3     285.1\n       28 comps  29 comps  30 comps  31 comps  32 comps  33 comps  34 comps\nCV        282.7     278.4     278.1     277.5     277.4     256.1     139.9\nadjCV     282.9     278.1     278.0     277.3     277.4     276.9     139.4\n       35 comps  36 comps  37 comps  38 comps  39 comps  40 comps  41 comps\nCV        139.2     139.2     139.1     138.6     138.1     138.1     138.2\nadjCV     139.0     139.1     139.0     138.6     138.0     138.0     138.1\n       42 comps  43 comps  44 comps  45 comps  46 comps  47 comps  48 comps\nCV        138.2     138.2     138.2     138.3     138.3     138.3     138.3\nadjCV     138.2     138.1     138.2     138.2     138.2     138.2     138.2\n       49 comps\nCV        138.5\nadjCV     138.2\n\nTRAINING: % variance explained\n                          1 comps  2 comps  3 comps  4 comps  5 comps  6 comps\nX                         11.8474   22.343   31.207    36.50    41.21    45.71\nB.train$Birth.Weight..g.   0.4779    1.156    2.635    32.49    70.13    74.99\n                          7 comps  8 comps  9 comps  10 comps  11 comps\nX                            49.2    52.60    55.89     59.14     62.07\nB.train$Birth.Weight..g.     75.0    75.07    75.07     75.31     75.36\n                          12 comps  13 comps  14 comps  15 comps  16 comps\nX                            64.78     67.27     69.53     71.71     73.80\nB.train$Birth.Weight..g.     75.42     75.48     76.38     77.23     77.29\n                          17 comps  18 comps  19 comps  20 comps  21 comps\nX                            75.83     77.84     79.82     81.63     83.23\nB.train$Birth.Weight..g.     77.45     77.55     77.55     77.60     77.73\n                          22 comps  23 comps  24 comps  25 comps  26 comps\nX                            84.78     86.27     87.53     88.73     89.92\nB.train$Birth.Weight..g.     77.93     77.94     78.00     78.27     78.65\n                          27 comps  28 comps  29 comps  30 comps  31 comps\nX                            91.07     92.09     93.06     93.96     94.78\nB.train$Birth.Weight..g.     78.66     79.07     79.72     79.74     79.87\n                          32 comps  33 comps  34 comps  35 comps  36 comps\nX                            95.56     96.23     96.85     97.39     97.85\nB.train$Birth.Weight..g.     79.88     79.92     94.87     94.90     94.91\n                          37 comps  38 comps  39 comps  40 comps  41 comps\nX                            98.29     98.71     99.05     99.37     99.69\nB.train$Birth.Weight..g.     94.91     94.95     94.99     94.99     94.99\n                          42 comps  43 comps  44 comps  45 comps  46 comps\nX                            99.85     99.99     99.99       100       100\nB.train$Birth.Weight..g.     94.99     95.00     95.00        95        95\n                          47 comps  48 comps  49 comps\nX                              100       100       100\nB.train$Birth.Weight..g.        95        95        95\n\nvalidationplot(pcrmodel)\n\n\n\n\n\n\n\n# choose 40 principle components based on analysis of summary of pcr model\n# amount of variation explained by 40 principal components: 99.37% (also from pcr model analysis)\n\n# Check to see the optimal M and the amount of variation\noptimal_M &lt;- which.min(pcrmodel$validation$PRESS)\n\n# Test model\ntrain_predictions &lt;- predict(pcrmodel, newdata = B.train, ncomp = optimal_M)\nMSE.Btrain &lt;- mean((B.train$Birth.Weight..g. - train_predictions)^2)\n\ntest_predictions &lt;- predict(pcrmodel,newdata = B.test , ncomp = optimal_M)\nMSE.Btest &lt;- mean((B.test$Birth.Weight..g. - test_predictions)^2)\n\n# Report the optimal M principal components and MSE's\ncat(\"Optimal M:\", optimal_M, \"\\n\")\n\nOptimal M: 40 \n\n#cat(\"Amount of Variance explained by the optimal M:\", explained_variance, \"\\n\")\ncat(\"Training MSE:\", MSE.Btrain, \"\\n\")\n\nTraining MSE: 18709.24 \n\ncat(\"Testing MSE:\", MSE.Btest, \"\\n\")\n\nTesting MSE: 19207.04 \n\n# The validation plot is a visualization for the optimal M by showing that the RMSEP is lowest beginning at around 38."
  },
  {
    "objectID": "projects/2-project.html#do-the-same-but-with-a-pls-model-annd-use-85-as-your-threshold-for-the-amount-of-variation-in-the-x-matrix",
    "href": "projects/2-project.html#do-the-same-but-with-a-pls-model-annd-use-85-as-your-threshold-for-the-amount-of-variation-in-the-x-matrix",
    "title": "Birth Weight Predictions (Coding Process Explained)",
    "section": "Do the same but with a PLS model, annd use 85% as your threshold for the amount of variation in the X matrix",
    "text": "Do the same but with a PLS model, annd use 85% as your threshold for the amount of variation in the X matrix\n\nplsmodel &lt;- plsr(B.train$Birth.Weight..g.~., data=B.train, scale=TRUE, validation=\"CV\")\nsummary(plsmodel)\n\nData:   X dimension: 5000 49 \n    Y dimension: 5000 1\nFit method: kernelpls\nNumber of components considered: 49\n\nVALIDATION: RMSEP\nCross-validated using 10 random segments.\n       (Intercept)  1 comps  2 comps  3 comps  4 comps  5 comps  6 comps\nCV           611.4    284.8    248.3    197.6    162.1    146.8    141.5\nadjCV        611.4    284.6    248.2    197.5    161.8    146.6    141.4\n       7 comps  8 comps  9 comps  10 comps  11 comps  12 comps  13 comps\nCV       138.7    138.2    138.1     138.1     138.1     138.1     138.1\nadjCV    138.7    138.1    138.1     138.0     138.0     138.1     138.1\n       14 comps  15 comps  16 comps  17 comps  18 comps  19 comps  20 comps\nCV        138.1     138.1     138.1     138.1     138.1     138.1     138.1\nadjCV     138.1     138.1     138.1     138.1     138.1     138.1     138.1\n       21 comps  22 comps  23 comps  24 comps  25 comps  26 comps  27 comps\nCV        138.1     138.2     138.2     138.2     138.2     138.2     138.2\nadjCV     138.1     138.1     138.1     138.1     138.1     138.1     138.1\n       28 comps  29 comps  30 comps  31 comps  32 comps  33 comps  34 comps\nCV        138.2     138.2     138.2     138.2     138.2     138.2     138.2\nadjCV     138.1     138.1     138.1     138.1     138.1     138.1     138.1\n       35 comps  36 comps  37 comps  38 comps  39 comps  40 comps  41 comps\nCV        138.2     138.2     138.2     138.2     138.2     138.2     138.2\nadjCV     138.1     138.1     138.1     138.1     138.1     138.1     138.1\n       42 comps  43 comps  44 comps  45 comps  46 comps  47 comps  48 comps\nCV        138.2     138.2     138.2     138.2     138.2     138.2     138.2\nadjCV     138.1     138.1     138.1     138.1     138.1     138.1     138.1\n       49 comps\nCV        138.2\nadjCV     138.1\n\nTRAINING: % variance explained\n                          1 comps  2 comps  3 comps  4 comps  5 comps  6 comps\nX                           5.585    15.15    20.14    26.76    32.35    39.33\nB.train$Birth.Weight..g.   78.466    83.66    89.78    93.17    94.37    94.76\n                          7 comps  8 comps  9 comps  10 comps  11 comps\nX                           43.83    45.97    48.90     52.03     53.96\nB.train$Birth.Weight..g.    94.95    94.99    94.99     94.99     95.00\n                          12 comps  13 comps  14 comps  15 comps  16 comps\nX                            55.52      57.5     59.42     61.21     62.78\nB.train$Birth.Weight..g.     95.00      95.0     95.00     95.00     95.00\n                          17 comps  18 comps  19 comps  20 comps  21 comps\nX                            64.59     66.67     68.34     70.63     72.17\nB.train$Birth.Weight..g.     95.00     95.00     95.00     95.00     95.00\n                          22 comps  23 comps  24 comps  25 comps  26 comps\nX                            73.83     75.04     76.28     77.71     79.09\nB.train$Birth.Weight..g.     95.00     95.00     95.00     95.00     95.00\n                          27 comps  28 comps  29 comps  30 comps  31 comps\nX                            81.23     82.88     83.89     85.07     86.27\nB.train$Birth.Weight..g.     95.00     95.00     95.00     95.00     95.00\n                          32 comps  33 comps  34 comps  35 comps  36 comps\nX                            87.65     88.55     89.26     90.46     91.37\nB.train$Birth.Weight..g.     95.00     95.00     95.00     95.00     95.00\n                          37 comps  38 comps  39 comps  40 comps  41 comps\nX                            92.52     93.49     94.46     95.91      97.2\nB.train$Birth.Weight..g.     95.00     95.00     95.00     95.00      95.0\n                          42 comps  43 comps  44 comps  45 comps  46 comps\nX                            97.95     98.45     99.39       100     100.1\nB.train$Birth.Weight..g.     95.00     95.00     95.00        95      95.0\n                          47 comps  48 comps  49 comps\nX                            100.2     100.3     100.5\nB.train$Birth.Weight..g.      95.0      95.0      95.0\n\nvalidationplot(plsmodel)\n\n\n\n\n\n\n\n# choose 10 principal components (from summary analysis)\n# amount of variation explained by 10 principal components: 94.99%\n\n# Check to see the optimal M and the amount of variation\noptimal_M &lt;- which.min(plsmodel$validation$PRESS)\nexplained_variance &lt;- cumsum(explvar(plsmodel))\n\ntrain_predictions &lt;- predict(plsmodel, newdata = B.train, ncomp = optimal_M)\nMSE.Btrain &lt;- mean((B.train$Birth.Weight..g. - train_predictions)^2)\n\ntest_predictions &lt;- predict(plsmodel,newdata = B.test , ncomp = optimal_M)\nMSE.Btest &lt;- mean((B.test$Birth.Weight..g. - test_predictions)^2)\n\ncat(\"Optimal M:\", optimal_M, \"\\n\")\n\nOptimal M: 10 \n\n#cat(\"Amount of Variance explained by the optimal M:\", explained_variance, \"\\n\")\ncat(\"Training MSE:\", MSE.Btrain, \"\\n\")\n\nTraining MSE: 18701.52 \n\ncat(\"Testing MSE:\", MSE.Btest, \"\\n\")\n\nTesting MSE: 19238.18 \n\n# The validation plot is a visualization for the optimal M by showing that the RMSEP is lowest beginning at a little before 10."
  },
  {
    "objectID": "projects/2-project.html#fit-a-gam-on-the-training-data.-use-the-features-in-the-step-bic-function-as-the-predictors.",
    "href": "projects/2-project.html#fit-a-gam-on-the-training-data.-use-the-features-in-the-step-bic-function-as-the-predictors.",
    "title": "Birth Weight Predictions (Coding Process Explained)",
    "section": "Fit a GAM on the training data. Use the features in the step BIC function as the predictors.",
    "text": "Fit a GAM on the training data. Use the features in the step BIC function as the predictors.\n\ngammodel &lt;- gam(B.train$Birth.Weight..g. ~ \n                  s(Weeks) + \n                  s(Wt.Gain) + \n                  Plurality.of.birth + Gender + Race + \n                  Birth.weight.group + Father.Minority + Smoker, \n                data = B.train)\n\n#summary(gammodel)\n\npar(mfrow = c(2, 2)) \n#plot(gammodel, se = TRUE, shade = TRUE)\n\ntrain_predictions &lt;- predict(gammodel, newdata = B.train)\ntrain_mse &lt;- mean((B.train$Birth.Weight..g. - train_predictions)^2)\ncat(\"Training MSE:\", train_mse, \"\\n\")\n\nTraining MSE: 18783.65 \n\n# Unfortunately, I've run into errors with the plot function.\n\nB.train$Predicted &lt;- predict(gammodel, newdata = B.train)\n\nggplot(B.train, aes(x = Birth.Weight..g., y = Predicted)) +\n  geom_point(alpha = 0.5) +\n  geom_abline(slope = 1, intercept = 0, color = \"red\") +\n  theme_minimal() +\n  labs(\n    title = \"Actual vs Predicted Birth Weight\",\n    x = \"Actual Birth Weight (grams)\",\n    y = \"Predicted Birth Weight (grams)\"\n)\n\n\n\n\n\n\n\n\nThe actual vs. predicted weights plot shows that the GAM model fits the training data very well. It accurately predicts the baby weights given the significant predictors chosen from the step BIC function. Also, the training and testing MSE are relatively close and does not overfit. The testing MSE is higher than the training, as expected."
  },
  {
    "objectID": "projects/2-project.html#evaluate-the-model-obtained-on-the-testing-data-set",
    "href": "projects/2-project.html#evaluate-the-model-obtained-on-the-testing-data-set",
    "title": "Birth Weight Predictions (Code Displayed and Interpreted)",
    "section": "Evaluate the model obtained on the testing data set",
    "text": "Evaluate the model obtained on the testing data set\n\nlibrary(splines)\n\ngammodel2 &lt;- gam(Birth.Weight..g. ~ Plurality.of.birth + Gender + Race + s(Weeks, k = 5) + Birth.weight.group + Father.Minority + Smoker + s(Wt.Gain, k = 5),data = B.test)\nsummary(gammodel2)\n\n\nFamily: gaussian \nLink function: identity \n\nFormula:\nBirth.Weight..g. ~ Plurality.of.birth + Gender + Race + s(Weeks, \n    k = 5) + Birth.weight.group + Father.Minority + Smoker + \n    s(Wt.Gain, k = 5)\n\nParametric coefficients:\n                     Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           545.643     27.234  20.036  &lt; 2e-16 ***\nPlurality.of.birth    -45.572     14.717  -3.097  0.00198 ** \nGender                 -7.759      5.247  -1.479  0.13934    \nRaceOther              -9.130     13.398  -0.681  0.49566    \nRaceWhite               4.800     12.478   0.385  0.70052    \nBirth.weight.group    455.873      2.775 164.297  &lt; 2e-16 ***\nFather.MinorityWhite   10.143     11.369   0.892  0.37238    \nSmokerNo               29.653      9.458   3.135  0.00173 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nApproximate significance of smooth terms:\n             edf Ref.df      F p-value    \ns(Weeks)   3.201  3.608 21.100  &lt;2e-16 ***\ns(Wt.Gain) 1.000  1.000  5.552  0.0185 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nR-sq.(adj) =  0.947   Deviance explained = 94.8%\nGCV =  19248  Scale est. = 19166     n = 2861\n\nB.test$Predicted &lt;- predict(gammodel2, newdata = B.test)\ntest_mse &lt;- mean((B.test$Birth.Weight..g. - B.test$Predicted)^2)\n\nss_total &lt;- sum((B.test$Birth.Weight..g. - mean(B.test$Birth.Weight..g.))^2)\nss_residual &lt;- sum((B.test$Birth.Weight..g. - B.test$Predicted)^2)\nr_squared &lt;- 1 - (ss_residual / ss_total)\n\nggplot(B.test, aes(x = Birth.Weight..g., y = Predicted)) +\n  geom_point(alpha = 0.5, color = \"blue\") +\n  geom_abline(slope = 1, intercept = 0, color = \"red\") +\n  theme_minimal() +\nlabs(\n  title = \"Actual vs Predicted Birth Weight (Testing Data)\",\n  x = \"Actual Birth Weight (grams)\",\n  y = \"Predicted Birth Weight (grams)\"\n)\n\n\n\n\n\n\n\ncat(\"Testing MSE:\", test_mse, \"\\n\")\n\nTesting MSE: 19084.45 \n\ncat(\"Testing R-squared:\", r_squared, \"\\n\")\n\nTesting R-squared: 0.9476297 \n\n\nThe GAM model fits the testing data very well with a high r squared, and the the model does not overfit as the testing MSE is similar to the training MSE. The testing MSE is higher than the training, as expected."
  },
  {
    "objectID": "projects/2-project.html#which-of-the-predictor-variables-has-evidence-of-a-non-linear-relationship-with-the-response-variable",
    "href": "projects/2-project.html#which-of-the-predictor-variables-has-evidence-of-a-non-linear-relationship-with-the-response-variable",
    "title": "Birth Weight Predictions (Code Displayed and Interpreted)",
    "section": "Which of the predictor variables has evidence of a non-linear relationship with the response variable?",
    "text": "Which of the predictor variables has evidence of a non-linear relationship with the response variable?\n“Weeks” shows evidence of a non-linear relationship with birth weight, with a very low p-value in both GAM summaries. “Wt.Gain” shows a weak non-linear relationship with a p value closer to 0.05, suggesting it is closer to linear but not completely."
  },
  {
    "objectID": "projects/2-project.html#load-the-data",
    "href": "projects/2-project.html#load-the-data",
    "title": "Birth Weight Predictions (Code Displayed and Interpreted)",
    "section": "",
    "text": "births &lt;- read.csv(\"~/Downloads/birthsnewone.csv\")\nset.seed(123456789)\nhead(births)\n\n  X Institution.type Plurality.of.birth Gender Race.of.child  Race\n1 1                1                  1      2             1 White\n2 2                1                  1      2             1 White\n3 3                1                  1      2             1 White\n4 4                1                  1      2             2 Black\n5 5                1                  1      1             2 Black\n6 6                1                  1      2             1 White\n  Age.of.father Age.of.mother Education.of.father..years.\n1            50            24                          12\n2            19            18                           9\n3            37            35                          17\n4            39            31                          11\n5            20            19                          11\n6            30            27                          16\n  Education.of.mother..years. Total.Preg BDead Terms Date.LBirth Month.LBirth\n1                          15          2     0     0       32004            3\n2                           9          1     0     0           0            0\n3                          17          2     0     0      112003           11\n4                          16          1     0     0           0            0\n5                          12          1     0     0           0            0\n6                          16          1     0     0           0            0\n  Year.LBirth LOutcome Weeks Prenatal Trimester.Prenatal Visits\n1        2004        1    38        3                  1     10\n2           0        9    35        3                  1      9\n3        2003        1    38        1                  1     20\n4           0        9    38        6                  2     12\n5           0        9    36        4                  2     10\n6           0        9    40        1                  1     20\n  Birth.weight.group Marital Birth.Attendant Numchild Month.Term Year.Term\n1                  5       2               1        1          0         0\n2                  6       2               1        0          0         0\n3                  5       1               1        1          0         0\n4                  5       2               1        0          0         0\n5                  6       2               1        0          0         0\n6                  6       1               1        0          0         0\n  Low.Birth RaceMom RaceDad Mother.Minority Father.Minority HispMom HispDad\n1      Norm       1       2           White        Nonwhite       N       N\n2      Norm       1       1           White           White       N       N\n3      Norm       1       1           White           White       N       N\n4      Norm       2       2        Nonwhite        Nonwhite       N       N\n5      Norm       2       1        Nonwhite           White       N       M\n6      Norm       1       1           White           White       N       N\n  AveCigs Smoker AveDrink Wt.Gain Birth.Weight..g.\n1       0     No        0      50         2865.875\n2      23   Cigs        0      35         3121.250\n3       0     No        0      24         2667.250\n4       0     No        0      30         2979.375\n5       0     No        0      10         3036.125\n6       0     No        0      37         3092.875"
  },
  {
    "objectID": "projects/2-project.html#understand-the-variables",
    "href": "projects/2-project.html#understand-the-variables",
    "title": "Birth Weight Predictions (Code Displayed and Interpreted)",
    "section": "",
    "text": "dim(births)\n\n[1] 7861   39\n\nUniqueCount &lt;- sapply(births, function(x) length(unique(x)))\nFirstFewValues &lt;- sapply(births, function(x) paste0(head(x, 5), collapse = \", \"))\n\ndf.unique &lt;- data.frame(\n  Column = names(UniqueCount),\n  UniqueCount = UniqueCount,\n  FirstFewValues = FirstFewValues,\n  row.names = NULL\n)\n\ndf.unique\n\n                        Column UniqueCount\n1                            X        7861\n2             Institution.type           3\n3           Plurality.of.birth           4\n4                       Gender           2\n5                Race.of.child           9\n6                         Race           3\n7                Age.of.father          45\n8                Age.of.mother          34\n9  Education.of.father..years.          18\n10 Education.of.mother..years.          18\n11                  Total.Preg          15\n12                       BDead           4\n13                       Terms          12\n14                 Date.LBirth         233\n15                Month.LBirth          13\n16                 Year.LBirth          27\n17                    LOutcome           3\n18                       Weeks          28\n19                    Prenatal          10\n20          Trimester.Prenatal           3\n21                      Visits          35\n22          Birth.weight.group          10\n23                     Marital           2\n24             Birth.Attendant           5\n25                    Numchild          12\n26                  Month.Term          13\n27                   Year.Term          24\n28                   Low.Birth           2\n29                     RaceMom           9\n30                     RaceDad           9\n31             Mother.Minority           2\n32             Father.Minority           2\n33                     HispMom           7\n34                     HispDad           7\n35                     AveCigs          20\n36                      Smoker           2\n37                    AveDrink           6\n38                     Wt.Gain          85\n39            Birth.Weight..g.         167\n                                   FirstFewValues\n1                                   1, 2, 3, 4, 5\n2                                   1, 1, 1, 1, 1\n3                                   1, 1, 1, 1, 1\n4                                   2, 2, 2, 2, 1\n5                                   1, 1, 1, 2, 2\n6               White, White, White, Black, Black\n7                              50, 19, 37, 39, 20\n8                              24, 18, 35, 31, 19\n9                               12, 9, 17, 11, 11\n10                              15, 9, 17, 16, 12\n11                                  2, 1, 2, 1, 1\n12                                  0, 0, 0, 0, 0\n13                                  0, 0, 0, 0, 0\n14                         32004, 0, 112003, 0, 0\n15                                 3, 0, 11, 0, 0\n16                            2004, 0, 2003, 0, 0\n17                                  1, 9, 1, 9, 9\n18                             38, 35, 38, 38, 36\n19                                  3, 3, 1, 6, 4\n20                                  1, 1, 1, 2, 2\n21                              10, 9, 20, 12, 10\n22                                  5, 6, 5, 5, 6\n23                                  2, 2, 1, 2, 2\n24                                  1, 1, 1, 1, 1\n25                                  1, 0, 1, 0, 0\n26                                  0, 0, 0, 0, 0\n27                                  0, 0, 0, 0, 0\n28                   Norm, Norm, Norm, Norm, Norm\n29                                  1, 1, 1, 2, 2\n30                                  2, 1, 1, 2, 1\n31        White, White, White, Nonwhite, Nonwhite\n32        Nonwhite, White, White, Nonwhite, White\n33                                  N, N, N, N, N\n34                                  N, N, N, N, M\n35                                 0, 23, 0, 0, 0\n36                           No, Cigs, No, No, No\n37                                  0, 0, 0, 0, 0\n38                             50, 35, 24, 30, 10\n39 2865.875, 3121.25, 2667.25, 2979.375, 3036.125\n\n\nThere are 39 predictors, and 7861 data points. The column labeled “X” is an index column that r creates. It’s a placeholder index, so you easily access specific rows in your dataset using the index. It can be removed later in data manipulation."
  },
  {
    "objectID": "projects/2-project.html#but-can-we-get-a-better-mse-lets-try-out-a-backward-stepwise-model-and-choose-the-best-predictors.",
    "href": "projects/2-project.html#but-can-we-get-a-better-mse-lets-try-out-a-backward-stepwise-model-and-choose-the-best-predictors.",
    "title": "Birth Weight Predictions (Code Displayed and Interpreted)",
    "section": "But can we get a better MSE? Let’s try out a backward stepwise model and choose the best predictors.",
    "text": "But can we get a better MSE? Let’s try out a backward stepwise model and choose the best predictors.\n\nstepwise &lt;- step(model, direction = \"backward\") # the results are very long, unfortunately\n\nStart:  AIC=49270.91\nBirth.Weight..g. ~ X + Institution.type + Plurality.of.birth + \n    Gender + Race.of.child + Race + Age.of.father + Age.of.mother + \n    Education.of.father..years. + Education.of.mother..years. + \n    Total.Preg + BDead + Terms + Date.LBirth + Month.LBirth + \n    Year.LBirth + LOutcome + Weeks + Prenatal + Trimester.Prenatal + \n    Visits + Birth.weight.group + Marital + Birth.Attendant + \n    Numchild + Month.Term + Year.Term + Low.Birth + RaceMom + \n    RaceDad + Mother.Minority + Father.Minority + HispMom + HispDad + \n    AveCigs + Smoker + AveDrink + Wt.Gain\n\n\nStep:  AIC=49270.91\nBirth.Weight..g. ~ X + Institution.type + Plurality.of.birth + \n    Gender + Race.of.child + Race + Age.of.father + Age.of.mother + \n    Education.of.father..years. + Education.of.mother..years. + \n    Total.Preg + BDead + Terms + Date.LBirth + Month.LBirth + \n    Year.LBirth + LOutcome + Weeks + Prenatal + Trimester.Prenatal + \n    Visits + Birth.weight.group + Marital + Birth.Attendant + \n    Numchild + Month.Term + Year.Term + Low.Birth + RaceMom + \n    RaceDad + Father.Minority + HispMom + HispDad + AveCigs + \n    Smoker + AveDrink + Wt.Gain\n\n\nStep:  AIC=49270.91\nBirth.Weight..g. ~ X + Institution.type + Plurality.of.birth + \n    Gender + Race.of.child + Race + Age.of.father + Age.of.mother + \n    Education.of.father..years. + Education.of.mother..years. + \n    Total.Preg + BDead + Terms + Date.LBirth + Month.LBirth + \n    Year.LBirth + LOutcome + Weeks + Prenatal + Trimester.Prenatal + \n    Visits + Birth.weight.group + Marital + Birth.Attendant + \n    Numchild + Month.Term + Year.Term + Low.Birth + RaceDad + \n    Father.Minority + HispMom + HispDad + AveCigs + Smoker + \n    AveDrink + Wt.Gain\n\n\nStep:  AIC=49270.91\nBirth.Weight..g. ~ X + Institution.type + Plurality.of.birth + \n    Gender + Race.of.child + Race + Age.of.father + Age.of.mother + \n    Education.of.father..years. + Education.of.mother..years. + \n    Total.Preg + BDead + Terms + Date.LBirth + Month.LBirth + \n    Year.LBirth + LOutcome + Weeks + Prenatal + Trimester.Prenatal + \n    Visits + Birth.weight.group + Marital + Birth.Attendant + \n    Month.Term + Year.Term + Low.Birth + RaceDad + Father.Minority + \n    HispMom + HispDad + AveCigs + Smoker + AveDrink + Wt.Gain\n\n\nStep:  AIC=49270.91\nBirth.Weight..g. ~ X + Institution.type + Plurality.of.birth + \n    Gender + Race.of.child + Race + Age.of.father + Age.of.mother + \n    Education.of.father..years. + Education.of.mother..years. + \n    Total.Preg + BDead + Terms + Date.LBirth + Month.LBirth + \n    LOutcome + Weeks + Prenatal + Trimester.Prenatal + Visits + \n    Birth.weight.group + Marital + Birth.Attendant + Month.Term + \n    Year.Term + Low.Birth + RaceDad + Father.Minority + HispMom + \n    HispDad + AveCigs + Smoker + AveDrink + Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- HispDad                      6     71835  93525388 49263\n- HispMom                      6    144476  93598030 49267\n- Trimester.Prenatal           1        76  93453629 49269\n- Terms                        1       693  93454247 49269\n- Education.of.mother..years.  1       848  93454401 49269\n- Age.of.father                1      1077  93454630 49269\n- Total.Preg                   1      1900  93455453 49269\n- Father.Minority              1      2009  93455563 49269\n- Race.of.child                1      2041  93455595 49269\n- X                            1      2265  93455819 49269\n- AveDrink                     1      2749  93456302 49269\n- BDead                        1      2895  93456449 49269\n- Prenatal                     1      4918  93458471 49269\n- RaceDad                      1     10782  93464336 49269\n- AveCigs                      1     11274  93464828 49270\n- Institution.type             1     18088  93471642 49270\n- Birth.Attendant              1     22060  93475614 49270\n- Visits                       1     22290  93475844 49270\n- Education.of.father..years.  1     25134  93478688 49270\n- Marital                      1     26964  93480518 49270\n- Year.Term                    1     28251  93481804 49270\n- LOutcome                     1     30684  93484237 49271\n- Age.of.mother                1     33194  93486748 49271\n&lt;none&gt;                                      93453554 49271\n- Race                         2     98382  93551936 49272\n- Low.Birth                    1     64614  93518168 49272\n- Month.Term                   1     96920  93550473 49274\n- Month.LBirth                 1    102281  93555834 49274\n- Date.LBirth                  1    102384  93555937 49274\n- Gender                       1    113929  93567483 49275\n- Smoker                       1    121188  93574742 49275\n- Plurality.of.birth           1    243163  93696716 49282\n- Wt.Gain                      1    263341  93716895 49283\n- Weeks                        1   2744656  96198210 49414\n- Birth.weight.group           1 711671687 805125240 60037\n\nStep:  AIC=49262.75\nBirth.Weight..g. ~ X + Institution.type + Plurality.of.birth + \n    Gender + Race.of.child + Race + Age.of.father + Age.of.mother + \n    Education.of.father..years. + Education.of.mother..years. + \n    Total.Preg + BDead + Terms + Date.LBirth + Month.LBirth + \n    LOutcome + Weeks + Prenatal + Trimester.Prenatal + Visits + \n    Birth.weight.group + Marital + Birth.Attendant + Month.Term + \n    Year.Term + Low.Birth + RaceDad + Father.Minority + HispMom + \n    AveCigs + Smoker + AveDrink + Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- HispMom                      6    107874  93633263 49257\n- Trimester.Prenatal           1       357  93525746 49261\n- Terms                        1       854  93526242 49261\n- Age.of.father                1       999  93526387 49261\n- Education.of.mother..years.  1      1247  93526635 49261\n- Race.of.child                1      1395  93526783 49261\n- Total.Preg                   1      1853  93527242 49261\n- X                            1      2618  93528006 49261\n- AveDrink                     1      2794  93528183 49261\n- Father.Minority              1      3039  93528428 49261\n- BDead                        1      3063  93528451 49261\n- Prenatal                     1      3872  93529260 49261\n- AveCigs                      1     11261  93536649 49261\n- RaceDad                      1     12842  93538231 49261\n- Institution.type             1     17979  93543368 49262\n- Birth.Attendant              1     20942  93546330 49262\n- Education.of.father..years.  1     23580  93548968 49262\n- Visits                       1     24631  93550019 49262\n- Marital                      1     26407  93551795 49262\n- Year.Term                    1     28389  93553777 49262\n- LOutcome                     1     30194  93555582 49262\n- Age.of.mother                1     32947  93558335 49263\n&lt;none&gt;                                      93525388 49263\n- Low.Birth                    1     67073  93592461 49264\n- Race                         2    106534  93631923 49264\n- Month.Term                   1     94720  93620108 49266\n- Month.LBirth                 1    101556  93626944 49266\n- Date.LBirth                  1    101660  93627048 49266\n- Gender                       1    112824  93638213 49267\n- Smoker                       1    123060  93648449 49267\n- Plurality.of.birth           1    242055  93767444 49274\n- Wt.Gain                      1    263032  93788421 49275\n- Weeks                        1   2743738  96269127 49405\n- Birth.weight.group           1 712280260 805805649 60029\n\nStep:  AIC=49256.52\nBirth.Weight..g. ~ X + Institution.type + Plurality.of.birth + \n    Gender + Race.of.child + Race + Age.of.father + Age.of.mother + \n    Education.of.father..years. + Education.of.mother..years. + \n    Total.Preg + BDead + Terms + Date.LBirth + Month.LBirth + \n    LOutcome + Weeks + Prenatal + Trimester.Prenatal + Visits + \n    Birth.weight.group + Marital + Birth.Attendant + Month.Term + \n    Year.Term + Low.Birth + RaceDad + Father.Minority + AveCigs + \n    Smoker + AveDrink + Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- Trimester.Prenatal           1       239  93633502 49255\n- Age.of.father                1       507  93633770 49255\n- Race.of.child                1       780  93634043 49255\n- Terms                        1      1107  93634370 49255\n- Total.Preg                   1      1215  93634478 49255\n- Father.Minority              1      2019  93635282 49255\n- AveDrink                     1      2362  93635625 49255\n- X                            1      2413  93635676 49255\n- Education.of.mother..years.  1      3883  93637146 49255\n- BDead                        1      4292  93637555 49255\n- Prenatal                     1      5090  93638353 49255\n- AveCigs                      1     10646  93643909 49255\n- RaceDad                      1     12092  93645355 49255\n- Education.of.father..years.  1     15184  93648447 49255\n- Institution.type             1     18260  93651523 49255\n- Birth.Attendant              1     20945  93654208 49256\n- Visits                       1     23412  93656675 49256\n- Year.Term                    1     27779  93661042 49256\n- Marital                      1     27885  93661148 49256\n- LOutcome                     1     28892  93662155 49256\n- Age.of.mother                1     31504  93664767 49256\n&lt;none&gt;                                      93633263 49257\n- Low.Birth                    1     66920  93700183 49258\n- Race                         2    107086  93740349 49258\n- Month.Term                   1     97040  93730303 49260\n- Month.LBirth                 1    103555  93736818 49260\n- Date.LBirth                  1    103675  93736938 49260\n- Gender                       1    113196  93746459 49261\n- Smoker                       1    134589  93767852 49262\n- Plurality.of.birth           1    241539  93874801 49267\n- Wt.Gain                      1    256311  93889573 49268\n- Weeks                        1   2761996  96395259 49400\n- Birth.weight.group           1 712986585 806619847 60022\n\nStep:  AIC=49254.53\nBirth.Weight..g. ~ X + Institution.type + Plurality.of.birth + \n    Gender + Race.of.child + Race + Age.of.father + Age.of.mother + \n    Education.of.father..years. + Education.of.mother..years. + \n    Total.Preg + BDead + Terms + Date.LBirth + Month.LBirth + \n    LOutcome + Weeks + Prenatal + Visits + Birth.weight.group + \n    Marital + Birth.Attendant + Month.Term + Year.Term + Low.Birth + \n    RaceDad + Father.Minority + AveCigs + Smoker + AveDrink + \n    Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- Age.of.father                1       513  93634016 49253\n- Race.of.child                1       764  93634267 49253\n- Terms                        1      1109  93634612 49253\n- Total.Preg                   1      1223  93634725 49253\n- Father.Minority              1      2029  93635531 49253\n- AveDrink                     1      2362  93635864 49253\n- X                            1      2462  93635965 49253\n- Education.of.mother..years.  1      3885  93637387 49253\n- BDead                        1      4329  93637831 49253\n- AveCigs                      1     10662  93644164 49253\n- RaceDad                      1     12180  93645682 49253\n- Education.of.father..years.  1     15251  93648753 49253\n- Institution.type             1     18370  93651873 49254\n- Prenatal                     1     18577  93652080 49254\n- Birth.Attendant              1     20855  93654358 49254\n- Visits                       1     23244  93656747 49254\n- Marital                      1     27719  93661222 49254\n- Year.Term                    1     27836  93661338 49254\n- LOutcome                     1     28876  93662378 49254\n- Age.of.mother                1     31565  93665067 49254\n&lt;none&gt;                                      93633502 49255\n- Low.Birth                    1     66940  93700443 49256\n- Race                         2    107108  93740610 49256\n- Month.Term                   1     97040  93730542 49258\n- Month.LBirth                 1    103459  93736961 49258\n- Date.LBirth                  1    103580  93737083 49258\n- Gender                       1    113153  93746656 49259\n- Smoker                       1    134687  93768190 49260\n- Plurality.of.birth           1    241303  93874806 49265\n- Wt.Gain                      1    256181  93889684 49266\n- Weeks                        1   2761827  96395330 49398\n- Birth.weight.group           1 712988733 806622235 60020\n\nStep:  AIC=49252.56\nBirth.Weight..g. ~ X + Institution.type + Plurality.of.birth + \n    Gender + Race.of.child + Race + Age.of.mother + Education.of.father..years. + \n    Education.of.mother..years. + Total.Preg + BDead + Terms + \n    Date.LBirth + Month.LBirth + LOutcome + Weeks + Prenatal + \n    Visits + Birth.weight.group + Marital + Birth.Attendant + \n    Month.Term + Year.Term + Low.Birth + RaceDad + Father.Minority + \n    AveCigs + Smoker + AveDrink + Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- Race.of.child                1       754  93634769 49251\n- Terms                        1      1159  93635174 49251\n- Total.Preg                   1      1173  93635188 49251\n- Father.Minority              1      2026  93636042 49251\n- AveDrink                     1      2421  93636437 49251\n- X                            1      2430  93636446 49251\n- Education.of.mother..years.  1      3775  93637791 49251\n- BDead                        1      4322  93638337 49251\n- AveCigs                      1     10623  93644639 49251\n- RaceDad                      1     12248  93646264 49251\n- Education.of.father..years.  1     14978  93648994 49251\n- Institution.type             1     18394  93652409 49252\n- Prenatal                     1     18660  93652676 49252\n- Birth.Attendant              1     21165  93655181 49252\n- Visits                       1     23241  93657257 49252\n- Marital                      1     27655  93661670 49252\n- Year.Term                    1     28006  93662022 49252\n- LOutcome                     1     28838  93662854 49252\n&lt;none&gt;                                      93634016 49253\n- Age.of.mother                1     46405  93680421 49253\n- Low.Birth                    1     66823  93700839 49254\n- Race                         2    107060  93741076 49254\n- Month.Term                   1     97175  93731191 49256\n- Month.LBirth                 1    103335  93737351 49256\n- Date.LBirth                  1    103456  93737472 49256\n- Gender                       1    113311  93747327 49257\n- Smoker                       1    134933  93768949 49258\n- Plurality.of.birth           1    241597  93875612 49263\n- Wt.Gain                      1    256611  93890627 49264\n- Weeks                        1   2761734  96395750 49396\n- Birth.weight.group           1 713139858 806773873 60019\n\nStep:  AIC=49250.6\nBirth.Weight..g. ~ X + Institution.type + Plurality.of.birth + \n    Gender + Race + Age.of.mother + Education.of.father..years. + \n    Education.of.mother..years. + Total.Preg + BDead + Terms + \n    Date.LBirth + Month.LBirth + LOutcome + Weeks + Prenatal + \n    Visits + Birth.weight.group + Marital + Birth.Attendant + \n    Month.Term + Year.Term + Low.Birth + RaceDad + Father.Minority + \n    AveCigs + Smoker + AveDrink + Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- Terms                        1      1141  93635911 49249\n- Total.Preg                   1      1185  93635954 49249\n- X                            1      2384  93637153 49249\n- AveDrink                     1      2420  93637190 49249\n- Father.Minority              1      3169  93637938 49249\n- Education.of.mother..years.  1      3700  93638469 49249\n- BDead                        1      4481  93639250 49249\n- AveCigs                      1     10647  93645416 49249\n- Education.of.father..years.  1     14753  93649522 49249\n- Institution.type             1     18346  93653116 49250\n- Prenatal                     1     18699  93653468 49250\n- Birth.Attendant              1     21198  93655968 49250\n- RaceDad                      1     23135  93657905 49250\n- Visits                       1     23323  93658093 49250\n- Marital                      1     27652  93662421 49250\n- Year.Term                    1     28259  93663029 49250\n- LOutcome                     1     28881  93663650 49250\n&lt;none&gt;                                      93634769 49251\n- Age.of.mother                1     46296  93681066 49251\n- Low.Birth                    1     66328  93701097 49252\n- Race                         2    122698  93757467 49253\n- Month.Term                   1     97566  93732336 49254\n- Month.LBirth                 1    103465  93738235 49254\n- Date.LBirth                  1    103586  93738355 49254\n- Gender                       1    113302  93748071 49255\n- Smoker                       1    134829  93769599 49256\n- Plurality.of.birth           1    241733  93876502 49261\n- Wt.Gain                      1    256559  93891328 49262\n- Weeks                        1   2768546  96403315 49394\n- Birth.weight.group           1 713358214 806992983 60018\n\nStep:  AIC=49248.66\nBirth.Weight..g. ~ X + Institution.type + Plurality.of.birth + \n    Gender + Race + Age.of.mother + Education.of.father..years. + \n    Education.of.mother..years. + Total.Preg + BDead + Date.LBirth + \n    Month.LBirth + LOutcome + Weeks + Prenatal + Visits + Birth.weight.group + \n    Marital + Birth.Attendant + Month.Term + Year.Term + Low.Birth + \n    RaceDad + Father.Minority + AveCigs + Smoker + AveDrink + \n    Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- X                            1      2408  93638319 49247\n- AveDrink                     1      2470  93638381 49247\n- Father.Minority              1      3208  93639119 49247\n- Education.of.mother..years.  1      3274  93639184 49247\n- BDead                        1      3941  93639851 49247\n- Total.Preg                   1      5199  93641109 49247\n- AveCigs                      1     10766  93646677 49247\n- Education.of.father..years.  1     14738  93650648 49247\n- Institution.type             1     18066  93653977 49248\n- Prenatal                     1     18476  93654386 49248\n- Birth.Attendant              1     20955  93656865 49248\n- RaceDad                      1     23440  93659351 49248\n- Visits                       1     23938  93659849 49248\n- Marital                      1     27473  93663383 49248\n- LOutcome                     1     29336  93665247 49248\n- Year.Term                    1     29376  93665287 49248\n&lt;none&gt;                                      93635911 49249\n- Age.of.mother                1     45226  93681137 49249\n- Low.Birth                    1     66214  93702124 49250\n- Race                         2    123410  93759320 49251\n- Month.Term                   1     97407  93733318 49252\n- Month.LBirth                 1    102669  93738580 49252\n- Date.LBirth                  1    102801  93738711 49252\n- Gender                       1    114014  93749925 49253\n- Smoker                       1    134755  93770666 49254\n- Plurality.of.birth           1    243339  93879250 49260\n- Wt.Gain                      1    257362  93893272 49260\n- Weeks                        1   2768511  96404421 49392\n- Birth.weight.group           1 713660859 807296769 60018\n\nStep:  AIC=49246.79\nBirth.Weight..g. ~ Institution.type + Plurality.of.birth + Gender + \n    Race + Age.of.mother + Education.of.father..years. + Education.of.mother..years. + \n    Total.Preg + BDead + Date.LBirth + Month.LBirth + LOutcome + \n    Weeks + Prenatal + Visits + Birth.weight.group + Marital + \n    Birth.Attendant + Month.Term + Year.Term + Low.Birth + RaceDad + \n    Father.Minority + AveCigs + Smoker + AveDrink + Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- AveDrink                     1      2494  93640813 49245\n- Education.of.mother..years.  1      3181  93641500 49245\n- Father.Minority              1      3202  93641521 49245\n- BDead                        1      3966  93642285 49245\n- Total.Preg                   1      5201  93643520 49245\n- AveCigs                      1     10837  93649156 49245\n- Education.of.father..years.  1     14522  93652841 49246\n- Institution.type             1     18113  93656432 49246\n- Prenatal                     1     18736  93657055 49246\n- Birth.Attendant              1     21002  93659321 49246\n- RaceDad                      1     23407  93661726 49246\n- Visits                       1     23909  93662228 49246\n- Marital                      1     27497  93665816 49246\n- LOutcome                     1     29322  93667641 49246\n- Year.Term                    1     29655  93667974 49246\n&lt;none&gt;                                      93638319 49247\n- Age.of.mother                1     45317  93683636 49247\n- Low.Birth                    1     66105  93704424 49248\n- Race                         2    123002  93761320 49249\n- Month.Term                   1     97830  93736148 49250\n- Month.LBirth                 1    102519  93740838 49250\n- Date.LBirth                  1    102653  93740972 49250\n- Gender                       1    113413  93751732 49251\n- Smoker                       1    134650  93772969 49252\n- Plurality.of.birth           1    242577  93880895 49258\n- Wt.Gain                      1    256808  93895126 49258\n- Weeks                        1   2768310  96406628 49390\n- Birth.weight.group           1 713723815 807362134 60016\n\nStep:  AIC=49244.92\nBirth.Weight..g. ~ Institution.type + Plurality.of.birth + Gender + \n    Race + Age.of.mother + Education.of.father..years. + Education.of.mother..years. + \n    Total.Preg + BDead + Date.LBirth + Month.LBirth + LOutcome + \n    Weeks + Prenatal + Visits + Birth.weight.group + Marital + \n    Birth.Attendant + Month.Term + Year.Term + Low.Birth + RaceDad + \n    Father.Minority + AveCigs + Smoker + Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- Father.Minority              1      3149  93643962 49243\n- Education.of.mother..years.  1      3319  93644132 49243\n- BDead                        1      3934  93644747 49243\n- Total.Preg                   1      5173  93645986 49243\n- AveCigs                      1     10858  93651671 49243\n- Education.of.father..years.  1     14688  93655501 49244\n- Institution.type             1     18115  93658928 49244\n- Prenatal                     1     18958  93659771 49244\n- Birth.Attendant              1     20943  93661756 49244\n- RaceDad                      1     23340  93664153 49244\n- Visits                       1     24346  93665159 49244\n- Marital                      1     27361  93668174 49244\n- Year.Term                    1     29368  93670181 49244\n- LOutcome                     1     29501  93670314 49244\n&lt;none&gt;                                      93640813 49245\n- Age.of.mother                1     45252  93686065 49245\n- Low.Birth                    1     66106  93706919 49246\n- Race                         2    122619  93763432 49247\n- Month.Term                   1     97738  93738551 49248\n- Month.LBirth                 1    102696  93743509 49248\n- Date.LBirth                  1    102835  93743648 49248\n- Gender                       1    113266  93754078 49249\n- Smoker                       1    133702  93774515 49250\n- Plurality.of.birth           1    242795  93883608 49256\n- Wt.Gain                      1    256775  93897588 49257\n- Weeks                        1   2767525  96408338 49389\n- Birth.weight.group           1 713814015 807454828 60015\n\nStep:  AIC=49243.09\nBirth.Weight..g. ~ Institution.type + Plurality.of.birth + Gender + \n    Race + Age.of.mother + Education.of.father..years. + Education.of.mother..years. + \n    Total.Preg + BDead + Date.LBirth + Month.LBirth + LOutcome + \n    Weeks + Prenatal + Visits + Birth.weight.group + Marital + \n    Birth.Attendant + Month.Term + Year.Term + Low.Birth + RaceDad + \n    AveCigs + Smoker + Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- Education.of.mother..years.  1      3130  93647092 49241\n- BDead                        1      3856  93647818 49241\n- Total.Preg                   1      5409  93649371 49241\n- AveCigs                      1     11353  93655315 49242\n- Education.of.father..years.  1     14720  93658683 49242\n- Institution.type             1     18049  93662012 49242\n- Prenatal                     1     18581  93662543 49242\n- Birth.Attendant              1     21268  93665230 49242\n- RaceDad                      1     22026  93665989 49242\n- Visits                       1     24329  93668291 49242\n- Marital                      1     25265  93669228 49242\n- LOutcome                     1     28944  93672907 49243\n- Year.Term                    1     29239  93673202 49243\n&lt;none&gt;                                      93643962 49243\n- Age.of.mother                1     43892  93687855 49243\n- Low.Birth                    1     65804  93709766 49245\n- Month.Term                   1     97887  93741849 49246\n- Month.LBirth                 1    101921  93745884 49247\n- Date.LBirth                  1    102058  93746020 49247\n- Gender                       1    111930  93755892 49247\n- Smoker                       1    134639  93778602 49248\n- Plurality.of.birth           1    242504  93886467 49254\n- Race                         2    290670  93934632 49255\n- Wt.Gain                      1    256914  93900877 49255\n- Weeks                        1   2764662  96408625 49387\n- Birth.weight.group           1 714503432 808147394 60017\n\nStep:  AIC=49241.25\nBirth.Weight..g. ~ Institution.type + Plurality.of.birth + Gender + \n    Race + Age.of.mother + Education.of.father..years. + Total.Preg + \n    BDead + Date.LBirth + Month.LBirth + LOutcome + Weeks + Prenatal + \n    Visits + Birth.weight.group + Marital + Birth.Attendant + \n    Month.Term + Year.Term + Low.Birth + RaceDad + AveCigs + \n    Smoker + Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- BDead                        1      3854  93650946 49239\n- Total.Preg                   1      7060  93654153 49240\n- AveCigs                      1     11437  93658529 49240\n- Education.of.father..years.  1     12356  93659448 49240\n- Institution.type             1     18216  93665308 49240\n- Prenatal                     1     19603  93666695 49240\n- Birth.Attendant              1     21098  93668190 49240\n- RaceDad                      1     21936  93669028 49240\n- Marital                      1     23457  93670549 49241\n- Visits                       1     23771  93670863 49241\n- LOutcome                     1     28338  93675430 49241\n- Year.Term                    1     30658  93677750 49241\n&lt;none&gt;                                      93647092 49241\n- Age.of.mother                1     40911  93688003 49241\n- Low.Birth                    1     65382  93712475 49243\n- Month.Term                   1     97763  93744855 49244\n- Month.LBirth                 1    101808  93748900 49245\n- Date.LBirth                  1    101937  93749029 49245\n- Gender                       1    111657  93758749 49245\n- Smoker                       1    134087  93781179 49246\n- Plurality.of.birth           1    244812  93891905 49252\n- Wt.Gain                      1    254790  93901883 49253\n- Race                         2    296705  93943797 49253\n- Weeks                        1   2768356  96415448 49385\n- Birth.weight.group           1 714655103 808302195 60016\n\nStep:  AIC=49239.46\nBirth.Weight..g. ~ Institution.type + Plurality.of.birth + Gender + \n    Race + Age.of.mother + Education.of.father..years. + Total.Preg + \n    Date.LBirth + Month.LBirth + LOutcome + Weeks + Prenatal + \n    Visits + Birth.weight.group + Marital + Birth.Attendant + \n    Month.Term + Year.Term + Low.Birth + RaceDad + AveCigs + \n    Smoker + Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- Total.Preg                   1      9201  93660148 49238\n- AveCigs                      1     11185  93662132 49238\n- Education.of.father..years.  1     12354  93663300 49238\n- Institution.type             1     18272  93669218 49238\n- Prenatal                     1     19331  93670277 49238\n- Birth.Attendant              1     20884  93671830 49239\n- RaceDad                      1     22677  93673623 49239\n- Marital                      1     23297  93674243 49239\n- Visits                       1     24011  93674958 49239\n- LOutcome                     1     28125  93679071 49239\n- Year.Term                    1     32928  93683874 49239\n&lt;none&gt;                                      93650946 49239\n- Age.of.mother                1     40063  93691009 49240\n- Low.Birth                    1     65898  93716844 49241\n- Month.Term                   1     99340  93750286 49243\n- Month.LBirth                 1    101027  93751973 49243\n- Date.LBirth                  1    101153  93752099 49243\n- Gender                       1    111914  93762860 49243\n- Smoker                       1    133844  93784790 49245\n- Plurality.of.birth           1    246645  93897591 49251\n- Wt.Gain                      1    253520  93904466 49251\n- Race                         2    296261  93947207 49251\n- Weeks                        1   2766851  96417797 49383\n- Birth.weight.group           1 715517563 809168509 60020\n\nStep:  AIC=49237.95\nBirth.Weight..g. ~ Institution.type + Plurality.of.birth + Gender + \n    Race + Age.of.mother + Education.of.father..years. + Date.LBirth + \n    Month.LBirth + LOutcome + Weeks + Prenatal + Visits + Birth.weight.group + \n    Marital + Birth.Attendant + Month.Term + Year.Term + Low.Birth + \n    RaceDad + AveCigs + Smoker + Wt.Gain\n\n                              Df Sum of Sq       RSS   AIC\n- Education.of.father..years.  1      9841  93669988 49236\n- AveCigs                      1     11173  93671320 49237\n- Institution.type             1     17956  93678103 49237\n- Prenatal                     1     20926  93681073 49237\n- Birth.Attendant              1     21827  93681974 49237\n- RaceDad                      1     22253  93682401 49237\n- Marital                      1     22932  93683080 49237\n- Visits                       1     23363  93683511 49237\n- Year.Term                    1     24274  93684421 49237\n- LOutcome                     1     30218  93690366 49238\n&lt;none&gt;                                      93660148 49238\n- Age.of.mother                1     52197  93712345 49239\n- Low.Birth                    1     65278  93725425 49239\n- Month.Term                   1     98352  93758500 49241\n- Gender                       1    110357  93770505 49242\n- Smoker                       1    130899  93791046 49243\n- Month.LBirth                 1    131742  93791889 49243\n- Date.LBirth                  1    132164  93792312 49243\n- Plurality.of.birth           1    243342  93903489 49249\n- Race                         2    289461  93949609 49249\n- Wt.Gain                      1    252100  93912248 49249\n- Weeks                        1   2761147  96421294 49381\n- Birth.weight.group           1 716394675 810054822 60023\n\nStep:  AIC=49236.48\nBirth.Weight..g. ~ Institution.type + Plurality.of.birth + Gender + \n    Race + Age.of.mother + Date.LBirth + Month.LBirth + LOutcome + \n    Weeks + Prenatal + Visits + Birth.weight.group + Marital + \n    Birth.Attendant + Month.Term + Year.Term + Low.Birth + RaceDad + \n    AveCigs + Smoker + Wt.Gain\n\n                     Df Sum of Sq       RSS   AIC\n- AveCigs             1     10876  93680865 49235\n- Prenatal            1     16490  93686479 49235\n- Institution.type    1     16988  93686976 49235\n- RaceDad             1     19967  93689956 49236\n- Birth.Attendant     1     22401  93692390 49236\n- Year.Term           1     24424  93694413 49236\n- Visits              1     25198  93695186 49236\n- LOutcome            1     31040  93701028 49236\n- Marital             1     32542  93702530 49236\n&lt;none&gt;                             93669988 49236\n- Low.Birth           1     64569  93734558 49238\n- Age.of.mother       1     69733  93739721 49238\n- Month.Term          1     99348  93769337 49240\n- Gender              1    111043  93781032 49240\n- Month.LBirth        1    128894  93798882 49241\n- Date.LBirth         1    129305  93799293 49241\n- Smoker              1    130464  93800453 49241\n- Plurality.of.birth  1    240900  93910889 49247\n- Race                2    282031  93952019 49248\n- Wt.Gain             1    261667  93931655 49248\n- Weeks               1   2759646  96429635 49380\n- Birth.weight.group  1 716728836 810398824 60023\n\nStep:  AIC=49235.06\nBirth.Weight..g. ~ Institution.type + Plurality.of.birth + Gender + \n    Race + Age.of.mother + Date.LBirth + Month.LBirth + LOutcome + \n    Weeks + Prenatal + Visits + Birth.weight.group + Marital + \n    Birth.Attendant + Month.Term + Year.Term + Low.Birth + RaceDad + \n    Smoker + Wt.Gain\n\n                     Df Sum of Sq       RSS   AIC\n- Institution.type    1     16937  93697802 49234\n- Prenatal            1     17921  93698786 49234\n- RaceDad             1     20332  93701196 49234\n- Birth.Attendant     1     20966  93701831 49234\n- Year.Term           1     24484  93705348 49234\n- Visits              1     25261  93706126 49234\n- LOutcome            1     30859  93711724 49235\n- Marital             1     34003  93714867 49235\n&lt;none&gt;                             93680865 49235\n- Low.Birth           1     64523  93745387 49236\n- Age.of.mother       1     71193  93752058 49237\n- Month.Term          1     98790  93779655 49238\n- Gender              1    111363  93792227 49239\n- Month.LBirth        1    130126  93810991 49240\n- Date.LBirth         1    130521  93811386 49240\n- Plurality.of.birth  1    241872  93922737 49246\n- Smoker              1    242983  93923848 49246\n- Race                2    287000  93967865 49246\n- Wt.Gain             1    261574  93942439 49247\n- Weeks               1   2759522  96440387 49378\n- Birth.weight.group  1 717126874 810807739 60024\n\nStep:  AIC=49233.96\nBirth.Weight..g. ~ Plurality.of.birth + Gender + Race + Age.of.mother + \n    Date.LBirth + Month.LBirth + LOutcome + Weeks + Prenatal + \n    Visits + Birth.weight.group + Marital + Birth.Attendant + \n    Month.Term + Year.Term + Low.Birth + RaceDad + Smoker + Wt.Gain\n\n                     Df Sum of Sq       RSS   AIC\n- Prenatal            1     16659  93714460 49233\n- Birth.Attendant     1     17184  93714986 49233\n- RaceDad             1     20667  93718468 49233\n- Year.Term           1     24802  93722603 49233\n- Visits              1     24949  93722751 49233\n- LOutcome            1     31275  93729077 49234\n- Marital             1     34093  93731894 49234\n&lt;none&gt;                             93697802 49234\n- Low.Birth           1     64855  93762657 49235\n- Age.of.mother       1     69059  93766861 49236\n- Month.Term          1     99803  93797605 49237\n- Gender              1    111532  93809334 49238\n- Month.LBirth        1    130014  93827816 49239\n- Date.LBirth         1    130433  93828235 49239\n- Smoker              1    241271  93939073 49245\n- Plurality.of.birth  1    241620  93939422 49245\n- Race                2    285977  93983779 49245\n- Wt.Gain             1    259327  93957128 49246\n- Weeks               1   2758699  96456501 49377\n- Birth.weight.group  1 717140364 810838166 60022\n\nStep:  AIC=49232.85\nBirth.Weight..g. ~ Plurality.of.birth + Gender + Race + Age.of.mother + \n    Date.LBirth + Month.LBirth + LOutcome + Weeks + Visits + \n    Birth.weight.group + Marital + Birth.Attendant + Month.Term + \n    Year.Term + Low.Birth + RaceDad + Smoker + Wt.Gain\n\n                     Df Sum of Sq       RSS   AIC\n- Visits              1     12771  93727231 49232\n- Birth.Attendant     1     17766  93732226 49232\n- RaceDad             1     20119  93734579 49232\n- Year.Term           1     23837  93738297 49232\n- Marital             1     28607  93743068 49232\n- LOutcome            1     31764  93746224 49233\n&lt;none&gt;                             93714460 49233\n- Age.of.mother       1     64513  93778973 49234\n- Low.Birth           1     65014  93779475 49234\n- Month.Term          1     98329  93812789 49236\n- Gender              1    111020  93825480 49237\n- Month.LBirth        1    132699  93847159 49238\n- Date.LBirth         1    133168  93847628 49238\n- Plurality.of.birth  1    236391  93950851 49243\n- Smoker              1    237139  93951599 49243\n- Race                2    283283  93997743 49244\n- Wt.Gain             1    253698  93968159 49244\n- Weeks               1   2815836  96530296 49379\n- Birth.weight.group  1 717312360 811026821 60021\n\nStep:  AIC=49231.53\nBirth.Weight..g. ~ Plurality.of.birth + Gender + Race + Age.of.mother + \n    Date.LBirth + Month.LBirth + LOutcome + Weeks + Birth.weight.group + \n    Marital + Birth.Attendant + Month.Term + Year.Term + Low.Birth + \n    RaceDad + Smoker + Wt.Gain\n\n                     Df Sum of Sq       RSS   AIC\n- Birth.Attendant     1     16817  93744048 49230\n- RaceDad             1     19646  93746877 49231\n- Year.Term           1     22864  93750096 49231\n- LOutcome            1     32561  93759793 49231\n- Marital             1     33397  93760628 49231\n&lt;none&gt;                             93727231 49232\n- Low.Birth           1     65904  93793135 49233\n- Age.of.mother       1     70089  93797320 49233\n- Month.Term          1     99064  93826295 49235\n- Gender              1    109353  93836585 49235\n- Month.LBirth        1    130476  93857707 49236\n- Date.LBirth         1    130942  93858173 49237\n- Plurality.of.birth  1    225729  93952961 49242\n- Smoker              1    236939  93964170 49242\n- Race                2    277059  94004290 49242\n- Wt.Gain             1    261273  93988504 49243\n- Weeks               1   2852807  96580039 49379\n- Birth.weight.group  1 720155397 813882628 60037\n\nStep:  AIC=49230.43\nBirth.Weight..g. ~ Plurality.of.birth + Gender + Race + Age.of.mother + \n    Date.LBirth + Month.LBirth + LOutcome + Weeks + Birth.weight.group + \n    Marital + Month.Term + Year.Term + Low.Birth + RaceDad + \n    Smoker + Wt.Gain\n\n                     Df Sum of Sq       RSS   AIC\n- RaceDad             1     18974  93763023 49229\n- Year.Term           1     22853  93766902 49230\n- LOutcome            1     32265  93776313 49230\n- Marital             1     35297  93779346 49230\n&lt;none&gt;                             93744048 49230\n- Age.of.mother       1     66244  93810293 49232\n- Low.Birth           1     66786  93810834 49232\n- Month.Term          1     98058  93842106 49234\n- Gender              1    108369  93852417 49234\n- Month.LBirth        1    132256  93876304 49235\n- Date.LBirth         1    132707  93876755 49236\n- Plurality.of.birth  1    229890  93973938 49241\n- Smoker              1    235464  93979513 49241\n- Race                2    280307  94024355 49241\n- Wt.Gain             1    261945  94005993 49242\n- Weeks               1   2856162  96600210 49378\n- Birth.weight.group  1 720222651 813966699 60035\n\nStep:  AIC=49229.44\nBirth.Weight..g. ~ Plurality.of.birth + Gender + Race + Age.of.mother + \n    Date.LBirth + Month.LBirth + LOutcome + Weeks + Birth.weight.group + \n    Marital + Month.Term + Year.Term + Low.Birth + Smoker + Wt.Gain\n\n                     Df Sum of Sq       RSS   AIC\n- Year.Term           1     22239  93785262 49229\n- LOutcome            1     32342  93795365 49229\n- Marital             1     35310  93798333 49229\n&lt;none&gt;                             93763023 49229\n- Age.of.mother       1     64623  93827646 49231\n- Low.Birth           1     64672  93827695 49231\n- Month.Term          1     98066  93861089 49233\n- Gender              1    107746  93870769 49233\n- Month.LBirth        1    132797  93895820 49235\n- Date.LBirth         1    133254  93896277 49235\n- Plurality.of.birth  1    228469  93991492 49240\n- Smoker              1    234739  93997761 49240\n- Wt.Gain             1    260187  94023210 49241\n- Race                2    411765  94174787 49247\n- Weeks               1   2850830  96613852 49377\n- Birth.weight.group  1 721715962 815478985 60042\n\nStep:  AIC=49228.63\nBirth.Weight..g. ~ Plurality.of.birth + Gender + Race + Age.of.mother + \n    Date.LBirth + Month.LBirth + LOutcome + Weeks + Birth.weight.group + \n    Marital + Month.Term + Low.Birth + Smoker + Wt.Gain\n\n                     Df Sum of Sq       RSS   AIC\n&lt;none&gt;                             93785262 49229\n- Marital             1     38287  93823550 49229\n- Age.of.mother       1     57325  93842587 49230\n- LOutcome            1     59406  93844668 49230\n- Low.Birth           1     64835  93850097 49230\n- Month.Term          1     77781  93863043 49231\n- Gender              1    107034  93892296 49232\n- Month.LBirth        1    168630  93953893 49236\n- Date.LBirth         1    169519  93954781 49236\n- Plurality.of.birth  1    227383  94012645 49239\n- Smoker              1    244280  94029542 49240\n- Wt.Gain             1    259786  94045048 49240\n- Race                2    423687  94208949 49247\n- Weeks               1   2844759  96630021 49376\n- Birth.weight.group  1 721813693 815598955 60041\n\nsummary(stepwise) \n\n\nCall:\nlm(formula = Birth.Weight..g. ~ Plurality.of.birth + Gender + \n    Race + Age.of.mother + Date.LBirth + Month.LBirth + LOutcome + \n    Weeks + Birth.weight.group + Marital + Month.Term + Low.Birth + \n    Smoker + Wt.Gain, data = B.train)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-340.96 -110.87    0.41  109.64  647.17 \n\nCoefficients:\n                     Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)         2.223e+01  4.041e+01   0.550 0.582214    \nPlurality.of.birth -3.832e+01  1.102e+01  -3.476 0.000513 ***\nGender             -9.355e+00  3.923e+00  -2.385 0.017118 *  \nRaceOther           8.162e+00  1.024e+01   0.797 0.425643    \nRaceWhite           2.433e+01  5.329e+00   4.565 5.11e-06 ***\nAge.of.mother       6.446e-01  3.693e-01   1.745 0.080979 .  \nDate.LBirth         1.619e-02  5.393e-03   3.001 0.002700 ** \nMonth.LBirth       -1.624e+02  5.426e+01  -2.994 0.002771 ** \nLOutcome            2.291e+00  1.290e+00   1.777 0.075663 .  \nWeeks               1.173e+01  9.540e-01  12.295  &lt; 2e-16 ***\nBirth.weight.group  4.542e+02  2.319e+00 195.855  &lt; 2e-16 ***\nMarital            -6.925e+00  4.855e+00  -1.426 0.153808    \nMonth.Term          1.725e+00  8.486e-01   2.033 0.042096 *  \nLow.BirthNorm       1.838e+01  9.904e+00   1.856 0.063483 .  \nSmokerNo            2.467e+01  6.847e+00   3.603 0.000318 ***\nWt.Gain             5.499e-01  1.480e-01   3.716 0.000205 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 137.2 on 4984 degrees of freedom\nMultiple R-squared:  0.9498,    Adjusted R-squared:  0.9496 \nF-statistic:  6286 on 15 and 4984 DF,  p-value: &lt; 2.2e-16\n\n\nFrom the summary of the stepwise model, you can see a similar outcome as the linear model, with Plurality.of.birth, Gender, Race, Weeks, Birth.weight.group, Father.Minority, Smoker, and Wt.Gain being the top significant predictors."
  },
  {
    "objectID": "projects/2-project.html#we-still-want-a-lower-mse.-lets-try-out-ridge-regression-with-the-complete-data-births.",
    "href": "projects/2-project.html#we-still-want-a-lower-mse.-lets-try-out-ridge-regression-with-the-complete-data-births.",
    "title": "Birth Weight Predictions (Code Displayed and Interpreted)",
    "section": "We still want a lower MSE. Let’s try out ridge regression with the complete data (births).",
    "text": "We still want a lower MSE. Let’s try out ridge regression with the complete data (births).\n\n# Do a log transformation on the response. A log transformation can linearize the relationship between response and dependent variables, making linear regression more effective.\nbirthsLog &lt;- transform(births, lWeight = log(as.numeric(births$Birth.Weight..g.)))\nbirthsLog &lt;- subset(birthsLog, select = -c(Birth.Weight..g., X)) # remove the original response variable and the index \nB.testLog &lt;- transform(B.test, lWeight = log(as.numeric(B.test$Birth.Weight..g.)))\nB.testLog &lt;- subset(B.testLog, select = -c(Birth.Weight..g., X))\n\n# Omit the NA's\nbirths2 &lt;- na.omit(birthsLog)\nB.test2 &lt;- na.omit(B.testLog)\n\n# Create the model matrices for full and testing data\nx_full &lt;- model.matrix(lWeight ~ ., data = births2)\ny_full &lt;- births2$lWeight\n\nx_test &lt;- model.matrix(lWeight ~ ., data = B.test2)\ny_test &lt;- B.test2$lWeight\n\n# Fit Ridge Regression\nset.seed(123)\nlambda.v &lt;- 10^seq(10, -2, length = 100)\nridge_model &lt;- glmnet(x_full, y_full, alpha = 0, lambda = lambda.v)\n\n# Cross-validation to find best lambda\nset.seed(123)\ncv.output &lt;- cv.glmnet(x_full, y_full, alpha = 0)\nqplot &lt;- qplot(log(cv.output$lambda),cv.output$cvsd)\n\nWarning: `qplot()` was deprecated in ggplot2 3.4.0.\n\nbestlamb.cv &lt;- cv.output$lambda.min\n\n# Fit the model with the best lambda\nbest_ridge &lt;- glmnet(x_full, y_full, alpha = 0, lambda = bestlamb.cv)\n\n# Predictions\npred.births2 &lt;- predict(best_ridge, newx = x_full, s = bestlamb.cv, type = \"response\")\npred.Btest2 &lt;- predict(best_ridge, newx = x_test, s = bestlamb.cv, type = \"response\")\n\n# Calculate MSE's\nMSE.births2 &lt;- mean((y_full - pred.births2)^2) # Full data MSE\nMSE.Btest2 &lt;- mean((y_test - pred.Btest2)^2)  # Testing MSE\n\ncat(\"Best lambda: \", bestlamb.cv, \"\\n\")\n\nBest lambda:  0.0224084 \n\nprint(coef(best_ridge))\n\n50 x 1 sparse Matrix of class \"dgCMatrix\"\n                                       s0\n(Intercept)                  6.478370e+00\n(Intercept)                  .           \nInstitution.type            -3.084747e-03\nPlurality.of.birth          -3.429659e-02\nGender                      -4.804617e-03\nRace.of.child                3.808047e-04\nRaceOther                    7.947638e-03\nRaceWhite                    6.455639e-03\nAge.of.father               -7.679371e-05\nAge.of.mother                1.002633e-04\nEducation.of.father..years.  3.808010e-04\nEducation.of.mother..years.  4.342688e-04\nTotal.Preg                   9.235997e-04\nBDead                       -2.406430e-02\nTerms                       -1.366699e-03\nDate.LBirth                 -4.986784e-10\nMonth.LBirth                -2.328507e-05\nYear.LBirth                  3.108965e-06\nLOutcome                    -1.891907e-04\nWeeks                        1.828815e-02\nPrenatal                     3.456070e-03\nTrimester.Prenatal          -1.601978e-03\nVisits                       1.621431e-03\nBirth.weight.group           1.238124e-01\nMarital                     -2.870645e-03\nBirth.Attendant              5.054304e-04\nNumchild                     2.665622e-03\nMonth.Term                  -7.218584e-04\nYear.Term                    8.215467e-07\nLow.BirthNorm                1.317013e-01\nRaceMom                     -6.849657e-05\nRaceDad                     -1.444243e-03\nMother.MinorityWhite         7.984752e-03\nFather.MinorityWhite        -4.427625e-03\nHispMomM                     1.217261e-03\nHispMomN                    -1.696298e-03\nHispMomO                    -1.099847e-02\nHispMomP                    -1.272498e-03\nHispMomS                     9.112568e-05\nHispMomU                     2.279497e-02\nHispDadM                    -1.532665e-03\nHispDadN                    -3.089432e-04\nHispDadO                     8.649688e-03\nHispDadP                     1.692276e-03\nHispDadS                     7.593321e-03\nHispDadU                    -1.408813e-02\nAveCigs                     -4.029724e-04\nSmokerNo                     4.647282e-03\nAveDrink                     2.408536e-04\nWt.Gain                      4.650144e-04\n\ncat(\"Training MSE: \", MSE.births2, \"\\n\")\n\nTraining MSE:  0.006721434 \n\ncat(\"Testing MSE: \", MSE.Btest2, \"\\n\")\n\nTesting MSE:  0.006942309 \n\n\nThe small lambda value of 0.022 tell us that more predictors contribute to the model.\nThe coefficients for each variable represent the contribution of that variable to the baby’s birth weight.\nPositive coefficients (the highest being Weeks: 1.828815e-02 and Birth.weight.group: 1.238124e-01) indicate that increasing this variable is associated with a higher birth weight. Let me define these predictors: - Birth.weight.group: 00 if 500 grams or less, 01 if 501 – 1000 grams, … etc. - Weeks: Completed Weeks of Gestation; 18 – 45 Weeks\nNegative coefficients (the lowest being Plurality.of.birth: -3.429659e-02 and HispDadU: -1.408813e-02) indicate that increasing this variable is associated with a lower birth weight. HispDadU means the hispanic origin of the father is unknown.\nLastly, variables with coefficients close to 0 have minimal impact on the prediction.\nThe training MSE, 0.0067214, is very samll. The testing MSE is also small - 0.0069423 - indicating that the model generalized well, has good prediction accuracy, and doesn’t over-fit the data."
  },
  {
    "objectID": "projects/2-project.html#now-we-just-want-to-show-other-more-complex-techniques-and-how-they-can-make-a-difference.-here-we-will-try-lasso-regression-with-the-complete-data.",
    "href": "projects/2-project.html#now-we-just-want-to-show-other-more-complex-techniques-and-how-they-can-make-a-difference.-here-we-will-try-lasso-regression-with-the-complete-data.",
    "title": "Birth Weight Predictions (Code Displayed and Interpreted)",
    "section": "Now we just want to show other more complex techniques and how they can make a difference. Here we will try Lasso Regression with the complete data.",
    "text": "Now we just want to show other more complex techniques and how they can make a difference. Here we will try Lasso Regression with the complete data.\n\n# Prepare the data and do a log transformation\nbirthsLog &lt;- transform(births, lWeight = log(as.numeric(births$Birth.Weight..g.)))\nbirthsLog &lt;- subset(birthsLog, select = -c(Birth.Weight..g., X))  \nbirths2 &lt;- na.omit(birthsLog)  # remove NA's\n\n# Create model matrices with full and testing data\nx_full &lt;- model.matrix(lWeight ~ ., data = births2) \ny_full &lt;- births2$lWeight\n\nx_test &lt;- model.matrix(lWeight ~ ., data = B.test2)\ny_test &lt;- B.test2$lWeight\n\n# Fit lasso regression\nset.seed(123)\nlambda.v &lt;- 10^seq(10, -2, length = 100)\nmodel.lasso &lt;- glmnet(x_full, y_full, alpha = 1, lambda = lambda.v)\n\n# Cross-validation to find best lambda\nset.seed(123)\ncv.outputL &lt;- cv.glmnet(x_full, y_full, alpha = 1)\nbestlamb.cvL &lt;- cv.outputL$lambda.min\n\n# Fit the model with the best lambda\nbest_lasso &lt;- glmnet(x_full, y_full, alpha = 1, lambda = bestlamb.cvL)\n\n# Predictions\npred.lasso.train &lt;- predict(best_lasso, newx = x_full, s = bestlamb.cvL, type = \"response\")\npred.lasso.test &lt;- predict(best_lasso, newx = x_test, s = bestlamb.cvL, type = \"response\")\n\n# Calculate MSE's\ntrain_mse_lasso &lt;- mean((y_full - pred.lasso.train)^2)  # Full data MSE\ntest_mse_lasso &lt;- mean((y_test - pred.lasso.test)^2) # Testing MSE\n\ncat(\"Best Lambda (Lasso):\", bestlamb.cvL, \"\\n\")\n\nBest Lambda (Lasso): 0.0005815035 \n\ncat(\"Training MSE (Lasso):\", train_mse_lasso, \"\\n\")\n\nTraining MSE (Lasso): 0.006426799 \n\ncat(\"Testing MSE (Lasso):\", test_mse_lasso, \"\\n\")\n\nTesting MSE (Lasso): 0.006627519 \n\n# Plot cross-validation results\nqplot(log(cv.outputL$lambda), cv.outputL$cvm) +\n  geom_errorbar(aes(ymin = cv.outputL$cvm - cv.outputL$cvsd, \n                    ymax = cv.outputL$cvm + cv.outputL$cvsd)) +\n  ggtitle(\"Cross-Validation Error vs Lambda (Log Scale)\") +\n  xlab(\"Log(Lambda)\") +\n  ylab(\"Cross-Validation Error\")\n\n\n\n\n\n\n\n\nThe lasso regression model has a slightly lower MSE than the ridge regression model (by about 0.0003), which shows that the shrinkage technique in Lasso regression can improve model generalization for this dataset.\nAlso, the plot shows the cross-validation error (the average prediction error during cross-validation) increasing rapidly as the log of lambda moves from -4 to 0. So as lambda increases, the model becomes overly regularized, leading to underfitting and poor performance"
  },
  {
    "objectID": "projects/2-project.html#summary-of-the-models-tested",
    "href": "projects/2-project.html#summary-of-the-models-tested",
    "title": "Birth Weight Predictions (Code Displayed and Interpreted)",
    "section": "Summary of the models tested",
    "text": "Summary of the models tested\nTo summarize what we found, we need to know 2 definitions: - Bias: The error from the model’s assumptions. High bias means the model is too simple and misses important patterns (underfitting). - Flexibility: How well the model adapts to the data. High flexibility means the model can capture complex patterns, but too much flexibility can lead to overfitting, where the model includes noise in the data.\nThe multiple linear regression model uses all predictors, resulting in high bias and less flexibility, with training and testing MSE values of 721256.4 and 707930.6, respectively.\nThe stepwise regression model, selecting 8 predictors, has only a slightly better MSE (721443.2 and 709755.3) respectively.\nRidge regression, with a lambda of 0.00224, after a log transformation, achieves a training MSE of 0.006721434 and a testing MSE of 0.006942309 by applying penalties to predictors, balancing bias and flexibility. These MSE’s are better that what was shown in stepwise.\nThe Lasso model, with similar performance (training MSE: 0.00642802, Testing MSE: 0.006628631), further reduces predictors, offering higher flexibility and lower variance.\nBased on the MSE values, Lasso Regression appears to be the best model. It has the lowest MSE on both the training (0.00642802) and testing sets (0.006628631), suggesting a good balance between bias and variance."
  },
  {
    "objectID": "projects/2-project.html#instead-of-focusing-on-penalties-and-regularizing-we-can-remove-dimensions-and-correlations-by-testing-a-pcr-model-on-the-training-set.",
    "href": "projects/2-project.html#instead-of-focusing-on-penalties-and-regularizing-we-can-remove-dimensions-and-correlations-by-testing-a-pcr-model-on-the-training-set.",
    "title": "Birth Weight Predictions (Code Displayed and Interpreted)",
    "section": "Instead of focusing on penalties and regularizing, we can remove dimensions and correlations by testing a PCR model on the training set.",
    "text": "Instead of focusing on penalties and regularizing, we can remove dimensions and correlations by testing a PCR model on the training set.\nA principal component is a way to combine the original features in your data to find the most important patterns. The first one shows the most important patterns, and each next one shows less important details that are still there.\n\n# Fit the model\npcrmodel &lt;- pcr(B.train$Birth.Weight..g.~., data=B.train, scale=TRUE, validation=\"CV\")\nsummary(pcrmodel)\n\nData:   X dimension: 5000 49 \n    Y dimension: 5000 1\nFit method: svdpc\nNumber of components considered: 49\n\nVALIDATION: RMSEP\nCross-validated using 10 random segments.\n       (Intercept)  1 comps  2 comps  3 comps  4 comps  5 comps  6 comps\nCV           611.4      610    607.9    603.6    503.5    334.6    306.5\nadjCV        611.4      610    607.9    603.6    503.5    334.4    306.2\n       7 comps  8 comps  9 comps  10 comps  11 comps  12 comps  13 comps\nCV       306.3    306.1    305.7     305.3     304.6     304.1     303.8\nadjCV    306.2    305.9    305.8     305.1     304.5     304.0     303.7\n       14 comps  15 comps  16 comps  17 comps  18 comps  19 comps  20 comps\nCV        298.4     293.1     292.8     292.1     291.8     291.8     291.5\nadjCV     298.3     292.9     292.6     291.9     291.6     291.6     291.4\n       21 comps  22 comps  23 comps  24 comps  25 comps  26 comps  27 comps\nCV        290.7     289.6     289.4     289.1     287.0     285.3     284.9\nadjCV     290.6     289.3     289.3     289.0     286.9     284.9     284.8\n       28 comps  29 comps  30 comps  31 comps  32 comps  33 comps  34 comps\nCV        282.7     278.4     278.1     277.3     277.5     242.8     140.0\nadjCV     282.3     277.9     277.9     277.0     277.5     275.3     139.6\n       35 comps  36 comps  37 comps  38 comps  39 comps  40 comps  41 comps\nCV        139.2     139.1     139.0     138.6     138.2     138.1     138.1\nadjCV     139.0     139.0     138.9     138.5     138.1     138.0     138.0\n       42 comps  43 comps  44 comps  45 comps  46 comps  47 comps  48 comps\nCV        138.1     138.1     138.2     138.2     138.2     138.2     138.2\nadjCV     138.1     138.1     138.1     138.1     138.1     138.1     138.1\n       49 comps\nCV        138.4\nadjCV     138.1\n\nTRAINING: % variance explained\n                          1 comps  2 comps  3 comps  4 comps  5 comps  6 comps\nX                         11.8474   22.343   31.207    36.50    41.21    45.71\nB.train$Birth.Weight..g.   0.4779    1.156    2.635    32.49    70.13    74.99\n                          7 comps  8 comps  9 comps  10 comps  11 comps\nX                            49.2    52.60    55.89     59.14     62.07\nB.train$Birth.Weight..g.     75.0    75.07    75.07     75.31     75.36\n                          12 comps  13 comps  14 comps  15 comps  16 comps\nX                            64.78     67.27     69.53     71.71     73.80\nB.train$Birth.Weight..g.     75.42     75.48     76.38     77.23     77.29\n                          17 comps  18 comps  19 comps  20 comps  21 comps\nX                            75.83     77.84     79.82     81.63     83.23\nB.train$Birth.Weight..g.     77.45     77.55     77.55     77.60     77.73\n                          22 comps  23 comps  24 comps  25 comps  26 comps\nX                            84.78     86.27     87.53     88.73     89.92\nB.train$Birth.Weight..g.     77.93     77.94     78.00     78.27     78.65\n                          27 comps  28 comps  29 comps  30 comps  31 comps\nX                            91.07     92.09     93.06     93.96     94.78\nB.train$Birth.Weight..g.     78.66     79.07     79.72     79.74     79.87\n                          32 comps  33 comps  34 comps  35 comps  36 comps\nX                            95.56     96.23     96.85     97.39     97.85\nB.train$Birth.Weight..g.     79.88     79.92     94.87     94.90     94.91\n                          37 comps  38 comps  39 comps  40 comps  41 comps\nX                            98.29     98.71     99.05     99.37     99.69\nB.train$Birth.Weight..g.     94.91     94.95     94.99     94.99     94.99\n                          42 comps  43 comps  44 comps  45 comps  46 comps\nX                            99.85     99.99     99.99       100       100\nB.train$Birth.Weight..g.     94.99     95.00     95.00        95        95\n                          47 comps  48 comps  49 comps\nX                              100       100       100\nB.train$Birth.Weight..g.        95        95        95\n\nvalidationplot(pcrmodel)\n\n\n\n\n\n\n\n# choose 40 principle components based on analysis of summary of pcr model\n# amount of variation explained by 40 principal components: 99.37% \n\n# Check to see the optimal M number of principal components \noptimal_M &lt;- which.min(pcrmodel$validation$PRESS)\n\n# Make predictions and find MSE's\ntrain_predictions &lt;- predict(pcrmodel, newdata = B.train, ncomp = optimal_M)\nMSE.Btrain &lt;- mean((B.train$Birth.Weight..g. - train_predictions)^2)\n\ntest_predictions &lt;- predict(pcrmodel,newdata = B.test , ncomp = optimal_M)\nMSE.Btest &lt;- mean((B.test$Birth.Weight..g. - test_predictions)^2)\n\n# Report the optimal M and MSE's\ncat(\"Optimal M:\", optimal_M, \"\\n\")\n\nOptimal M: 40 \n\ncat(\"Training MSE:\", MSE.Btrain, \"\\n\")\n\nTraining MSE: 18709.24 \n\ncat(\"Testing MSE:\", MSE.Btest, \"\\n\")\n\nTesting MSE: 19207.04 \n\n\nThe validation plot is a visualization for the optimal M by showing that the error is lowest beginning at around 38. 38 principal components means you’ve transformed your original features into 38 new variables (or dimensions) that capture the most important patterns in the data.\nSo, while the MSE’s in Lasso and Ridge Regression are much lower, PCR can still be valuable if the primary concern is reducing multicollinearity or performing dimensionality reduction."
  },
  {
    "objectID": "projects/2-project.html#next-we-will-test-a-pls-model-which-also-performs-dimensionality-reduction-but-with-a-key-difference-in-how-the-components-are-selected.",
    "href": "projects/2-project.html#next-we-will-test-a-pls-model-which-also-performs-dimensionality-reduction-but-with-a-key-difference-in-how-the-components-are-selected.",
    "title": "Birth Weight Predictions (Code Displayed and Interpreted)",
    "section": "Next, we will test a PLS model, which also performs dimensionality reduction, but with a key difference in how the components are selected.",
    "text": "Next, we will test a PLS model, which also performs dimensionality reduction, but with a key difference in how the components are selected.\n\nplsmodel &lt;- plsr(B.train$Birth.Weight..g.~., data=B.train, scale=TRUE, validation=\"CV\")\nsummary(plsmodel)\n\nData:   X dimension: 5000 49 \n    Y dimension: 5000 1\nFit method: kernelpls\nNumber of components considered: 49\n\nVALIDATION: RMSEP\nCross-validated using 10 random segments.\n       (Intercept)  1 comps  2 comps  3 comps  4 comps  5 comps  6 comps\nCV           611.4    285.3    248.4    197.6    162.2    146.8    141.4\nadjCV        611.4    285.0    248.3    197.4    161.8    146.6    141.4\n       7 comps  8 comps  9 comps  10 comps  11 comps  12 comps  13 comps\nCV       138.8    138.3    138.2     138.2     138.2     138.3     138.3\nadjCV    138.8    138.3    138.2     138.1     138.1     138.2     138.2\n       14 comps  15 comps  16 comps  17 comps  18 comps  19 comps  20 comps\nCV        138.3     138.3     138.3     138.3     138.3     138.3     138.3\nadjCV     138.2     138.2     138.2     138.2     138.2     138.2     138.2\n       21 comps  22 comps  23 comps  24 comps  25 comps  26 comps  27 comps\nCV        138.3     138.3     138.3     138.3     138.3     138.3     138.3\nadjCV     138.2     138.2     138.2     138.2     138.2     138.2     138.2\n       28 comps  29 comps  30 comps  31 comps  32 comps  33 comps  34 comps\nCV        138.3     138.3     138.3     138.3     138.3     138.3     138.3\nadjCV     138.2     138.2     138.2     138.2     138.3     138.2     138.2\n       35 comps  36 comps  37 comps  38 comps  39 comps  40 comps  41 comps\nCV        138.3     138.3     138.3     138.3     138.3     138.3     138.3\nadjCV     138.3     138.3     138.3     138.3     138.3     138.3     138.3\n       42 comps  43 comps  44 comps  45 comps  46 comps  47 comps  48 comps\nCV        138.3     138.3     138.3     138.3     138.3     138.3     138.3\nadjCV     138.3     138.3     138.3     138.3     138.2     138.2     138.2\n       49 comps\nCV        138.3\nadjCV     138.2\n\nTRAINING: % variance explained\n                          1 comps  2 comps  3 comps  4 comps  5 comps  6 comps\nX                           5.585    15.15    20.14    26.76    32.35    39.33\nB.train$Birth.Weight..g.   78.466    83.66    89.78    93.17    94.37    94.76\n                          7 comps  8 comps  9 comps  10 comps  11 comps\nX                           43.83    45.97    48.90     52.03     53.96\nB.train$Birth.Weight..g.    94.95    94.99    94.99     94.99     95.00\n                          12 comps  13 comps  14 comps  15 comps  16 comps\nX                            55.52      57.5     59.42     61.21     62.78\nB.train$Birth.Weight..g.     95.00      95.0     95.00     95.00     95.00\n                          17 comps  18 comps  19 comps  20 comps  21 comps\nX                            64.59     66.67     68.34     70.63     72.17\nB.train$Birth.Weight..g.     95.00     95.00     95.00     95.00     95.00\n                          22 comps  23 comps  24 comps  25 comps  26 comps\nX                            73.83     75.04     76.28     77.71     79.09\nB.train$Birth.Weight..g.     95.00     95.00     95.00     95.00     95.00\n                          27 comps  28 comps  29 comps  30 comps  31 comps\nX                            81.23     82.88     83.89     85.07     86.27\nB.train$Birth.Weight..g.     95.00     95.00     95.00     95.00     95.00\n                          32 comps  33 comps  34 comps  35 comps  36 comps\nX                            87.65     88.55     89.26     90.46     91.37\nB.train$Birth.Weight..g.     95.00     95.00     95.00     95.00     95.00\n                          37 comps  38 comps  39 comps  40 comps  41 comps\nX                            92.52     93.49     94.46     95.91      97.2\nB.train$Birth.Weight..g.     95.00     95.00     95.00     95.00      95.0\n                          42 comps  43 comps  44 comps  45 comps  46 comps\nX                            97.95     98.45     99.39       100     100.1\nB.train$Birth.Weight..g.     95.00     95.00     95.00        95      95.0\n                          47 comps  48 comps  49 comps\nX                            100.2     100.3     100.5\nB.train$Birth.Weight..g.      95.0      95.0      95.0\n\nvalidationplot(plsmodel)\n\n\n\n\n\n\n\n# choose 10 principal components (from summary analysis)\n# amount of variation explained by 10 principal components: 94.99%\n\n# Check to see the optimal M and the amount of variation\noptimal_M &lt;- which.min(plsmodel$validation$PRESS)\nexplained_variance &lt;- cumsum(explvar(plsmodel))\n\ntrain_predictions &lt;- predict(plsmodel, newdata = B.train, ncomp = optimal_M)\nMSE.Btrain &lt;- mean((B.train$Birth.Weight..g. - train_predictions)^2)\n\ntest_predictions &lt;- predict(plsmodel,newdata = B.test , ncomp = optimal_M)\nMSE.Btest &lt;- mean((B.test$Birth.Weight..g. - test_predictions)^2)\n\ncat(\"Optimal M:\", optimal_M, \"\\n\")\n\nOptimal M: 10 \n\n#cat(\"Amount of Variance explained by the optimal M:\", explained_variance, \"\\n\")\ncat(\"Training MSE:\", MSE.Btrain, \"\\n\")\n\nTraining MSE: 18701.52 \n\ncat(\"Testing MSE:\", MSE.Btest, \"\\n\")\n\nTesting MSE: 19238.18 \n\n\nThe MSE’s are roughly equal, but the validation plot shows that the error is lowest beginning at a little before 10 principal components."
  },
  {
    "objectID": "projects/2-project.html#lastly-we-will-fit-a-gam-on-the-training-and-testing-data.",
    "href": "projects/2-project.html#lastly-we-will-fit-a-gam-on-the-training-and-testing-data.",
    "title": "Birth Weight Predictions (Code Displayed and Interpreted)",
    "section": "Lastly, we will fit a GAM on the training and testing data.",
    "text": "Lastly, we will fit a GAM on the training and testing data.\nUnlike linear regression, where relationships are assumed to be linear, a Generalized Additive Model (GAM) can model non-linear relationships by using smooth (not necessarily linear) functions for each predictor.\n\n# Fit the model on the training data with the significant predictors\ngammodel &lt;- gam(B.train$Birth.Weight..g. ~ \n                  s(Weeks) + \n                  s(Wt.Gain) + \n                  Plurality.of.birth + Gender + Race + \n                  Birth.weight.group + Father.Minority + Smoker, \n                data = B.train)\n\nsummary(gammodel)\n\n\nFamily: gaussian \nLink function: identity \n\nFormula:\nB.train$Birth.Weight..g. ~ s(Weeks) + s(Wt.Gain) + Plurality.of.birth + \n    Gender + Race + Birth.weight.group + Father.Minority + Smoker\n\nParametric coefficients:\n                     Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           528.934     20.235  26.139  &lt; 2e-16 ***\nPlurality.of.birth    -37.088     10.774  -3.442 0.000582 ***\nGender                 -9.625      3.921  -2.455 0.014128 *  \nRaceOther              10.493     10.307   1.018 0.308749    \nRaceWhite              22.275      9.578   2.326 0.020073 *  \nBirth.weight.group    455.856      2.042 223.264  &lt; 2e-16 ***\nFather.MinorityWhite    5.287      8.804   0.601 0.548183    \nSmokerNo               27.350      6.716   4.072 4.73e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nApproximate significance of smooth terms:\n             edf Ref.df      F p-value    \ns(Weeks)   2.901  3.669 47.305 &lt; 2e-16 ***\ns(Wt.Gain) 2.039  2.608  4.177 0.00733 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nR-sq.(adj) =   0.95   Deviance explained =   95%\nGCV =  18881  Scale est. = 18832     n = 5000\n\n# Predict and find the training MSE\ntrain_predictions &lt;- predict(gammodel, newdata = B.train)\ntrain_mse &lt;- mean((B.train$Birth.Weight..g. - train_predictions)^2)\ncat(\"Training MSE:\", train_mse, \"\\n\")\n\nTraining MSE: 18783.65 \n\nB.train$Predicted &lt;- predict(gammodel, newdata = B.train)\n\nggplot(B.train, aes(x = Birth.Weight..g., y = Predicted)) +\n  geom_point(alpha = 0.5) +\n  geom_abline(slope = 1, intercept = 0, color = \"red\") +\n  theme_minimal() +\n  labs(\n    title = \"Actual vs Predicted Birth Weight\",\n    x = \"Actual Birth Weight (grams)\",\n    y = \"Predicted Birth Weight (grams)\"\n)\n\n\n\n\n\n\n\n\nThe actual vs. predicted weights plot shows that the GAM model fits the training data very well. It accurately predicts the baby weights given the significant predictors chosen from the step BIC function."
  },
  {
    "objectID": "projects/2-project.html#and-thats-it.-i-hope-you-enjoyed-seeing-some-applications-of-machine-learning-models-onto-an-interesting-data-set.",
    "href": "projects/2-project.html#and-thats-it.-i-hope-you-enjoyed-seeing-some-applications-of-machine-learning-models-onto-an-interesting-data-set.",
    "title": "Birth Weight Predictions (Code Displayed and Interpreted)",
    "section": "And that’s it. I hope you enjoyed seeing some applications of machine learning models onto an interesting data set.",
    "text": "And that’s it. I hope you enjoyed seeing some applications of machine learning models onto an interesting data set."
  }
]